<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>PSYC753 Data Fluency</title>
  <meta name="description" content="PSYC753 Data Fluency" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="PSYC753 Data Fluency" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="PSYC753 Data Fluency" />
  
  
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<link href="media/webex.css" rel="stylesheet" />
<link href="media/psystats.css" rel="stylesheet" />
<script src="media/webex.js"></script>
<script src="media/psystats.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118343766-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-118343766-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">PSYC753 Data Fluency</h1>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#section"></a></li>
<li><a href="#building1">Building models 1</a><ul>
<li><a href="#multiple-regression-with-several-continuous-predictors">Multiple regression with several continuous predictors</a></li>
<li><a href="#analysing-the-model">Analysing the model</a></li>
<li><a href="#conceptualising-the-variance-explained-by-predictors">Conceptualising the variance explained by predictors</a></li>
<li><a href="#adding-predictor-variables-to-the-model">Adding predictor variables to the model</a></li>
<li><a href="#multicollinearity">Multicollinearity</a></li>
<li><a href="#final-exercise">Final exercise</a></li>
<li><a href="#summary-of-key-points">Summary of key points</a></li>
</ul></li>
<li><a href="#building2">Building models 2</a><ul>
<li><a href="#using-anova-and-bayes-factors-to-compare-models">Using ANOVA and Bayes Factors to compare models</a></li>
<li><a href="#comparing-models-using-anova">Comparing models using ANOVA</a></li>
<li><a href="#comparing-models-using-bayes-factors">Comparing models using Bayes Factors</a></li>
<li><a href="#exercise">Exercise</a></li>
<li><a href="#summary-of-key-points-1">Summary of key points</a></li>
</ul></li>
<li><a href="#fitcurves">Fitting curves</a><ul>
<li><a href="#using-polynomials-to-fit-curves">Using polynomials to fit curves</a></li>
<li><a href="#polynomials">Polynomials</a></li>
<li><a href="#identifying-polynomial-components">Identifying polynomial components</a></li>
<li><a href="#bayesian-approach">Bayesian approach</a></li>
<li><a href="#exercise-1">Exercise</a></li>
<li><a href="#summary-of-key-points-2">Summary of key points</a></li>
</ul></li>
<li><a href="#assessment">Assessment</a><ul>
<li><a href="#data-analysis-and-visualisation-task">Data Analysis and Visualisation Task</a></li>
</ul></li>
<li><a href="#FAQ-assessment">FAQ Data Analysis and Visualisation Task</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSYC753 Data Fluency</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<p><em>November 2020</em></p>
<div id="section" class="section level1 unnumbered">
<h1></h1>
<p>This workbook contains details of the four sessions given by <strong>Chris Berry</strong>:</p>
<ul>
<li><p>Week 16 (9/11/20). Building models 1: Multiple continuous predictors</p></li>
<li><p>Week 17 (16/11/20). Building models 2: Comparing models</p></li>
<li><p>Week 18 (23/11/20). Fitting curves</p></li>
<li><p>Week 19 (30/11/20). Q&amp;A Support session</p></li>
</ul>
<p><br />
</p>
<p>It also contains details of the Data Visualisation and Analysis <strong>assessment</strong>.</p>
<p><br />
(Materials for sessions by Ben Whalley can be found at <a href="https://benwhalley.github.io/datafluency/" class="uri">https://benwhalley.github.io/datafluency/</a>)</p>
<p><br />
Use the left and right arrows to navigate through this workbook.</p>
<!--chapter:end:index.rmd-->
</div>
<div id="building1" class="section level1">
<h1>Building models 1</h1>
<p><em>November 2020</em></p>
<div id="in-brief" class="section level3">
<h3>In brief</h3>
<blockquote>
<p>Models need to be <em>appropriately complex</em>. That is, we want to make models
that represent our theories for the underlying causes of our data. Often this
means adding many variables to a regression model. But we won’t
always be sure which variables to add. Adding multiple variables also brings
challenges. Where predictors are highly correlated (termed <strong>multicollinearity</strong>)
then model results can be confusing.</p>
</blockquote>
</div>
<div id="multiple-regression-with-several-continuous-predictors" class="section level2">
<h2>Multiple regression with several continuous predictors</h2>
<ul>
<li><a href="slides/PSYC753_Chris1.pptx">Slides for the session</a></li>
</ul>
<div id="overview" class="section level3">
<h3>Overview</h3>
<p>So far, you have used regression to predict an outcome variable from a predictor variable. For example, can we predict <em>academic performance</em> from <em>hours of study</em>?</p>
<p>You’ve also used it to determine whether the relation between two variables differs according to a categorical variable. Does the relation between academic performance and hours of study, for example, differ for <em>men</em> and <em>women</em>?</p>
<p><br />
We often want to determine the extent to which an outcome variable is predicted by <strong>several continuous predictors</strong>.</p>
<p>For example, in addition to hours of study, a person’s <em>IQ</em> or <em>academic interest</em> might also predict their academic performance. We may want to add these predictors to a model because it may serve to <em>improve</em> the prediction of academic performance.</p>
<p><br />
Today, we will:</p>
<ul>
<li><p>learn how to conduct a multiple regression with several continuous predictor variables</p></li>
<li><p>evaluate the regression model with statistics (<span class="math inline">\(R^2\)</span>, <em>F</em>-statistic, <em>t</em>-values)</p></li>
<li><p>use Venn diagrams to help conceptualise the contribution of predictors to a model</p></li>
</ul>
<div class="tip">
<p><strong>Simple vs. multiple regression</strong></p>
<ul>
<li><p><strong>Simple regression</strong> is a linear model of the relationship between <em>one outcome variable and one predictor variable</em>. For example, can we predict <code>exam performance</code> on the basis of <code>IQ</code> scores?</p></li>
<li><p><strong>Multiple regression</strong> is a linear model of the relationship between <em>one outcome variable and more than one predictor variable</em>. For example, can we predict <code>exam performance</code>based on <code>IQ</code> scores <em>and</em> <code>attendance</code> at lectures?</p></li>
</ul>
</div>
</div>
</div>
<div id="analysing-the-model" class="section level2">
<h2>Analysing the model</h2>
<p>Suppose we want to construct a model to predict final university exam scores. This is the task faced by some admissions tutors! We’ll start off with a simple regression model, then work up to multiple regression.</p>
<p>Load the <code>ExamData</code> dataset from <a href="https://bit.ly/37GkvJg" class="uri">https://bit.ly/37GkvJg</a>. This contains exam scores for students taking a university course. (Make sure <code>tidyverse</code> is loaded first!)</p>
<div class="tip">
<p><strong>Learning tip</strong></p>
<p>Try typing out the code today if you usually cut and paste it to R!</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">ExamData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://bit.ly/37GkvJg&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">ExamData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="er">&gt;</span><span class="st">   </span>finalex entrex   age project    iq proposal attendance</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>      <span class="dv">38</span>     <span class="dv">44</span>  <span class="fl">21.9</span>      <span class="dv">50</span>   <span class="dv">110</span>       <span class="dv">44</span>          <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>      <span class="dv">49</span>     <span class="dv">40</span>  <span class="fl">22.6</span>      <span class="dv">75</span>   <span class="dv">120</span>       <span class="dv">70</span>          <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>      <span class="dv">61</span>     <span class="dv">43</span>  <span class="fl">21.8</span>      <span class="dv">54</span>   <span class="dv">119</span>       <span class="dv">54</span>          <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>      <span class="dv">65</span>     <span class="dv">42</span>  <span class="fl">22.5</span>      <span class="dv">60</span>   <span class="dv">125</span>       <span class="dv">53</span>          <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>      <span class="dv">69</span>     <span class="dv">44</span>  <span class="fl">21.9</span>      <span class="dv">82</span>   <span class="dv">121</span>       <span class="dv">73</span>          <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>      <span class="dv">73</span>     <span class="dv">46</span>  <span class="fl">21.8</span>      <span class="dv">65</span>   <span class="dv">140</span>       <span class="dv">62</span>          <span class="dv">0</span></a></code></pre></div>
<div class="tip">
<p>These are the variables in <code>ExamData</code>:</p>
<ul>
<li><code>finalex</code>: final examination marks</li>
<li><code>entrex</code>: entrance examination marks</li>
<li><code>age</code>: age in years</li>
<li><code>project</code>: dissertation project marks</li>
<li><code>iq</code>: IQ score</li>
<li><code>proposal</code>: dissertation proposal grade</li>
<li><code>attendance</code>: 1 = high attendance; 0 = low attendance</li>
</ul>
</div>
<p>First, let’s ask whether <code>finalex</code> is predicted by <code>entrex</code>. Plot these variables:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">ExamData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> entrex, <span class="dt">y =</span> finalex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F, <span class="dt">method=</span>lm)</a></code></pre></div>
<p><img src="06-building-models_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>There looks to be a positive association - students with higher entrance exam scores tend to have higher final exam scores. A good start!</p>
<p>To conduct the simple regression with <code>finalex</code> as the outcome variable, and <code>entrex</code> as the predictor variable, use <code>lm</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData) </a></code></pre></div>
<p><strong>Explanation</strong>: <code>finalex ~ entrex</code> can be read as “<code>finalex</code> is predicted by <code>entrex</code>”. The model is stored in <code>m1</code>.</p>
<p>View the intercept of the regression line and the coefficient for <code>entrex</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">m1</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="er">&gt;</span><span class="st"> </span>(Intercept)       entrex  </a>
<a class="sourceLine" id="cb4-8" title="8"><span class="op">&gt;</span><span class="st">     </span><span class="fl">-46.305</span>        <span class="fl">3.155</span></a></code></pre></div>
<p>We can therefore write the regression equation:</p>
<p><span class="math inline">\(Predicted\ final\ exam\ score = -46.305 + 3.155(entrance\ exam)\)</span></p>
<p><br />
<br />
Use <code>summary(m1)</code> to display statistical analysis of the model:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">summary</span>(m1)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb5-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-54.494</span> <span class="fl">-21.185</span>   <span class="fl">3.733</span>  <span class="fl">18.124</span>  <span class="fl">30.969</span> </a>
<a class="sourceLine" id="cb5-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb5-12" title="12"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-46.3045</span>    <span class="fl">25.4773</span>  <span class="fl">-1.817</span>   <span class="fl">0.0788</span> .  </a>
<a class="sourceLine" id="cb5-13" title="13"><span class="op">&gt;</span><span class="st"> </span>entrex        <span class="fl">3.1545</span>     <span class="fl">0.5324</span>   <span class="fl">5.925</span> <span class="fl">1.52e-06</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.7</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb5-18" title="18"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.531</span>,   Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5159</span> </a>
<a class="sourceLine" id="cb5-19" title="19"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st">  </span><span class="fl">35.1</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">1.52e-06</span></a></code></pre></div>
<p><strong>Explanation of the output</strong>:</p>
<p><br />
<strong><code>Residuals:</code></strong> provides an indication of the discrepancy between the values of <code>finalex</code> predicted by the model (i.e., the regression equation) and the actual values of <code>finalex</code>. If the model does a good job in predicting <code>finalex</code>, the residuals should be relatively small.</p>
<ul>
<li>The difference between <code>Min</code> and <code>Max</code> gives us some idea of the range of error in the prediction of <code>finalex</code> scores. The difference in <code>3Q</code> and <code>1Q</code> is the interquartile range. The <code>median</code> of the residuals is 3.73.</li>
</ul>
<p><br />
<strong><code>Coefficients:</code></strong> contains tests of statistical significance for each of the coefficients. The values in the column headed <code>Pr(&gt;|t|)</code> are the <em>p</em>-values associated with the <em>t</em>-values for the coefficients for each predictor. The <em>t</em>-values test a null hypothesis that the coefficients are equal to zero. A <em>p</em>-value less than .05 indicates that a predictor is statistically significant.</p>
<ul>
<li><p>The row for the <code>(intercept)</code> reports a <em>t</em>-test for whether the value of the intercept differs from zero. We’re not usually interested in this test (so don’t report it).</p></li>
<li><p>The row for <code>entrex</code> tests whether the value of its coefficient (3.15) differs from zero. A coefficient of zero would be expected if the predictor explained no variance in the outcome variable. The coefficient for <code>entrex</code> (3.15) is clearly greater than zero. We can report this by saying that <code>extrex</code> is a statistically significant predictor of <code>finalex</code>, <em>b</em> = 3.15, <em>t</em>(31) = 5.92, <em>p</em> &lt; .001.</p></li>
</ul>
<p><br />
<strong><code>Multiple R-squared:</code></strong> This is <span class="math inline">\(R^2\)</span> - the <strong>proportion of variance in <code>finalex</code> explained by <code>entrex</code></strong>. Here, <span class="math inline">\(R^2\)</span> = 0.531. So approximately half of the variance in <code>finalex</code> is explained by <code>entrex</code>. It’s usually referred to simply as “R-squared” or <span class="math inline">\(R^2\)</span>.</p>
<ul>
<li><span class="math inline">\(R^2\)</span> is often reported as a percentage. To get this, simply multiply the value by 100. i.e., 0.531 x 100 = 53.10%.</li>
</ul>
<p><br />
<strong><code>Adjusted R-squared:</code></strong> is an estimate of <span class="math inline">\(R^2\)</span>, but adjusted for the population. Despite the usefulness of this statistic, most studies still tend to report only the (unadjusted) <span class="math inline">\(R^2\)</span> value. If reporting the <code>Adjusted R-squared</code> value, be sure to label it clearly as such. Here, Adjusted R-squared = 0.52.</p>
<p><br />
<strong><code>F-statistic:</code></strong> This compares the variance in <code>finalex</code> explained by the model with the variance that it does not explain (i.e., explained variance divided by unexplained variance). Higher values of <em>F</em> indicate that the model explains greater variance in an outcome variable. If the <em>p</em>-value associated with the <em>F</em>-statistic is less than .05, we can say that the model significantly predicts the outcome variable.</p>
<p>Hence, we can say that a model consisting of <code>entrex</code> alone is a significant predictor of <code>finalex</code>, <em>F</em>(1, 31) = 35.10, <em>p</em> &lt; .001. Higher <code>entrex</code> scores tend to be associated with higher <code>finalex</code> scores. If our model did not explain any variance in <code>finalex</code>, we wouldn’t expect this to be statistically significant.</p>
<ul>
<li>In simple regression, the null hypothesis being tested on the <em>F</em>-statistic is that the slope of the regression line in the population is equal to zero. This is actually equivalent to the <em>t</em>-test on the <code>entrex</code> coefficient. So in simple regression, report the <em>F</em>-statistic for the overall regression or the <em>t</em>-test on the coefficient (not both). This equivalence between <em>F</em> and <em>t</em> does not hold true for multiple regression, as we shall see later.</li>
</ul>
<div class="exercise">
<p><strong>Now you have a go</strong></p>
<p>Run another simple regression:</p>
<ul>
<li><p>set <code>finalex</code> as the outcome variable and <code>project</code> as the predictor variable</p></li>
<li><p>store the output in a variable with a different name (<code>m2</code>)</p></li>
<li><p>then display the output of <code>m2</code> using <code>summary()</code>.</p></li>
</ul>
<div class="solution">
<button>
Try yourself first before clicking to show the code
</button>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>project, <span class="dt">data=</span> ExamData) </a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">summary</span>(m2)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb6-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-64.015</span> <span class="fl">-21.686</span>  <span class="fl">-0.573</span>  <span class="fl">21.758</span>  <span class="fl">70.427</span> </a>
<a class="sourceLine" id="cb6-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)  </a>
<a class="sourceLine" id="cb6-14" title="14"><span class="op">&gt;</span><span class="st"> </span>(Intercept)   <span class="fl">4.6968</span>    <span class="fl">40.1677</span>   <span class="fl">0.117</span>   <span class="fl">0.9077</span>  </a>
<a class="sourceLine" id="cb6-15" title="15"><span class="op">&gt;</span><span class="st"> </span>project       <span class="fl">1.4442</span>     <span class="fl">0.5861</span>   <span class="fl">2.464</span>   <span class="fl">0.0195</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">30.32</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb6-20" title="20"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1638</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1368</span> </a>
<a class="sourceLine" id="cb6-21" title="21"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">6.072</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.01948</span></a></code></pre></div>
</div>
<p><br />
Answer the following: (report statistics to 2 decimal places)</p>
<ul>
<li><p>What is the value of the coefficient for <code>project</code>? <input class='solveme nospaces' size='4' data-answer='["1.44"]'/></p></li>
<li><p>What proportion of the variance in <code>finalex</code> is explained by <code>project</code>?: <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='4' data-answer='["0.16",".16"]'/> (or <input class='solveme nospaces' size='5' data-answer='["16.38"]'/> %).</p></li>
<li><p>Write down the regression equation (on a bit of paper).</p></li>
</ul>
<div class="solution">
<button>
Show me
</button>
<ul>
<li><span class="math inline">\(Predicted\ final\ exam\ score = 4.70 + 1.44(project)\)</span></li>
</ul>
</div>
<ul>
<li><p>Is <code>project</code> alone a statistically significant predictor of <code>finalex</code>, as indicated by the <em>F</em>-statistic? <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p></li>
<li><p>Report the <em>F</em>-ratio in APA style, that is, in the form</p>
<p><strong><em>F</em>(df1, df2) = <em>F</em>-statistic, <em>p</em> = <em>p</em>-value</strong>:</p></li>
</ul>
<div class="solution">
<button>
Show me
</button>
<p><em>F</em>(1, 31) = 6.07, <em>p</em> = .02</p>
</div>
<ul>
<li>Individuals with <select class='solveme' data-answer='["higher"]'> <option></option> <option>lower</option> <option>higher</option></select> project scores tended to have higher final exam scores.</li>
</ul>
</div>
</div>
<div id="conceptualising-the-variance-explained-by-predictors" class="section level2">
<h2>Conceptualising the variance explained by predictors</h2>
<p>Venn diagrams are useful for understanding the variance that predictors explain in the outcome variable. They are especially useful for understanding what’s going on in multiple regression.</p>
<p>Suppose the rectangle below represents all of the <em>variance</em> in <code>finalex</code> to be explained.</p>
<p><img src="images/Venn1.jpg" /></p>
<p>The area of the circle below represents the variance in <code>finalex</code> explained by <code>entrex</code> in the first simple regression we did. If this diagram were drawn to scale (it’s not), the area of the circle would be equal to the value of <span class="math inline">\(R^2\)</span> (i.e., 53.1% of the rectangle).</p>
<p><img src="images/Venn2.jpg" /></p>
<p>The part of the rectangle not inside the circle represents the variance in <code>finalex</code> that is <em>not</em> explained by the model (i.e., the unexplained or <em>residual</em> variance).</p>
<p>To <em>improve</em> the model, we can explore whether adding in other predictors to the model explains additional variance, thereby increasing the total <span class="math inline">\(R^2\)</span> of the model.</p>
<p>You might think that we can simply add in variables (circles, above) to the model as we wish, until all the residual variance has been explained. This seems fine to do until we learn that if we were to add as many predictors to the model as there are rows in our data (33 individuals in our <code>ExamData</code>), then we’d perfectly predict the outcome variable, and have an <span class="math inline">\(R^2\)</span> of 100%! This would be true even if the predictors consisted of random values. Our model would clearly be meaningless though. We ideally want to explain the outcome variable with relatively few predictors.</p>
</div>
<div id="adding-predictor-variables-to-the-model" class="section level2">
<h2>Adding predictor variables to the model</h2>
<p>An issue that can arise when adding variables to a model is that predictors are usually correlated to some extent. This can make interpretation of multiple regressions tricky. For example, a predictor that is statistically significant in a simple regression may become non-significant in a multiple regression. Let’s see a demonstration of this!</p>
<p>We’ll now add <code>project</code> to the model with <code>entrex</code>. First, check the correlation between predictors:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">ExamData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">select</span>(entrex,project) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">cor</span>()</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="op">&gt;</span><span class="st">            </span>entrex   project</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="op">&gt;</span><span class="st"> </span>entrex  <span class="fl">1.0000000</span> <span class="fl">0.2908253</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="op">&gt;</span><span class="st"> </span>project <span class="fl">0.2908253</span> <span class="fl">1.0000000</span></a></code></pre></div>
<div class="exercise">
<p>The correlation between <code>entrex</code> and <code>project</code> is <em>r</em> = <input class='solveme nospaces' size='4' data-answer='["0.29",".29"]'/></p>
<p>Our predictor variables are weakly correlated. We should keep this in mind going forward.</p>
</div>
<p>Now run a <em>multiple regression</em> to predict <code>finalex</code> from both <code>entrex</code> and <code>project</code>. Again, use <code>lm</code> but use the <code>+</code> symbol to add predictors to the model:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">summary</span>(m3)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb8-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-41.880</span> <span class="fl">-16.617</span>   <span class="fl">4.636</span>  <span class="fl">15.562</span>  <span class="fl">35.273</span> </a>
<a class="sourceLine" id="cb8-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb8-14" title="14"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-84.8289</span>    <span class="fl">33.6846</span>  <span class="fl">-2.518</span>   <span class="fl">0.0174</span> <span class="op">*</span><span class="st">  </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="er">&gt;</span><span class="st"> </span>entrex        <span class="fl">2.8894</span>     <span class="fl">0.5406</span>   <span class="fl">5.344</span> <span class="fl">8.81e-06</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="er">&gt;</span><span class="st"> </span>project       <span class="fl">0.7515</span>     <span class="fl">0.4457</span>   <span class="fl">1.686</span>   <span class="fl">0.1021</span>    </a>
<a class="sourceLine" id="cb8-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.06</span> on <span class="dv">30</span> degrees of freedom</a>
<a class="sourceLine" id="cb8-21" title="21"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5716</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5431</span> </a>
<a class="sourceLine" id="cb8-22" title="22"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">20.02</span> on <span class="dv">2</span> and <span class="dv">30</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">3e-06</span></a></code></pre></div>
<div class="exercise">
<p>In this model with <code>entrex</code> and <code>project</code>as predictors:</p>
<p>What is the value of <span class="math inline">\(R^2\)</span> (as a percentage): <input class='solveme nospaces' size='5' data-answer='["57.16"]'/> %</p>
<p>By how much has <span class="math inline">\(R^2\)</span> <em>increased</em> in this model, relative to the model with <code>entrex</code> alone (where <span class="math inline">\(R^2\)</span> was 53.10%)? (as a percentage) (you will need to calculate this) <input class='solveme nospaces' size='4' data-answer='["4.06"]'/> %</p>
<p>Is the overall regression model predicting <code>finalex</code> on the basis of <code>entrex</code> and <code>project</code> statistically significant? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p>
<ul>
<li><p>Is <code>entrex</code> a statistically significant predictor of <code>finalex</code>? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>We can report this in the following way: the <em>t</em>-test on the coefficient for <code>entrex</code> is statistically significant, <em>b</em> = 2.89, <em>t</em>(30) = 5.34, <em>p</em> &lt; .001.</p></li>
<li><p>Is <code>project</code> a statistically significant predictor of <code>finalex</code> in this model? <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the value of the coefficient for <code>project</code>? <em>b</em> = <input class='solveme nospaces' data-tol='0.01' size='4' data-answer='["0.75",".75"]'/></p></li>
<li><p>Report the <em>t</em>-statistic in APA style:</p></li>
</ul>
<div class="solution">
<button>
Show me
</button>
<p>Project mark was not a statistically significant predictor of final examination in this model, <em>b</em> = 0.75, <em>t</em>(30) = 1.69, <em>p</em> = .10</p>
</div>
</div>
<p>Looking across the analyses we’ve performed, we can see that <code>project</code> is a (weak) but statistically significant predictor of <code>finalex</code> in a simple regression. However, when it is included in a model that also includes <code>entrex</code> it is not a significant predictor! What’s going on?</p>
<ul>
<li><p>The model containing only <code>project</code> explains 16.38% of the variability in <code>finalex</code>.</p></li>
<li><p>The model containing only <code>entrex</code> explains 53.10% of the variability in <code>finalex</code>.</p></li>
<li><p>However, a model containing <em>both</em> <code>project</code> and <code>entrex</code> only explains 57.16% of the variability in <code>finalex</code>, not 16.38 + 53.10 = 69.48%, as we might expect.</p></li>
</ul>
<p>This is because the predictors are <em>correlated</em> (<em>r</em> = .29) and so the variance they explain in <code>finalex</code> is <em>shared</em>.</p>
<p><br />
We could represent this on a Venn diagram as follows:</p>
<p><img src="images/Venn3.jpg" /></p>
<p>The correlation is represented as an overlap in the circles. Their total area (57.16%) is therefore <em>less</em> than the area they’d explain if there were no overlap (69.48%) (i.e., if there was no correlation).</p>
<p><strong>This demonstrates an important point</strong>: The <em>t</em>-tests on the coefficients in a multiple regression assess the <strong>unique</strong> contribution of each predictor in the model. That is, they test the variance a predictor explains in an outcome variable, <strong>after</strong> the variance explained by the other predictors has been taken into account. This is why <code>project</code> is not statistically significant in the multiple regression model – it only explains a small amount of variance once <code>entrex</code> has been taken into account.</p>
<div class="tip">
<p>It is possible to think of the <em>F</em>-statistic and <em>t</em>-value in multiple regression in terms of the Venn diagram:</p>
<ul>
<li><p>The <strong><em>F</em>-statistic</strong> compares the explained variance with the unexplained variance. The explained variance is represented by the <strong><em>outline</em></strong> of the two circles in the Venn diagram above. The unexplained variance is the remaining blue area of the rectangle.</p></li>
<li><p>The <strong><em>t</em>-value</strong> compares the unique variance a predictor explains with the remaining unexplained variance. For example, for <code>project</code> in the Venn diagram above, this would be the area in the orange <strong><em>crescent</em></strong>, relative to the remaining blue area in the rectangle.</p></li>
</ul>
</div>
</div>
<div id="multicollinearity" class="section level2">
<h2>Multicollinearity</h2>
<p>If the correlation between predictors is very high (greater than <em>r</em> = 0.9), this is known as <strong>multicollinearity</strong>. On a Venn diagram, the circles representing the predictors would almost completely overlap. Multicollinearity can be a problem in multiple regression. Predictors may explain a large amount of variance in the outcome variable, but their ‘unique’ contribution in a multiple regression may be small. A situation can arise where <em>neither</em> predictor may be statistically significant even though the overall regression is significant!</p>
<p><img src="images/Venn_multi.jpg" /></p>
<p>An example of multicollinearity in the <code>ExamData</code> dataset can be seen with the variables <code>project</code> and <code>proposal</code>.</p>
<div class="exercise">
<p>Obtain the correlation between <code>project</code> and <code>proposal</code>:</p>
<div class="solution">
<button>
Show me
</button>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">ExamData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">select</span>(project, proposal) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">cor</span>()</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="op">&gt;</span><span class="st">            </span>project  proposal</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="op">&gt;</span><span class="st"> </span>project  <span class="fl">1.0000000</span> <span class="fl">0.9371487</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="op">&gt;</span><span class="st"> </span>proposal <span class="fl">0.9371487</span> <span class="fl">1.0000000</span></a></code></pre></div>
</div>
<p>The correlation between <code>project</code> and <code>proposal</code> is <em>r</em> = <input class='solveme nospaces' size='4' data-answer='["0.94",".94"]'/>.</p>
<p>To see the effects of multicollinearity, conduct a regression with <code>finalex</code> as the outcome variable and <code>project</code> and <code>proposal</code> as the predictor variables.</p>
<div class="solution">
<button>
Show me
</button>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">multi1 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>project <span class="op">+</span><span class="st"> </span>proposal, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">summary</span>(multi1)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>project <span class="op">+</span><span class="st"> </span>proposal, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb10-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-64.287</span> <span class="fl">-22.590</span>  <span class="fl">-0.346</span>  <span class="fl">22.395</span>  <span class="fl">70.289</span> </a>
<a class="sourceLine" id="cb10-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)</a>
<a class="sourceLine" id="cb10-14" title="14"><span class="op">&gt;</span><span class="st"> </span>(Intercept)   <span class="fl">4.8784</span>    <span class="fl">40.8601</span>   <span class="fl">0.119</span>    <span class="fl">0.906</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="op">&gt;</span><span class="st"> </span>project       <span class="fl">1.2751</span>     <span class="fl">1.7072</span>   <span class="fl">0.747</span>    <span class="fl">0.461</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="op">&gt;</span><span class="st"> </span>proposal      <span class="fl">0.1826</span>     <span class="fl">1.7263</span>   <span class="fl">0.106</span>    <span class="fl">0.916</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">30.81</span> on <span class="dv">30</span> degrees of freedom</a>
<a class="sourceLine" id="cb10-19" title="19"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1641</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1084</span> </a>
<a class="sourceLine" id="cb10-20" title="20"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">2.945</span> on <span class="dv">2</span> and <span class="dv">30</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.06797</span></a></code></pre></div>
</div>
<ul>
<li><p>How much variance in <code>finalex</code> is explained by the model: <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' data-tol='0.02' size='5' data-answer='["16.41"]'/> %.</p></li>
<li><p>Is the overall regression statistically significant? <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>Is the coefficient for <code>project</code> statistically significant? <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li>Is the coefficient for <code>proposal</code> statistically significant? <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></li>
</ul>
</div>
<div class="exercise">
<p>Now run two simple regressions to determine whether <code>project</code> and <code>proposal</code> explain variance in <code>finalex</code> and are statistically significant predictors when in models on their own.</p>
<div class="solution">
<button>
Show me
</button>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">multi2 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">summary</span>(multi2)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb11-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-64.015</span> <span class="fl">-21.686</span>  <span class="fl">-0.573</span>  <span class="fl">21.758</span>  <span class="fl">70.427</span> </a>
<a class="sourceLine" id="cb11-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)  </a>
<a class="sourceLine" id="cb11-13" title="13"><span class="op">&gt;</span><span class="st"> </span>(Intercept)   <span class="fl">4.6968</span>    <span class="fl">40.1677</span>   <span class="fl">0.117</span>   <span class="fl">0.9077</span>  </a>
<a class="sourceLine" id="cb11-14" title="14"><span class="op">&gt;</span><span class="st"> </span>project       <span class="fl">1.4442</span>     <span class="fl">0.5861</span>   <span class="fl">2.464</span>   <span class="fl">0.0195</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">30.32</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb11-19" title="19"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1638</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1368</span> </a>
<a class="sourceLine" id="cb11-20" title="20"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">6.072</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.01948</span></a>
<a class="sourceLine" id="cb11-21" title="21"></a>
<a class="sourceLine" id="cb11-22" title="22">multi3 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>proposal, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb11-23" title="23"><span class="kw">summary</span>(multi3)</a>
<a class="sourceLine" id="cb11-24" title="24"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>proposal, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb11-27" title="27"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb11-30" title="30"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-64.987</span> <span class="fl">-22.987</span>  <span class="fl">-1.378</span>  <span class="fl">24.059</span>  <span class="fl">68.921</span> </a>
<a class="sourceLine" id="cb11-31" title="31"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)  </a>
<a class="sourceLine" id="cb11-34" title="34"><span class="op">&gt;</span><span class="st"> </span>(Intercept)   <span class="fl">16.628</span>     <span class="fl">37.441</span>   <span class="fl">0.444</span>   <span class="fl">0.6601</span>  </a>
<a class="sourceLine" id="cb11-35" title="35"><span class="op">&gt;</span><span class="st"> </span>proposal       <span class="fl">1.391</span>      <span class="fl">0.598</span>   <span class="fl">2.326</span>   <span class="fl">0.0267</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb11-38" title="38"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">30.59</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb11-40" title="40"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1486</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1211</span> </a>
<a class="sourceLine" id="cb11-41" title="41"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">5.409</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.02675</span></a></code></pre></div>
</div>
<ul>
<li><p>In a simple regression with <code>finalex</code> as the outcome variable, and <code>project</code> as the predictor variable, <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' data-tol='0.1' size='4' data-answer='["16.4"]'/> %.</p></li>
<li><p>Is the overall regression statistically significant? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>In a simple regression with <code>finalex</code> as the outcome variable, and <code>proposal</code> as the predictor variable, <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' data-tol='0.1' size='4' data-answer='["14.9"]'/> %.</p></li>
<li><p>Is the overall regression statistically significant? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>Try to explain what’s going on here in your own words. Click below or ask if you get stuck.</p></li>
</ul>
<div class="solution">
<button>
Explain
</button>
<p><em>Interpretation</em></p>
<ul>
<li><p>Because <code>proposal</code> and <code>project</code> are highly correlated (<em>r</em> = 0.94), this gives rise to the situation where the simple regressions indicate that they explain variance in <code>finalex</code>, but when both are included as predictors in a multiple regression, it appears as if neither are significant predictors of <code>finalex</code> !</p></li>
<li><p>If this were a real scenario, we’d consider dropping <code>project</code> or <code>proposal</code> from the model. Because the correlation is so high, having one predictor is as good as having the other (more or less).</p></li>
<li><p>It seems intuitive that a person’s final project mark would be highly correlated with their proposal mark.</p></li>
<li><p>The take-home message here is to check for high correlations between your predictor variables before including them in a multiple regression.</p></li>
</ul>
</div>
</div>
</div>
<div id="final-exercise" class="section level2">
<h2>Final exercise</h2>
<div class="exercise">
<p>As a final exercise, run a multiple regression to predict <code>finalex</code> from <strong>three</strong> predictors: <code>entrex</code>, <code>project</code>, and <code>iq</code>.</p>
<div class="solution">
<button>
Show me how
</button>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">multi4 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>project <span class="op">+</span><span class="st"> </span>iq, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">summary</span>(multi4)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>project <span class="op">+</span><span class="st"> </span>iq, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb12-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-40.444</span> <span class="fl">-16.174</span>   <span class="fl">5.509</span>  <span class="fl">14.312</span>  <span class="fl">33.338</span> </a>
<a class="sourceLine" id="cb12-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="er">&gt;</span><span class="st">              </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb12-14" title="14"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-130.3803</span>    <span class="fl">54.7288</span>  <span class="fl">-2.382</span> <span class="fl">0.023981</span> <span class="op">*</span><span class="st">  </span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="er">&gt;</span><span class="st"> </span>entrex         <span class="fl">2.6180</span>     <span class="fl">0.5978</span>   <span class="fl">4.379</span> <span class="fl">0.000142</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="er">&gt;</span><span class="st"> </span>project        <span class="fl">0.6874</span>     <span class="fl">0.4490</span>   <span class="fl">1.531</span> <span class="fl">0.136620</span>    </a>
<a class="sourceLine" id="cb12-17" title="17"><span class="op">&gt;</span><span class="st"> </span>iq             <span class="fl">0.4862</span>     <span class="fl">0.4610</span>   <span class="fl">1.055</span> <span class="fl">0.300214</span>    </a>
<a class="sourceLine" id="cb12-18" title="18"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.02</span> on <span class="dv">29</span> degrees of freedom</a>
<a class="sourceLine" id="cb12-22" title="22"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5875</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5448</span> </a>
<a class="sourceLine" id="cb12-23" title="23"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">13.77</span> on <span class="dv">3</span> and <span class="dv">29</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">9.168e-06</span></a></code></pre></div>
</div>
<p>Which variables are statistically significant predictors of <code>finalex</code>?</p>
<ul>
<li><p><code>entrex</code> <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p><code>project</code> <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p><code>iq</code> <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
</ul>
<p>On the basis of all the models conducted so far (with <code>entrex</code>, <code>project</code>, and <code>iq</code>), which model would you choose to best predict <code>finalex</code>?</p>
<div class="solution">
<button>
Tell me which model seems best
</button>
<p>The model containing <code>entrex</code> alone, as this seems to provide the simplest and most effective model of the <code>finalex</code>.</p>
<p>A general goal of regression is to identify the fewest predictor variables necessary to predict an outcome variable, where each predictor variable predicts a substantial and independent segment of the variability in the outcome variable.</p>
</div>
</div>
</div>
<div id="summary-of-key-points" class="section level2">
<h2>Summary of key points</h2>
<ul>
<li><p>Predictors can be added to a model in <code>lm</code> using the <code>+</code> symbol</p></li>
<li><p>e.g., <code>lm(finalex ~ entrex + project + iq)</code></p></li>
<li><p>Predictor variables are often correlated to some extent. This can affect the interpretation of individual predictor variables. Venn diagrams help to understand the results.</p></li>
<li><p>The <strong><em>F</em>-statistic</strong> tells us whether the model <em>as a whole</em> significantly predicts the outcome variable.</p></li>
<li><p>The <strong><em>t</em>-values</strong> tell us whether individual predictors in the model are statistically significant.</p></li>
<li><p>In multiple regression, it’s important to understand that the statistical significance of individual predictors only holds <strong>after taking into account the other predictors in the model</strong>.</p></li>
<li><p><strong>Multicollinearity</strong> exists when predictors are very highly correlated (<em>r</em> above 0.9) and should be avoided.</p></li>
</ul>
<!--chapter:end:06-building-models.rmd-->
</div>
</div>
<div id="building2" class="section level1">
<h1>Building models 2</h1>
<p><em>November 2020</em></p>
<div id="in-brief-1" class="section level3">
<h3>In brief</h3>
<blockquote>
<p>In this session we discuss model selection in the context of ANOVA and the use
of Bayes Factors to choose between theoretically interesting models.</p>
</blockquote>
</div>
<div id="using-anova-and-bayes-factors-to-compare-models" class="section level2">
<h2>Using ANOVA and Bayes Factors to compare models</h2>
<ul>
<li><a href="slides/PSYC753_Chris2.pptx"><strong>Slides for the session</strong></a></li>
</ul>
<p><br />
</p>
<div id="overview-1" class="section level3">
<h3>Overview</h3>
<p>In the previous session, we saw that we can construct a linear model to predict an outcome variable (e.g., <em>final exam score</em> from <em>entrance exam score</em>). We also investigated how we can <em>improve</em> a model by adding several continuous predictors to it.</p>
<p><br />
How do we know if one model is <em>better</em> or should be <em>preferred</em> over another model? We touched on a common sense approach in the last session - we ideally want models that explain the variance in an outcome variable but each predictor in the model should make a sizable and relatively independent contribution to the model.</p>
<p><br />
</p>
<p>Today we will cover a more formal approach to model comparison using:</p>
<ul>
<li><p><strong>ANOVA (Analysis of Variance)</strong> and</p></li>
<li><p><strong>Bayes Factors</strong></p></li>
</ul>
<p><br />
</p>
<p>It’s important that you are comfortable with the material from the first <a href="building-models-1.html">Building Models 1 session</a> before proceeding today.</p>
</div>
</div>
<div id="comparing-models-using-anova" class="section level2">
<h2>Comparing models using ANOVA</h2>
<p>We can use ANOVA to determine whether the addition of variables into a model leads to a statistically significant improvement in the variance it explains <em>overall</em>. We may want to do this, for example, when building on existing theories or models.</p>
<p><br />
We’ll start by comparing a model with <em>one</em> predictor vs. a model with <em>three</em> predictors.</p>
<p><br />
Using the <code>ExamData</code> from the previous session, we’ll run:</p>
<ul>
<li><p>a linear model with <code>finalex</code> as the outcome variable, and <code>entrex</code> as the predictor.</p></li>
<li><p>a linear model with <code>finalex</code> as the outcome variable, and <code>entrex</code>,<code>age</code>, and <code>project</code> as the predictors.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">ExamData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://bit.ly/37GkvJg&#39;</span>)              </a>
<a class="sourceLine" id="cb13-2" title="2">model1   &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData)           </a>
<a class="sourceLine" id="cb13-3" title="3">model2   &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData) </a></code></pre></div>
<p><br />
<strong>Explanation of the code</strong>: first the data is loaded into <code>ExamData</code>. The results of the simple regression are stored in <code>model1</code>. Those of the multiple regression are stored in <code>model2</code>.</p>
<p><br />
Use <code>summary()</code> to display the results of each regression:</p>
<p><strong>Model 1:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">summary</span>(model1)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb14-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-54.494</span> <span class="fl">-21.185</span>   <span class="fl">3.733</span>  <span class="fl">18.124</span>  <span class="fl">30.969</span> </a>
<a class="sourceLine" id="cb14-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb14-12" title="12"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-46.3045</span>    <span class="fl">25.4773</span>  <span class="fl">-1.817</span>   <span class="fl">0.0788</span> .  </a>
<a class="sourceLine" id="cb14-13" title="13"><span class="op">&gt;</span><span class="st"> </span>entrex        <span class="fl">3.1545</span>     <span class="fl">0.5324</span>   <span class="fl">5.925</span> <span class="fl">1.52e-06</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.7</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb14-18" title="18"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.531</span>,   Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5159</span> </a>
<a class="sourceLine" id="cb14-19" title="19"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st">  </span><span class="fl">35.1</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">1.52e-06</span></a></code></pre></div>
<p><br />
<strong>Model 2:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">summary</span>(model2)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb15-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-42.563</span> <span class="fl">-16.519</span>   <span class="fl">4.901</span>  <span class="fl">16.991</span>  <span class="fl">36.424</span> </a>
<a class="sourceLine" id="cb15-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="er">&gt;</span><span class="st">              </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb15-12" title="12"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-117.9159</span>    <span class="fl">46.4211</span>  <span class="fl">-2.540</span>   <span class="fl">0.0167</span> <span class="op">*</span><span class="st">  </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="er">&gt;</span><span class="st"> </span>entrex         <span class="fl">3.0889</span>     <span class="fl">0.5734</span>   <span class="fl">5.387</span> <span class="fl">8.66e-06</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="er">&gt;</span><span class="st"> </span>age            <span class="fl">1.4231</span>     <span class="fl">1.3756</span>   <span class="fl">1.035</span>   <span class="fl">0.3094</span>    </a>
<a class="sourceLine" id="cb15-15" title="15"><span class="op">&gt;</span><span class="st"> </span>project        <span class="fl">0.6280</span>     <span class="fl">0.4609</span>   <span class="fl">1.363</span>   <span class="fl">0.1835</span>    </a>
<a class="sourceLine" id="cb15-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.03</span> on <span class="dv">29</span> degrees of freedom</a>
<a class="sourceLine" id="cb15-20" title="20"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5869</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5442</span> </a>
<a class="sourceLine" id="cb15-21" title="21"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">13.73</span> on <span class="dv">3</span> and <span class="dv">29</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">9.353e-06</span></a></code></pre></div>
<p><br />
(If you are not sure what it means by “e-06” in the output above then see the FAQs <a href="#e-meaning">here</a>)</p>
<div class="exercise">
<p>Make note of the variance explained by each model (<span class="math inline">\(R^2\)</span>), i.e., <code>Multiple R-squared</code>: (report as a percentage, to 2 decimal places)</p>
<ul>
<li><p>Model 1: <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='5' data-answer='["53.10"]'/> %</p></li>
<li><p>Model 2: <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='5' data-answer='["58.69"]'/> %</p></li>
</ul>
<p>Which model explains a greater proportion of variance in <code>finalex</code>? <select class='solveme' data-answer='["entrex, age, project"]'> <option></option> <option>extrex alone</option> <option>entrex, age, project</option></select></p>
<ul>
<li>Calculate the difference in <span class="math inline">\(R^2\)</span> between the models. <code>model2</code> improves the prediction of <code>finalex</code> by <input class='solveme nospaces' size='4' data-answer='["5.59"]'/> %</li>
</ul>
</div>
<p><br />
To compare the variance explained by each model, use <code>anova()</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">anova</span>(model1, model2)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>finalex <span class="op">~</span><span class="st"> </span>entrex</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project</a>
<a class="sourceLine" id="cb16-6" title="6"><span class="op">&gt;</span><span class="st">   </span>Res.Df   RSS Df Sum of Sq      F <span class="kw">Pr</span>(<span class="op">&gt;</span>F)</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>     <span class="dv">31</span> <span class="dv">15981</span>                           </a>
<a class="sourceLine" id="cb16-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>     <span class="dv">29</span> <span class="dv">14078</span>  <span class="dv">2</span>      <span class="dv">1903</span> <span class="fl">1.9601</span> <span class="fl">0.1591</span></a></code></pre></div>
<p><br />
<strong>Explanation of the output:</strong></p>
<ul>
<li><p><strong><code>anova()</code></strong> compares the variance that <code>model1</code> and <code>model2</code> explain with an <em>F</em>-statistic.</p></li>
<li><p><strong><code>Pr(&gt;F)</code></strong> gives the <em>p</em>-value for this statistic. If the <em>p</em>-value is less than .05, then we can reject the null hypothesis that there is no difference in the variance explained by each model, and we can say that the variance that <code>model2</code> explains in <code>finalex</code> is significantly greater than that of <code>model1</code>.</p></li>
<li><p>We can report the <em>F</em>-statistic in APA style as <em>F</em>(2, 29) = 1.96, <em>p</em> = .16. We can say that the additional 5.59% variance that <code>model2</code> explains relative to <code>model1</code> does not represent a statistically significant increase in <span class="math inline">\(R^2\)</span>, and so <code>model2</code> should <strong>not</strong> be preferred over <code>model1</code>.</p></li>
</ul>
<p><br />
</p>
<div class="tip">
<p>Comparing models in steps as we’ve done is sometimes called <strong>hierarchical regression</strong> or <strong>sequential regression</strong>. This type of regression is usually used for logical or theoretical reasons, when we want to know the contribution of a predictor (or a set of predictors) <strong>over and above</strong> an existing one.</p>
</div>
<div class="exercise">
<p><strong>Now, you try using <code>anova</code> to compare models.</strong></p>
<p>The variable <code>attendance</code> in <code>ExamData</code> scores individuals according to whether their class attendance was low (0) or high (1). A researcher suspects that <code>attendance</code> may explain additional variance in <code>finalex</code> over and above <code>entrex</code>.</p>
<p>As an exercise, compare the following two models using the <code>anova()</code> approach above:</p>
<ol style="list-style-type: decimal">
<li><p>a model with <code>entrex</code> as a sole predictor of <code>finalex</code> (i.e., <code>model1</code>), and</p></li>
<li><p>a model where <code>finalex</code> is predicted by <code>extrex</code> and <code>attendance</code> (call this <code>model3</code>).</p></li>
</ol>
<p>Is there sufficient evidence that a model with <code>entrex</code> <em>and</em> <code>attendance</code> explains more variance than a model with <code>entrex</code> alone?</p>
<div class="solution">
<button>
Try yourself first, then click to see the code
</button>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># model1 was created earlier</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">summary</span>(model1)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb17-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-54.494</span> <span class="fl">-21.185</span>   <span class="fl">3.733</span>  <span class="fl">18.124</span>  <span class="fl">30.969</span> </a>
<a class="sourceLine" id="cb17-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb17-13" title="13"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-46.3045</span>    <span class="fl">25.4773</span>  <span class="fl">-1.817</span>   <span class="fl">0.0788</span> .  </a>
<a class="sourceLine" id="cb17-14" title="14"><span class="op">&gt;</span><span class="st"> </span>entrex        <span class="fl">3.1545</span>     <span class="fl">0.5324</span>   <span class="fl">5.925</span> <span class="fl">1.52e-06</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">22.7</span> on <span class="dv">31</span> degrees of freedom</a>
<a class="sourceLine" id="cb17-19" title="19"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.531</span>,   Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5159</span> </a>
<a class="sourceLine" id="cb17-20" title="20"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st">  </span><span class="fl">35.1</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">1.52e-06</span></a>
<a class="sourceLine" id="cb17-21" title="21"></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="co"># specify model3</span></a>
<a class="sourceLine" id="cb17-23" title="23">model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>attendance, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb17-24" title="24"></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="co"># show model3</span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="kw">summary</span>(model3)</a>
<a class="sourceLine" id="cb17-27" title="27"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-28" title="28"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>attendance, <span class="dt">data =</span> ExamData)</a>
<a class="sourceLine" id="cb17-30" title="30"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb17-33" title="33"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-42.750</span> <span class="fl">-11.750</span>   <span class="fl">1.801</span>   <span class="fl">9.689</span>  <span class="fl">30.347</span> </a>
<a class="sourceLine" id="cb17-34" title="34"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb17-36" title="36"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb17-37" title="37"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">-63.3108</span>    <span class="fl">20.2768</span>  <span class="fl">-3.122</span>  <span class="fl">0.00395</span> <span class="op">**</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-38" title="38"><span class="er">&gt;</span><span class="st"> </span>entrex        <span class="fl">3.2741</span>     <span class="fl">0.4173</span>   <span class="fl">7.846</span> <span class="fl">9.35e-09</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb17-39" title="39"><span class="er">&gt;</span><span class="st"> </span>attendance   <span class="fl">28.8202</span>     <span class="fl">6.3398</span>   <span class="fl">4.546</span> <span class="fl">8.37e-05</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb17-40" title="40"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb17-41" title="41"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb17-42" title="42"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-43" title="43"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">17.76</span> on <span class="dv">30</span> degrees of freedom</a>
<a class="sourceLine" id="cb17-44" title="44"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7223</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7038</span> </a>
<a class="sourceLine" id="cb17-45" title="45"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">39.02</span> on <span class="dv">2</span> and <span class="dv">30</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">4.499e-09</span></a>
<a class="sourceLine" id="cb17-46" title="46"></a>
<a class="sourceLine" id="cb17-47" title="47"><span class="co">#compare model1 and model3</span></a>
<a class="sourceLine" id="cb17-48" title="48"><span class="kw">anova</span>(model1, model3)</a>
<a class="sourceLine" id="cb17-49" title="49"><span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table</a>
<a class="sourceLine" id="cb17-50" title="50"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-51" title="51"><span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>finalex <span class="op">~</span><span class="st"> </span>entrex</a>
<a class="sourceLine" id="cb17-52" title="52"><span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>attendance</a>
<a class="sourceLine" id="cb17-53" title="53"><span class="op">&gt;</span><span class="st">   </span>Res.Df     RSS Df Sum of Sq      F   <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </a>
<a class="sourceLine" id="cb17-54" title="54"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>     <span class="dv">31</span> <span class="fl">15980.6</span>                                 </a>
<a class="sourceLine" id="cb17-55" title="55"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>     <span class="dv">30</span>  <span class="fl">9462.4</span>  <span class="dv">1</span>    <span class="fl">6518.1</span> <span class="fl">20.665</span> <span class="fl">8.37e-05</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb17-56" title="56"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb17-57" title="57"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a></code></pre></div>
</div>
<ul>
<li><p>The variance explained by a model with <code>entrex</code> alone is <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='5' data-answer='["53.10"]'/> %</p></li>
<li><p>The <span class="math inline">\(R^2\)</span> for the model that also included <code>attendance</code> was <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='5' data-answer='["72.23"]'/> %</p></li>
<li><p>The increase in <span class="math inline">\(R^2\)</span> was <input class='solveme nospaces' size='5' data-answer='["19.13"]'/>%</p></li>
<li><p>The ANOVA comparing models can be reported as: <em>F</em>(<input class='solveme nospaces' size='1' data-answer='["1"]'/>, <input class='solveme nospaces' size='2' data-answer='["30"]'/>) = <input class='solveme nospaces' size='5' data-answer='["20.67"]'/>, <em>p</em> &lt; .001.</p></li>
<li><p>The increase in <span class="math inline">\(R^2\)</span> was <select class='solveme' data-answer='["statistically significant"]'> <option></option> <option>statistically significant</option> <option>not significant</option></select>.</p></li>
<li><p>As indicated by the estimates of the coefficients for <code>entrex</code> and <code>attendance</code>, both <select class='solveme' data-answer='["positively"]'> <option></option> <option>negatively</option> <option>positively</option></select> predict <code>finalex</code>.</p></li>
<li><p>A higher <code>entrex</code> score and greater <code>attendance</code> is associated with a <select class='solveme' data-answer='["higher"]'> <option></option> <option>higher</option> <option>lower</option></select> <code>finalex</code> score.</p></li>
</ul>
</div>
</div>
</div>
<div id="comparing-models-using-bayes-factors" class="section level2">
<h2>Comparing models using Bayes Factors</h2>
<p>An alternative approach to using ANOVA to compare models is to use <strong>Bayes Factors</strong>.</p>
<p><br />
A <strong>Bayes Factor</strong> is the <strong>probability of obtaining the data under one model compared to another</strong> (Rouder &amp; Morey, 2012).</p>
<p><br />
For example, a Bayes Factor equal to 2 would tell us that the data are <em>twice</em> as likely under one model than another. A Bayes Factor equal to 0.5 would tell us that the data are <em>half</em> as likely under one model than another.</p>
<p><br />
Unlike classical tests of statistical significance (with <em>p</em>-values), Bayes Factors also allow us to <em>quantify</em> evidence for the null hypothesis. Very handy!</p>
<p><br />
To compute a Bayes Factor for a specific linear model, we use <code>lmBF</code> in the <code>BayesFactor</code> package (where <code>lm</code> stands for <em>linear model</em> and <code>BF</code> stands for <em>Bayes Factor</em>).</p>
<p><br />
First, we need to load the <code>BayesFactor</code> package:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">library</span>(<span class="st">&#39;BayesFactor&#39;</span>)</a></code></pre></div>
<p>We can use the <code>lmBF</code> function in the same way we use <code>lm</code>. The function will return a <strong>Bayes Factor</strong> for the model we specify.</p>
<p><br />
Let’s determine the Bayes Factor for <code>model1</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">model1.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(finalex <span class="op">~</span><span class="st"> </span>entrex, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(ExamData) )  </a></code></pre></div>
<p><strong>Explanation of the code</strong>: The model is specified in exactly the same way as with <code>lm</code>. Due to a limitation of the package, however, we must convert <code>ExamData</code> from a tibble to a data frame using <code>as.data.frame</code>. Otherwise, the command works in the same way. The results are stored in <code>model1.BF</code>.</p>
<p><br />
To look at what’s stored in <code>model1.BF</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">model1.BF</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">:</span><span class="st"> </span><span class="fl">8310.846</span> ±<span class="fl">0.01</span>%</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="er">&gt;</span><span class="st">   </span>Intercept only </a>
<a class="sourceLine" id="cb20-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
<p><strong>Explanation of the output</strong>:</p>
<ul>
<li><p>The Bayes Factor provided for the model with <code>entrex</code> is equal to <strong>8310.85</strong>.</p></li>
<li><p>The <code>Against denominator: Intercept only</code> means that the model with <code>entrex</code> is being compared with a model that contains an <strong>intercept only</strong>. In an intercept-only model, the coefficient for <code>entrex</code> is equal to zero; that is, the regression line is a flat line (equal to the <em>mean</em> of <code>entrex</code>).</p></li>
<li><p>The value of our Bayes Factor indicates that the model with <code>entrex</code> in is much more likely than a model that contains only an intercept (8310.85 times more likely, to be precise). We can therefore be confident that a model with <code>entrex</code> is preferable to the intercept only model (just as with our classical analysis). Happy days!</p></li>
</ul>
<p><br />
Now let’s do the same for <code>model2</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># specify the model</span></a>
<a class="sourceLine" id="cb21-2" title="2">model2.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(ExamData) )</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co"># show the Bayes Factor</span></a>
<a class="sourceLine" id="cb21-5" title="5">model2.BF</a>
<a class="sourceLine" id="cb21-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb21-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project <span class="op">:</span><span class="st"> </span><span class="fl">2427.676</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="er">&gt;</span><span class="st">   </span>Intercept only </a>
<a class="sourceLine" id="cb21-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
<p><br />
</p>
<p><strong>Explanation:</strong> The Bayes Factor is equal to <strong>2427.68</strong>. Again, this indicates that the model with <code>entrex</code> and <code>age</code> is much more likely than a model with only the intercept in (this is not that surprising given the result for <code>model1.BF</code> above).</p>
<p>But, what we want to know is whether <code>model2</code> (containing <code>entrex</code> and <code>age</code>) is <strong>more</strong> likely than <code>model1</code> (containing only <code>entrex</code>). We can determine this by <em>dividing</em> the Bayes Factor for <code>model2</code> by the Bayes Factor for <code>model1</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">model2.BF <span class="op">/</span><span class="st"> </span>model1.BF</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>project <span class="op">:</span><span class="st"> </span><span class="fl">0.2921093</span> ±<span class="fl">0.01</span>%</a>
<a class="sourceLine" id="cb22-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="er">&gt;</span><span class="st">   </span>finalex <span class="op">~</span><span class="st"> </span>entrex </a>
<a class="sourceLine" id="cb22-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
<p><strong>Explanation:</strong> The Bayes Factor for this comparison is 0.29. This means that <code>model2</code> is <strong><em>less than a third as likely</em></strong> than <code>model1</code>. So, <code>model2</code> is much <em>less</em> likely than <code>model1</code>. Not good news for <code>model2</code>!</p>
<div class="tip">
<p><strong>Interpreting the Bayes Factor</strong></p>
<ul>
<li><p>A Bayes Factor <strong>equal to 1</strong> tells us that probability of each model is the same.</p></li>
<li><p>A Bayes Factor <strong>greater than 1</strong> means that <code>model2</code> is more likely than <code>model1</code>.</p></li>
<li><p>A Bayes Factor <strong>less than 1</strong> means that <code>model1</code> is more likely than <code>model2</code>.</p></li>
</ul>
<p><strong>Thus, our Bayes Factor of 0.29 indicates that <code>model1</code> is more likely than <code>model2</code>.</strong></p>
</div>
<div class="tip">
<p><strong>Reporting Bayes Factors</strong></p>
<p><br />
</p>
<p><strong>Notation</strong></p>
<p>We usually write the Bayes Factor in reports as <span class="math inline">\(BF_{10}\)</span> where:</p>
<ul>
<li><p>the subscript <strong>1</strong> in <span class="math inline">\(BF_{10}\)</span> denotes the less-constrained model (the alternative hypothesis). This is the model with <strong>more predictors</strong> (our <code>model2</code>).</p></li>
<li><p>the subscript <strong>0</strong> in <span class="math inline">\(BF_{10}\)</span> denotes the more constrained or simpler model (i.e., the null hypothesis). This is the model with <strong>fewer predictors</strong> (our <code>model1</code>).</p></li>
</ul>
<p>(You can just write BF10 if you prefer.)</p>
<p><br />
</p>
<p><strong>The Size of the Bayes Factor</strong></p>
<ul>
<li><p>If the Bayes Factor is <strong>greater than 3</strong> (i.e., <span class="math inline">\(BF_{10}\)</span> &gt; 3), we say that there is <strong>substantial evidence for <code>model2</code></strong> (the less constrained model).</p></li>
<li><p>If the Bayes Factor is <strong>less than 0.33</strong> (i.e., <span class="math inline">\(BF_{10}\)</span> &lt; 0.33), we usually say that there is <strong>substantial evidence for <code>model1</code></strong> (the more constrained model).</p></li>
<li><p>We say that intermediate values for the Bayes Factor (between 0.33 and 3) don’t offer strong evidence for either model.</p></li>
</ul>
</div>
<p>Thus, because our Bayes Factor of 0.29 is less than 1, this indicates greater evidence for <code>model1</code> than <code>model2</code>. Furthermore, because the Bayes Factor is less than 0.33, we have <em>substantial</em> evidence for <code>model1</code> over <code>model2</code>.</p>
<p><br />
It’s becoming increasingly common to report the Bayes Factor alongside the results of a classical analysis. Thus, we could report our results as follows: “There was insufficient evidence that the addition of age and project to the model containing entrance exam resulted in an increase in <span class="math inline">\(R^2\)</span>, <em>F</em>(2, 29) = 1.96, <em>p</em> = .16; BF10 = 0.29.”</p>
<div class="exercise">
<p><strong>Now you try using Bayes Factors to compare models</strong></p>
<p>To supplement the comparison of <code>model3</code> and <code>model1</code> that you did with <code>anova</code>, now compute the Bayes Factor for <code>model3</code> vs. <code>model1</code>.</p>
<p><br />
You’ll need the following steps:</p>
<ul>
<li><p>Model 1: Obtain the Bayes Factor for a model with <code>extrex</code> as a sole predictor of <code>finalex</code> (we did this already above; it’s stored in <code>model1.BF</code>)</p></li>
<li><p>Model 2: Obtain the Bayes Factor for a model where <code>finalex</code> is predicted by <code>extrex</code> <em>and</em> <code>attendance</code> and store this in <code>model3.BF</code>.</p></li>
<li><p>Compare the Bayes Factors in <code>model3.BF</code> and <code>model1.BF</code>.<br />
</p></li>
</ul>
<div class="solution">
<button>
Try yourself first, then click here for the code
</button>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># 1. show the BF for model1 vs. intercept only</span></a>
<a class="sourceLine" id="cb23-2" title="2">model1.BF  </a>
<a class="sourceLine" id="cb23-3" title="3"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">:</span><span class="st"> </span><span class="fl">8310.846</span> ±<span class="fl">0.01</span>%</a>
<a class="sourceLine" id="cb23-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="er">&gt;</span><span class="st">   </span>Intercept only </a>
<a class="sourceLine" id="cb23-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a>
<a class="sourceLine" id="cb23-11" title="11"></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="co"># 2. Obtain the BF for model3 vs. intercept only, then show it</span></a>
<a class="sourceLine" id="cb23-13" title="13">model3.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(finalex <span class="op">~</span><span class="st"> </span>entrex <span class="op">+</span><span class="st"> </span>attendance, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(ExamData) )</a>
<a class="sourceLine" id="cb23-14" title="14"></a>
<a class="sourceLine" id="cb23-15" title="15">model3.BF</a>
<a class="sourceLine" id="cb23-16" title="16"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb23-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">+</span><span class="st"> </span>attendance <span class="op">:</span><span class="st"> </span><span class="dv">2351114</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb23-19" title="19"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-20" title="20"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb23-21" title="21"><span class="er">&gt;</span><span class="st">   </span>Intercept only </a>
<a class="sourceLine" id="cb23-22" title="22"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb23-23" title="23"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a>
<a class="sourceLine" id="cb23-24" title="24"></a>
<a class="sourceLine" id="cb23-25" title="25"><span class="co"># 3. Compare the BFs for model3 vs model1</span></a>
<a class="sourceLine" id="cb23-26" title="26">model3.BF <span class="op">/</span><span class="st"> </span>model1.BF</a>
<a class="sourceLine" id="cb23-27" title="27"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb23-28" title="28"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] entrex <span class="op">+</span><span class="st"> </span>attendance <span class="op">:</span><span class="st"> </span><span class="fl">282.897</span> ±<span class="fl">0.01</span>%</a>
<a class="sourceLine" id="cb23-30" title="30"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-31" title="31"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb23-32" title="32"><span class="er">&gt;</span><span class="st">   </span>finalex <span class="op">~</span><span class="st"> </span>entrex </a>
<a class="sourceLine" id="cb23-33" title="33"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb23-34" title="34"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
</div>
<p><br />
<strong>Answer the following questions from the output:</strong></p>
<p>How much more likely is a model with<code>entrex</code> than an intercept only model?</p>
<ul>
<li><input class='solveme nospaces' size='7' data-answer='["8310.85"]'/> times more likely.</li>
</ul>
<p>How much more likely is a model with <code>entrex</code> and <code>attendance</code> than an intercept only model?</p>
<ul>
<li><input class='solveme nospaces' size='7' data-answer='["2351114"]'/> times more likely.</li>
</ul>
<p>How much more likely is a model with <code>entrex</code> and <code>attendance</code> as predictors than a model with <code>entrex</code> alone?</p>
<ul>
<li><input class='solveme nospaces' size='6' data-answer='["282.90"]'/> times more likely.</li>
</ul>
<p>There is <select class='solveme' data-answer='["strong"]'> <option></option> <option>insufficient</option> <option>strong</option></select> evidence that a model with <code>entrex</code> and <code>attendance</code> should be preferred over a model with <code>entrex</code> alone, given the data.</p>
</div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>Now you will practise using ANOVA and Bayes Factors to compare models with a new dataset.</p>
<p><br />
<strong>Scenario:</strong> A researcher would like to construct a model to predict scores in a memory task from several different variables. The data from 234 individuals are stored in the <code>memory_data</code> dataset, which are located at <a href="https://bit.ly/37pOTrC" class="uri">https://bit.ly/37pOTrC</a>.</p>
<div class="exercise">
<p>Use <code>read_csv</code> to load in the data at the link above to the variable <code>memory_data</code> and preview it with <code>head()</code>.</p>
<div class="solution">
<button>
Try this yourself first. Click to show code
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">memory_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://bit.ly/37pOTrC&#39;</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">memory_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="er">&gt;</span><span class="st">   </span>attention   sex blueberries    iq   age sleep memory_score</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>      <span class="fl">95.8</span>     <span class="dv">1</span>         <span class="dv">308</span>  <span class="fl">99.9</span>  <span class="fl">44.9</span>  <span class="fl">9.94</span>        <span class="fl">128.</span> </a>
<a class="sourceLine" id="cb24-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>      <span class="fl">66.7</span>     <span class="dv">1</span>         <span class="dv">270</span> <span class="fl">137.</span>   <span class="fl">29.4</span>  <span class="fl">8.04</span>        <span class="fl">127.</span> </a>
<a class="sourceLine" id="cb24-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>     <span class="fl">102.</span>      <span class="dv">1</span>         <span class="dv">442</span> <span class="fl">110.</span>   <span class="fl">31.9</span> <span class="fl">11.0</span>         <span class="fl">118.</span> </a>
<a class="sourceLine" id="cb24-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>      <span class="fl">36.9</span>     <span class="dv">1</span>         <span class="dv">219</span> <span class="fl">110.</span>   <span class="fl">27.9</span>  <span class="fl">5.28</span>         <span class="fl">95.5</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>      <span class="fl">91.7</span>     <span class="dv">0</span>         <span class="dv">450</span> <span class="fl">119.</span>   <span class="fl">36.7</span>  <span class="fl">9.30</span>        <span class="fl">122.</span> </a>
<a class="sourceLine" id="cb24-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>     <span class="fl">146.</span>      <span class="dv">1</span>         <span class="dv">255</span>  <span class="fl">85.6</span>  <span class="fl">23.9</span>  <span class="fl">7.05</span>        <span class="fl">102.</span></a></code></pre></div>
</div>
<div class="tip">
<p><strong>About the data:</strong></p>
<ul>
<li><p><strong>attention</strong>: sustained attention score (higher = better attention)</p></li>
<li><p><strong>sex</strong>: 0 = female, 1 = male</p></li>
<li><p><strong>blueberries</strong>: average number of blueberries consumed per year</p></li>
<li><p><strong>iq</strong>: the individual’s IQ</p></li>
<li><p><strong>age</strong>: age of person in years</p></li>
<li><p><strong>sleep</strong>: average hours of sleep per night</p></li>
<li><p><strong>memory_score</strong>: memory test score</p></li>
</ul>
</div>
<p>The researcher wants to test whether <code>attention</code> and <code>sleep</code> predict <code>memory_score</code>. She is already aware of a well-established finding in the literature, which is that <code>iq</code> and <code>age</code> predict <code>memory_score</code>.</p>
<p><br />
She therefore wants to use a hierarchical regression approach to determine whether <code>attention</code> and <code>sleep</code> explain additional variance in <code>memory_score</code> <em>over and above</em> <code>iq</code> and <code>age</code>.</p>
<p><br />
1. First, fit a linear model to determine the extent to which <code>memory_score</code> is predicted by <code>iq</code> and <code>age</code>. Store the results in <code>memory1</code>.</p>
<div class="solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># specify the baseline model</span></a>
<a class="sourceLine" id="cb25-2" title="2">memory1 &lt;-<span class="st"> </span><span class="kw">lm</span>(memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> memory_data)</a>
<a class="sourceLine" id="cb25-3" title="3"></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co"># see the model results</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="kw">summary</span>(memory1)</a>
<a class="sourceLine" id="cb25-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> memory_data)</a>
<a class="sourceLine" id="cb25-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb25-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-44.154</span> <span class="fl">-11.754</span>   <span class="fl">0.732</span>  <span class="fl">11.608</span>  <span class="fl">40.790</span> </a>
<a class="sourceLine" id="cb25-13" title="13"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-14" title="14"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb25-16" title="16"><span class="op">&gt;</span><span class="st"> </span>(Intercept)  <span class="fl">71.1669</span>     <span class="fl">9.0796</span>   <span class="fl">7.838</span> <span class="fl">1.67e-13</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="er">&gt;</span><span class="st"> </span>iq            <span class="fl">0.1073</span>     <span class="fl">0.0699</span>   <span class="fl">1.534</span>    <span class="fl">0.126</span>    </a>
<a class="sourceLine" id="cb25-18" title="18"><span class="op">&gt;</span><span class="st"> </span>age           <span class="fl">0.8220</span>     <span class="fl">0.1461</span>   <span class="fl">5.627</span> <span class="fl">5.27e-08</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-21" title="21"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-22" title="22"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">16.1</span> on <span class="dv">231</span> degrees of freedom</a>
<a class="sourceLine" id="cb25-23" title="23"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1303</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.1228</span> </a>
<a class="sourceLine" id="cb25-24" title="24"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">17.31</span> on <span class="dv">2</span> and <span class="dv">231</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">9.875e-08</span></a></code></pre></div>
</div>
<p><br />
2. Next, add <code>attention</code> and <code>sleep</code> to the model, storing your results in <code>memory2</code>.</p>
<div class="solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># specify the next model</span></a>
<a class="sourceLine" id="cb26-2" title="2">memory2 &lt;-<span class="st"> </span><span class="kw">lm</span>(memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep, <span class="dt">data =</span> memory_data)</a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co"># show the results</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">summary</span>(memory2)</a>
<a class="sourceLine" id="cb26-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep, <span class="dt">data =</span> memory_data)</a>
<a class="sourceLine" id="cb26-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="er">&gt;</span><span class="st">     </span>Min      1Q  Median      3Q     Max </a>
<a class="sourceLine" id="cb26-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-28.935</span>  <span class="fl">-8.555</span>   <span class="fl">1.713</span>   <span class="fl">8.450</span>  <span class="fl">31.384</span> </a>
<a class="sourceLine" id="cb26-13" title="13"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb26-16" title="16"><span class="op">&gt;</span><span class="st"> </span>(Intercept)  <span class="fl">9.60112</span>    <span class="fl">8.57889</span>   <span class="fl">1.119</span> <span class="fl">0.264246</span>    </a>
<a class="sourceLine" id="cb26-17" title="17"><span class="op">&gt;</span><span class="st"> </span>iq           <span class="fl">0.18673</span>    <span class="fl">0.05451</span>   <span class="fl">3.426</span> <span class="fl">0.000726</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb26-18" title="18"><span class="er">&gt;</span><span class="st"> </span>age          <span class="fl">0.86579</span>    <span class="fl">0.11308</span>   <span class="fl">7.656</span> <span class="fl">5.32e-13</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="er">&gt;</span><span class="st"> </span>attention    <span class="fl">0.22894</span>    <span class="fl">0.02757</span>   <span class="fl">8.302</span> <span class="fl">8.88e-15</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="er">&gt;</span><span class="st"> </span>sleep        <span class="fl">3.68609</span>    <span class="fl">0.39328</span>   <span class="fl">9.373</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb26-21" title="21"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb26-22" title="22"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-24" title="24"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">12.46</span> on <span class="dv">229</span> degrees of freedom</a>
<a class="sourceLine" id="cb26-25" title="25"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4839</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4749</span> </a>
<a class="sourceLine" id="cb26-26" title="26"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">53.68</span> on <span class="dv">4</span> and <span class="dv">229</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></a></code></pre></div>
</div>
<p><br />
3. Now, compare the <code>memory1</code> and <code>memory2</code> models using <code>anova()</code></p>
<div class="solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">anova</span>(memory1, memory2)</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age</a>
<a class="sourceLine" id="cb27-5" title="5"><span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep</a>
<a class="sourceLine" id="cb27-6" title="6"><span class="op">&gt;</span><span class="st">   </span>Res.Df   RSS Df Sum of Sq      F    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </a>
<a class="sourceLine" id="cb27-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>    <span class="dv">231</span> <span class="dv">59912</span>                                  </a>
<a class="sourceLine" id="cb27-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>    <span class="dv">229</span> <span class="dv">35554</span>  <span class="dv">2</span>     <span class="dv">24359</span> <span class="fl">78.447</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a></code></pre></div>
</div>
<p><br />
<br />
<strong>Answer the following questions:</strong></p>
<ul>
<li><p>A model with <code>iq</code> and <code>age</code> as predictors explains <input class='solveme nospaces' size='5' data-answer='["13.03"]'/> % of the variance in <code>memory_scores</code></p></li>
<li><p>A model with <code>iq</code>, <code>age</code>, <code>attention</code> and <code>sleep</code> as predictors explains <input class='solveme nospaces' size='5' data-answer='["48.39"]'/> % of the variance in <code>memory_scores</code></p></li>
<li><p>Calculate the additional variance explained by the second model: Change in <span class="math inline">\(R^2\)</span> = <input class='solveme nospaces' size='5' data-answer='["35.36"]'/> %</p></li>
<li><p>The ANOVA comparing models can be reported as: <em>F</em>(<input class='solveme nospaces' size='1' data-answer='["2"]'/>, <input class='solveme nospaces' size='3' data-answer='["229"]'/>) = <input class='solveme nospaces' size='5' data-answer='["78.45"]'/>, <em>p</em> &lt; .001.</p></li>
<li><p>Is there a statistically significant improvement in the prediction of <code>memory_scores</code> as a result of adding <code>attention</code> and <code>sleep</code> to the model? <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p></li>
</ul>
<p><br />
<br />
<strong>Now use Bayes Factors to determine how much more likely the <code>memory2</code> model is than the <code>memory1</code> model .</strong></p>
<p><br />
</p>
<div class="solution">
<button>
Try first, click here for a reminder of the steps
</button>
<ul>
<li><p>Determine the Bayes Factor for <code>memory1</code></p></li>
<li><p>Determine the Bayes Factor for <code>memory2</code></p></li>
<li><p>Compare the Bayes Factors for <code>memory2</code> and <code>memory1</code></p></li>
</ul>
</div>
<p><br />
</p>
<div class="solution">
<button>
Try first, click here to see the code
</button>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># Store the Bayes Factor for the first model in memory1.BF</span></a>
<a class="sourceLine" id="cb28-2" title="2">memory1.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(memory_data) )</a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co"># Store the Bayes Factor for the second model in memory2.BF</span></a>
<a class="sourceLine" id="cb28-5" title="5">memory2.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(memory_data) )</a>
<a class="sourceLine" id="cb28-6" title="6"></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co"># Compute the Bayes Factors for memory2.BF vs memory1.BF</span></a>
<a class="sourceLine" id="cb28-8" title="8">memory2.BF <span class="op">/</span><span class="st"> </span>memory1.BF</a>
<a class="sourceLine" id="cb28-9" title="9"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb28-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep <span class="op">:</span><span class="st"> </span><span class="fl">4.168455e+23</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb28-12" title="12"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="er">&gt;</span><span class="st">   </span>memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age </a>
<a class="sourceLine" id="cb28-15" title="15"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Answer the following questions:</strong></p>
<ul>
<li><p>The Bayes Factor comparing <code>memory2</code> and <code>memory1</code> to (2 decimal places) is <input class='solveme nospaces' size='4' data-answer='["4.17"]'/> e+ <input class='solveme nospaces' size='2' data-answer='["23"]'/>.</p></li>
<li><p>Does the Bayes Factor support the conclusions from the ANOVA? <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p></li>
</ul>
<div class="solution">
<button>
Click for answer
</button>
<p>Yes! The Bayes Factor is equal to <span class="math inline">\(4.17 \times 10^{23}\)</span>, and this therefore strongly supports the inclusion of <code>attention</code> and <code>sleep</code> in the model already containing <code>iq</code> and <code>age</code>.</p>
</div>
<p><br />
</p>
<p><br />
<strong>Extra exercises, if there’s time</strong></p>
<p><strong>1.</strong></p>
<p>The researcher wishes to predict the <code>memory_score</code> for a new individual with <code>iq</code> = 105, <code>age</code> = 27, <code>attention</code> = 90, <code>sleep</code> = 8. Determine the prediction.</p>
<p><br />
Hint: in a previous session, you have previously used the <code>predict()</code> function to do this.</p>
<p><br />
</p>
<ul>
<li>The predicted <code>memory_score</code> is <input class='solveme nospaces' size='6' data-answer='["102.68"]'/></li>
</ul>
<div class="solution">
<button>
Try first, then click to show the code for the answer
</button>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># create tibble for the new data</span></a>
<a class="sourceLine" id="cb29-2" title="2">new_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">iq =</span> <span class="dv">105</span>, <span class="dt">age =</span> <span class="dv">27</span>, <span class="dt">attention =</span> <span class="dv">90</span>, <span class="dt">sleep =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb29-3" title="3"></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># use predict to derive prediction from new data</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="kw">predict</span>(memory2, new_data)</a>
<a class="sourceLine" id="cb29-6" title="6"><span class="op">&gt;</span><span class="st">        </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb29-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="fl">102.6768</span></a></code></pre></div>
</div>
<p><br />
<br />
<strong>2.</strong></p>
<p>The researcher is interested to know whether annual consumption of blueberries has any bearing on <code>memory_scores</code>, and so wants to add <code>blueberries</code> to the model in <code>memory2</code>.</p>
<p><br />
Determine the Bayes Factor comparing <code>memory2</code> with a model that additionally contains <code>blueberries</code>.</p>
<ul>
<li><p>The Bayes Factor for the model comparison is <input class='solveme nospaces' size='4' data-answer='["0.17",".17"]'/> (to 2 decimal places)</p></li>
<li><p>The Bayes Factor indicates that the model with <code>blueberries</code> is <select class='solveme' data-answer='["less likely"]'> <option></option> <option>more likely</option> <option>less likely</option></select> than the model without it.</p></li>
<li><p>Should the researcher add <code>blueberries</code> to the model? <select class='solveme' data-answer='["no"]'> <option></option> <option>no</option> <option>yes</option> <option>if it tastes good</option></select></p></li>
</ul>
<div class="solution">
<button>
Try yourself first, then click for the code
</button>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># add blueberries to memory2; store in memory3.BF</span></a>
<a class="sourceLine" id="cb30-2" title="2">memory3.BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep <span class="op">+</span><span class="st"> </span>blueberries, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(memory_data) )</a>
<a class="sourceLine" id="cb30-3" title="3"></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co"># calculate the BF for memory3 vs memory2</span></a>
<a class="sourceLine" id="cb30-5" title="5">memory3.BF <span class="op">/</span><span class="st"> </span>memory2.BF</a>
<a class="sourceLine" id="cb30-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep <span class="op">+</span><span class="st"> </span>blueberries <span class="op">:</span><span class="st"> </span><span class="fl">0.1663574</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb30-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="er">&gt;</span><span class="st">   </span>memory_score <span class="op">~</span><span class="st"> </span>iq <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>attention <span class="op">+</span><span class="st"> </span>sleep </a>
<a class="sourceLine" id="cb30-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
</div>
</div>
</div>
<div id="summary-of-key-points-1" class="section level2">
<h2>Summary of key points</h2>
<ul>
<li><p>We can compare a model with one that has more predictors by using <code>anova(model1, model2)</code>.</p></li>
<li><p>We can compare models using Bayes Factors with <code>lmBF</code> in the <code>BayesFactor</code> package.</p></li>
<li><p>A <strong>Bayes Factor</strong> is probability of one model relative to another, <em>given the data</em>.</p></li>
<li><p>To compare Bayes Factors of models:</p>
<ul>
<li><p>First obtain the Bayes Factors for <code>model1</code> and <code>model2</code>.</p></li>
<li><p>Then use <code>model2 / model1</code> to get the Bayes Factor, indicating how much more likely <code>model2</code> is.</p></li>
</ul></li>
<li><p>Bayes Factors less than 1 indicate evidence for <code>model1</code></p></li>
<li><p>Bayes Factors greater than 1 indicate evidence for <code>model2</code></p></li>
<li><p>We can report Bayes Factors as <span class="math inline">\(BF_{10}\)</span> = 2.23 (or BF10 = 2.23)</p></li>
</ul>
<p><br />
</p>
<p>Next week’s session will build on what was done in this session, so make sure you understand what was covered and ask the instructor to clarify anything you’re unsure of.</p>
<!--chapter:end:06-building-models-2.rmd-->
</div>
</div>
<div id="fitcurves" class="section level1">
<h1>Fitting curves</h1>
<p><em>November 2020</em></p>
<div id="in-brief-2" class="section level3">
<h3>In brief</h3>
<blockquote>
<p>So far all our regression models have assumed that our variables have
<strong><em>linear relationships</em></strong>. That isn’t always the case, and sometimes we need
to fit curved lines to describe the relationship of predictors and outcomes.
As we saw before, fitting curved lines has costs as well as benefits: A curved
line is more likely to <strong>overfit</strong> the data, and may be less good at
predicting new data. But for some models curved lines are essential to
describe the world as it really is.</p>
</blockquote>
<p><br />
</p>
</div>
<div id="using-polynomials-to-fit-curves" class="section level2">
<h2>Using polynomials to fit curves</h2>
<ul>
<li><a href="slides/PSYC753_Chris3.pptx"><strong>Slides for the session</strong></a></li>
</ul>
<p><br />
</p>
<div id="overview-2" class="section level3">
<h3>Overview</h3>
<p>In this session we will:</p>
<ul>
<li><p>See how we can add <em>polynomial terms</em> such as <span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span> to a regression model to capture non-linear relationships.</p></li>
<li><p>Use ANOVA and Bayes Factors to determine whether these terms improve the model.</p></li>
</ul>
<p><br />
</p>
<p>You should be comfortable with what we did in the previous <strong>Building Models 1</strong> and <strong>Building Models 2</strong> sessions before attempting this one.</p>
<p><br />
</p>
</div>
</div>
<div id="polynomials" class="section level2">
<h2>Polynomials</h2>
<p><br />
</p>
<p>The regression models we have been fitting assume a <strong>linear</strong> (i.e., straight line) relationship between variables. However, variables may not always be related in a linear fashion.</p>
<p><br />
</p>
<p>Suppose variables x and y showed the following trend:</p>
<p><img src="07-fitting-curves_files/figure-html/fig1-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>It is clear that this relationship would not be explained well by a straight line. We’d lose important information about the relationship if we only fit a straight line. A curve would be better.</p>
<p><br />
</p>
<p>We can fit a curve to the data by adding <strong>polynomial</strong> terms to the regression equation.</p>
<p><br />
</p>
<p><strong>Polynomial</strong> means that a variable is raised to a particular power. For example:</p>
<ul>
<li><p><span class="math inline">\(x^2\)</span> means x-squared, which is x-multiplied-by-x, or “x to the power of two”</p></li>
<li><p><span class="math inline">\(x^3\)</span> means x-cubed, which is x-multiplied-by-x-multiplied-by-x, or “x to the power of three”</p></li>
</ul>
<p><br />
</p>
<p>If a model has a <strong>quadratic component</strong> it means it has an <span class="math inline">\(x^2\)</span> term in the equation.</p>
<p>If a model has a <strong>cubic component</strong> it means it has an <span class="math inline">\(x^3\)</span> term in the equation.</p>
<p><br />
</p>
<p>To see why this approach works, recall that lines can be represented by equations.</p>
<div id="components-of-a-regression-line" class="section level3">
<h3>Components of a regression line</h3>
<p>The equation <strong><span class="math inline">\(y = 1 + 0.5x\)</span></strong> would be represented as follows:</p>
<p><img src="07-fitting-curves_files/figure-html/fig4-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We can think of this line as being made up of the <strong>constant</strong> and a <strong>linear</strong> component.</p>
<ul>
<li>The <strong>constant</strong> in this equation is indicated by the dashed horizontal line.</li>
<li>The <strong>linear</strong> component to this equation 0.5x is indicated by the dashed slope line.</li>
<li>The solid blue line is a <em>combination</em> of these two components.</li>
</ul>
<p><br />
</p>
</div>
<div id="quadratic" class="section level3">
<h3>Quadratic</h3>
<p>The equation <strong><span class="math inline">\(y = x^2\)</span></strong> would be represented as follows:</p>
<p><img src="07-fitting-curves_files/figure-html/fig5-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>To get each value of y, we square the value of x.</p>
<p><br />
So, when x = -5, y is 25.</p>
<p>And if x = -4, y = 16, and so on…</p>
<p><br />
</p>
<p><strong><span class="math inline">\(y = -x^2\)</span></strong>, would look as follows:</p>
<p><img src="07-fitting-curves_files/figure-html/fig6-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Curves with quadratic components have <strong>one bend</strong>.</p>
<p><br />
</p>
</div>
<div id="cubic" class="section level3">
<h3>Cubic</h3>
<p>The equation <strong><span class="math inline">\(y = x^3\)</span></strong> would be represented as follows:</p>
<p><img src="07-fitting-curves_files/figure-html/fig7-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>To get each value of y, we <em>cube</em> the value of x.</p>
<p>So, when x = -5, y is -125.</p>
<p>And if x = 10, y = 1000, and so on…</p>
<p><br />
</p>
<p><strong><span class="math inline">\(y = -x^3\)</span></strong>, would look as follows:</p>
<p><img src="07-fitting-curves_files/figure-html/fig8-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Curves with cubic components have <strong>two bends</strong>.</p>
<p><br />
</p>
</div>
<div id="linear-plus-quadratic-components" class="section level3">
<h3>Linear plus quadratic components</h3>
<p>The equation <strong><span class="math inline">\(y = 50 + 5x - x^2\)</span></strong> has</p>
<ul>
<li>a constant equal to <strong>50</strong></li>
<li>a linear component <strong>5x</strong></li>
<li>a quadratic component <strong><span class="math inline">\(-x^2\)</span></strong>:</li>
</ul>
<p><img src="07-fitting-curves_files/figure-html/fig9-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>The dashed lines on the plot indicate the <em>intercept</em>, <em>linear component</em>, and <em>quadratic component</em> of the equation. The solid line represents the equation.</p>
<p><br />
</p>
</div>
<div id="linear-quadratic-cubic-components" class="section level3">
<h3>Linear + quadratic + cubic components</h3>
<p>The equation <strong><span class="math inline">\(y = 5000 + 750x - 50x^2 - 20x^3\)</span></strong> has</p>
<ul>
<li>a constant equal to <strong>5000</strong></li>
<li>a linear component <strong>750x</strong></li>
<li>a negative quadratic component <strong><span class="math inline">\(-50x^2\)</span></strong></li>
<li>a negative cubic component <strong><span class="math inline">\(-20x^3\)</span></strong></li>
</ul>
<p><img src="07-fitting-curves_files/figure-html/fig10-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>The dashed lines in the plot indicate the different components of the curve indicated by the solid blue line.</p>
<p>When we see any curve, it is possible to think of it as being composed of components like this. In theory, we can keep adding components, but it’s rare to see even higher-order components (e.g., <span class="math inline">\(x^4\)</span>) being added. Issues regarding overfitting and generalisability can also arise (mentioned in the slides).</p>
</div>
</div>
<div id="identifying-polynomial-components" class="section level2">
<h2>Identifying polynomial components</h2>
<p>To determine whether a model should have quadratic, cubic, or higher order components, we can use the <strong>sequential regression</strong> approach covered in the previous session. We take the following steps, and look at the change in <span class="math inline">\(R^2\)</span> associated with each step.</p>
<ul>
<li><p>First fit the <strong>linear</strong> model</p></li>
<li><p>then test for the addition of the <strong>quadratic (<span class="math inline">\(x^2\)</span>)</strong> component</p></li>
<li><p>then test for the addition of the <strong>cubic (<span class="math inline">\(x^3\)</span>)</strong> component</p></li>
</ul>
<p><br />
</p>
<p>Let’s see this in action!</p>
<div class="tip">
<p><strong>Learning tip</strong></p>
<p>Try storing all your code in an <strong>R Markdown</strong> file today if you are not doing so already! You can use code chunks and write text to describe each chunk as was described in the slides.</p>
</div>
<p><br />
We’ll use a dataset inspired by a 2016 survey of the National Office for Statistics. They investigated happiness across the life span. Approximately 300,000 individuals of all ages answered questions related to well-being.</p>
<p><br />
Each participant answered the following question regarding their <em>happiness</em>:</p>
<p><strong>"Overall, how happy did you feel yesterday?</strong><br />
<strong>Where 0 is ‘not at all happy’ and 10 is ‘completely happy’."</strong></p>
<p> </p>
<p>This <code>happy</code> dataset are located at “<a href="https://bit.ly/2uIxM5K" class="uri">https://bit.ly/2uIxM5K</a>”.</p>
<p><br />
</p>
<p>Let’s load the data into R, and preview the data using <code>head</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># load the data</span></a>
<a class="sourceLine" id="cb31-2" title="2">SurveyData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://bit.ly/2uIxM5K&quot;</span>)</a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co"># preview it</span></a>
<a class="sourceLine" id="cb31-5" title="5">SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb31-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="er">&gt;</span><span class="st">     </span>age happiness anxiety</a>
<a class="sourceLine" id="cb31-8" title="8"><span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>  <span class="fl">66.0</span>      <span class="fl">7.85</span>    <span class="fl">2.33</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>  <span class="fl">35.0</span>      <span class="fl">7.56</span>    <span class="fl">2.58</span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>  <span class="fl">58.6</span>      <span class="fl">7.59</span>    <span class="fl">3.43</span></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>  <span class="fl">35.0</span>      <span class="fl">7.06</span>    <span class="fl">1.67</span></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>  <span class="fl">60.2</span>      <span class="fl">7.96</span>    <span class="fl">2.13</span></a>
<a class="sourceLine" id="cb31-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>  <span class="fl">67.5</span>      <span class="fl">8.11</span>    <span class="fl">1.09</span></a></code></pre></div>
<p><br />
Plot the relationship between <code>age</code> and <code>happiness</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">SurveyData <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>happiness)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="07-fitting-curves_files/figure-html/fig11-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p>If you had to guess from the plot, which components seem to be present in the relationship between <code>happiness</code> and <code>age</code>?</p>
<p>Linear: <select class='solveme' data-answer='["possibly"]'> <option></option> <option>no</option> <option>possibly</option></select></p>
<p>Quadratic: <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<p>Cubic: <select class='solveme' data-answer='["no"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<p><br />
</p>
<p>Try to describe the relationship between <code>happiness</code> and <code>age</code>.</p>
<div class="solution">
<button>
Try first, click here for a description
</button>
<p>Happiness of individuals appears to decline from 30 years to the late forties. Happiness then increases beyond the late forties, reaching its peak at 70 years, at which age people reported the highest levels of happiness - higher even than levels shown in early thirties.</p>
</div>
</div>
<p><br />
</p>
<div id="linear-component" class="section level3">
<h3>Linear component</h3>
<p>To determine whether there is a linear component, run a simple regression with <code>happiness</code> as the outcome variable and <code>age</code> as the predictor:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">polynomial1 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">summary</span>(polynomial1)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max </a>
<a class="sourceLine" id="cb33-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.78019</span> <span class="fl">-0.16858</span> <span class="fl">-0.04762</span>  <span class="fl">0.19811</span>  <span class="fl">0.84368</span> </a>
<a class="sourceLine" id="cb33-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb33-13" title="13"><span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">6.484101</span>   <span class="fl">0.102340</span>   <span class="fl">63.36</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="er">&gt;</span><span class="st"> </span>age         <span class="fl">0.021076</span>   <span class="fl">0.001979</span>   <span class="fl">10.65</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2912</span> on <span class="dv">148</span> degrees of freedom</a>
<a class="sourceLine" id="cb33-19" title="19"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4339</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4301</span> </a>
<a class="sourceLine" id="cb33-20" title="20"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">113.5</span> on <span class="dv">1</span> and <span class="dv">148</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></a></code></pre></div>
<p><strong>Explanation:</strong> The linear model is stored in <code>polynomial1</code>. <code>summary</code> displays the results.</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> scores is explained by <code>age</code>? <select class='solveme' data-answer='["43.39"]'> <option></option> <option>0.44</option> <option>43.39</option> <option>29.12</option></select> %</p>
<p>Is <code>age</code> a statistically significant predictor of <code>happiness</code> <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p>
</div>
<p><br />
</p>
<p>The linear model does okay, but remember it is only fitting a straight line through our data, which appear to show a curved relationship!</p>
<p><br />
</p>
</div>
<div id="adding-a-quadratic-component" class="section level3">
<h3>Adding a quadratic component</h3>
<p>We can add a quadratic component to the regression model using <code>poly()</code>. If we type <code>poly(age, 2)</code> when specifying the model, the ‘2’ in the <code>poly()</code> function tells R that we want to fit a model with <strong>both</strong> linear and quadratic components of <code>age</code>. This is the model it’ll fit:</p>
<p><br />
</p>
<p><span class="math inline">\(predicted \: happiness = a + b_1(age) + b_2(age^2)\)</span></p>
<p><br />
</p>
<p>where <span class="math inline">\(a\)</span> is the intercept, and <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are the coefficients for the linear and quadratic components, respectively.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"></a>
<a class="sourceLine" id="cb34-2" title="2">polynomial2 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">2</span>), <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw">summary</span>(polynomial2)</a>
<a class="sourceLine" id="cb34-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>), <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb34-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max </a>
<a class="sourceLine" id="cb34-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.58896</span> <span class="fl">-0.12752</span> <span class="fl">-0.02333</span>  <span class="fl">0.13274</span>  <span class="fl">0.59724</span> </a>
<a class="sourceLine" id="cb34-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb34-13" title="13"><span class="er">&gt;</span><span class="st">               </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb34-14" title="14"><span class="op">&gt;</span><span class="st"> </span>(Intercept)    <span class="fl">7.54433</span>    <span class="fl">0.01779</span>  <span class="fl">424.06</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb34-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)<span class="dv">1</span>  <span class="fl">3.10223</span>    <span class="fl">0.21789</span>   <span class="fl">14.24</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb34-16" title="16"><span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)<span class="dv">2</span>  <span class="fl">2.36118</span>    <span class="fl">0.21789</span>   <span class="fl">10.84</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb34-17" title="17"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-20" title="20"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2179</span> on <span class="dv">147</span> degrees of freedom</a>
<a class="sourceLine" id="cb34-21" title="21"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6853</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.681</span> </a>
<a class="sourceLine" id="cb34-22" title="22"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">160.1</span> on <span class="dv">2</span> and <span class="dv">147</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></a></code></pre></div>
<p><strong>Explanation of the code:</strong> We’ve told R we want to add a quadratic component to the model by using <code>happiness ~ poly(age, 2)</code>.</p>
<p><br />
</p>
<p><strong>Explanation of the output:</strong> You will see in the output separate coefficient estimates for <code>poly(age, 2)1</code> and <code>poly(age, 2)</code>. These are the estimates of the coefficients for the linear and quadratic components of <code>age</code> (i.e., <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> in the equation above).</p>
<p><br />
</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> does a model with a <strong>quadratic component</strong> of <code>age</code> explain? <input class='solveme nospaces' size='5' data-answer='["68.53"]'/> %</p>
<p><br />
</p>
<p>Compare the value of <span class="math inline">\(R^2\)</span> in <code>polynomial1</code> and <code>polynomial2</code>.</p>
<ul>
<li><p>Does the addition of a quadratic component result in a numerical increase in <span class="math inline">\(R^2\)</span> in <code>polynomial2</code>? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the change in <span class="math inline">\(R^2\)</span>? <input class='solveme nospaces' size='5' data-answer='["25.14"]'/> % (to 2 decimal places)</p></li>
</ul>
<div class="solution">
<button>
Click to see how the answer is calculated
</button>
<p><span class="math inline">\(R^2\)</span> change from <code>polynomial1</code> to <code>polynomial2</code> = 68.53 - 43.39 = 25.14%</p>
<p>Therefore, the model with the quadratic component of <code>age</code> accounts for <strong>25.14% more variance</strong> in <code>happiness</code> than the model with only a linear component.</p>
</div>
</div>
<p><br />
</p>
<p>We can test whether the <strong><em>increase</em> in <em>R</em><sup>2</sup></strong> in <code>polynomial2</code> represents a statistically significant increase by comparing <code>polynomial1</code> and <code>polynomial2</code> using <code>anova</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">anova</span>(polynomial1, polynomial2)</a>
<a class="sourceLine" id="cb35-3" title="3"><span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span>age</a>
<a class="sourceLine" id="cb35-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-7" title="7"><span class="op">&gt;</span><span class="st">   </span>Res.Df     RSS Df Sum of Sq      F    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </a>
<a class="sourceLine" id="cb35-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>    <span class="dv">148</span> <span class="fl">12.5542</span>                                  </a>
<a class="sourceLine" id="cb35-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>    <span class="dv">147</span>  <span class="fl">6.9791</span>  <span class="dv">1</span>    <span class="fl">5.5752</span> <span class="fl">117.43</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="er">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a></code></pre></div>
<div class="exercise">
<p>Is the increase in <span class="math inline">\(R^2\)</span> associated with the addition of the quadratic component statistically significant? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p>
<div class="solution">
<button>
Answer
</button>
<p>Yes. We can report the improvement in fit as follows:</p>
<p>A model with a quadratic component of <code>age</code> accounted for a statistically significantly greater proportion of variance in <code>happiness</code> than a model with only a linear component, <em>F</em>(1, 147) = 117.43, <em>p</em> &lt; .001.</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="adding-a-cubic-component" class="section level3">
<h3>Adding a cubic component</h3>
<p>Now we’ll test for a cubic component.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">polynomial3 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">3</span>), <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">summary</span>(polynomial3)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>), <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb36-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max </a>
<a class="sourceLine" id="cb36-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.60468</span> <span class="fl">-0.14165</span> <span class="fl">-0.01844</span>  <span class="fl">0.13839</span>  <span class="fl">0.58176</span> </a>
<a class="sourceLine" id="cb36-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="er">&gt;</span><span class="st">               </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </a>
<a class="sourceLine" id="cb36-13" title="13"><span class="op">&gt;</span><span class="st"> </span>(Intercept)    <span class="fl">7.54433</span>    <span class="fl">0.01777</span> <span class="fl">424.447</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">1</span>  <span class="fl">3.10223</span>    <span class="fl">0.21769</span>  <span class="fl">14.251</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb36-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">2</span>  <span class="fl">2.36118</span>    <span class="fl">0.21769</span>  <span class="fl">10.846</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb36-16" title="16"><span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">3</span> <span class="fl">-0.24530</span>    <span class="fl">0.21769</span>  <span class="fl">-1.127</span>    <span class="fl">0.262</span>    </a>
<a class="sourceLine" id="cb36-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb36-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb36-19" title="19"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-20" title="20"><span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2177</span> on <span class="dv">146</span> degrees of freedom</a>
<a class="sourceLine" id="cb36-21" title="21"><span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.688</span>,   Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6816</span> </a>
<a class="sourceLine" id="cb36-22" title="22"><span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">107.3</span> on <span class="dv">3</span> and <span class="dv">146</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></a></code></pre></div>
<p>The ‘3’ in <code>poly(age,3)</code> tells R that we want to specify a model with linear, quadratic <em>and</em> cubic components, of the form:</p>
<p><br />
</p>
<p><span class="math inline">\(happiness = a + b_1(age) + b_2(age^2) + b_3(age^3)\)</span></p>
<p><br />
</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> does a model with a <strong>cubic component</strong> of <code>age</code> explain? <input class='solveme nospaces' size='4' data-answer='["68.8"]'/> %</p>
<p><br />
</p>
<p>Compare the value of <span class="math inline">\(R^2\)</span> in <code>polynomial3</code> and <code>polynomial2</code>.</p>
<ul>
<li><p>Does the addition of a cubic component result in a numerical increase in <span class="math inline">\(R^2\)</span> in <code>polynomial3</code>? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the increase in <span class="math inline">\(R^2\)</span> as a result of adding in the cubic component? (Compare <span class="math inline">\(R^2\)</span> between <code>polynomial3</code> and <code>polynomial2</code>).</p>
The increase in <span class="math inline">\(R^2\)</span> is <input class='solveme nospaces' size='4' data-answer='["0.27",".27"]'/> %</li>
</ul>
</div>
<p>To determine if the increase in <span class="math inline">\(R^2\)</span> is statistically significant, we can again use <code>anova</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">anova</span>(polynomial2, polynomial3)</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-7" title="7"><span class="op">&gt;</span><span class="st">   </span>Res.Df    RSS Df Sum of Sq      F <span class="kw">Pr</span>(<span class="op">&gt;</span>F)</a>
<a class="sourceLine" id="cb37-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>    <span class="dv">147</span> <span class="fl">6.9791</span>                           </a>
<a class="sourceLine" id="cb37-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>    <span class="dv">146</span> <span class="fl">6.9189</span>  <span class="dv">1</span>  <span class="fl">0.060171</span> <span class="fl">1.2697</span> <span class="fl">0.2617</span></a></code></pre></div>
<div class="exercise">
<p>Is the increase in <span class="math inline">\(R^2\)</span> associated with the addition of a cubic component statistically significant? <select class='solveme' data-answer='["no"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<div class="solution">
<button>
Description of the answer
</button>
<p>The <code>anova</code> comparing <code>polynomial3</code> and <code>polynomial2</code> is not statistically significant, <em>F</em>(1, 146) = 1.27, <em>p</em> = .26, indicating that the addition of the cubic component of <code>age</code> into the regression model does not increase the variance in <code>happiness</code> explained.</p>
</div>
<p><br />
On the basis of the tests conducted so far, which model should be preferred? One with:</p>
<p><select class='solveme' data-answer='["linear and quadratic components of age"]'> <option></option> <option>a linear component of age only</option> <option>linear and quadratic components of age</option> <option>linear, quadratic, and cubic components of age</option></select></p>
<div class="solution">
<button>
Explain
</button>
<p>Our analyses suggest that a model with a quadratic component of <code>age</code> (i.e., the model in <code>polynomial2</code>) is sufficient to explain the data.</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="a-note-about-poly" class="section level3">
<h3>A note about <code>poly()</code></h3>
<p><code>poly</code> automatically creates polynomial terms for us. The polynomials it creates are actually a special type, called <strong>orthogonal</strong> polynomials. This means that the polynomials are not correlated with one another. For example, the correlation between the <span class="math inline">\(age\)</span> and <span class="math inline">\(age^2\)</span> components created by <code>poly</code> is zero . Likewise, the correlation betweem <span class="math inline">\(age^2\)</span> and <span class="math inline">\(age^3\)</span> components created by <code>poly</code> is also zero.</p>
<p><br />
This is desirable because if the components were not <strong>orthogonalised</strong>, they’d be highly correlated with each other. That is, the raw scores for <span class="math inline">\(age\)</span> and <span class="math inline">\(age \times age\)</span> are likely to be highly correlated. As we covered in the first Building Models 1 session, high correlations between our predictors is undesirable as it can lead to <strong>multicolinearity</strong>.</p>
</div>
</div>
<div id="bayesian-approach" class="section level2">
<h2>Bayesian approach</h2>
<p>As we did in the previous session, we can use Bayes Factors to compare the models with different polynomial components.</p>
<p><br />
</p>
<div id="preparations" class="section level3">
<h3>Preparations</h3>
<p>Unfortunately, <code>poly()</code> does not work seamlessly with <code>lmBF</code>, as it did with <code>lm</code>. Instead, we need to create separate variables in <code>SurveyData</code> for the quadratic and cubic components before we work out the Bayes Factors with <code>lmBF</code>.</p>
<p><br />
</p>
<p>To add the quadratic component to <code>SurveyData</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">SurveyData &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="st">  </span>SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">age2 =</span> <span class="kw">poly</span>(age,<span class="dv">2</span>)[,<span class="st">&quot;2&quot;</span>] )</a></code></pre></div>
<p><strong>Explanation of the code:</strong> The code takes <code>SurveyData</code>, then uses <code>mutate</code> to add a new variable <code>age2</code> to the dataset. <code>age2</code> contains the quadratic component of <code>age</code>, created by <code>poly(age,2)[,"2"]</code>.</p>
<p><br />
</p>
<p>We can see the new variable <code>age2</code> when we look at <code>SurveyData</code> again:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="er">&gt;</span><span class="st">     </span>age happiness anxiety    age2</a>
<a class="sourceLine" id="cb39-4" title="4"><span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>  <span class="fl">66.0</span>      <span class="fl">7.85</span>    <span class="fl">2.33</span>  <span class="fl">0.0761</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>  <span class="fl">35.0</span>      <span class="fl">7.56</span>    <span class="fl">2.58</span>  <span class="fl">0.0483</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>  <span class="fl">58.6</span>      <span class="fl">7.59</span>    <span class="fl">3.43</span> <span class="fl">-0.0440</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>  <span class="fl">35.0</span>      <span class="fl">7.06</span>    <span class="fl">1.67</span>  <span class="fl">0.0481</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>  <span class="fl">60.2</span>      <span class="fl">7.96</span>    <span class="fl">2.13</span> <span class="fl">-0.0246</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>  <span class="fl">67.5</span>      <span class="fl">8.11</span>    <span class="fl">1.09</span>  <span class="fl">0.110</span></a></code></pre></div>
<p><br />
</p>
<p>Now create the variable for the <strong>cubic component</strong>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">SurveyData &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="st">  </span>SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">age3 =</span> <span class="kw">poly</span>(age,<span class="dv">3</span>)[,<span class="st">&quot;3&quot;</span>] )</a></code></pre></div>
<p><strong>Explanation of the code:</strong> As before, the code takes <code>SurveyData</code>, then uses <code>mutate</code> to add a new variable <code>age3</code> to the dataset. <code>age3</code> contains the quadratic component of <code>age</code>, created by <code>poly(age,3)[,"3"]</code>.</p>
<p><br />
</p>
<p>Again, we can see the new variable <code>age3</code> when we look at <code>SurveyData</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">SurveyData <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="er">&gt;</span><span class="st">     </span>age happiness anxiety    age2     age3</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>  <span class="fl">66.0</span>      <span class="fl">7.85</span>    <span class="fl">2.33</span>  <span class="fl">0.0761</span>  <span class="fl">0.00888</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>  <span class="fl">35.0</span>      <span class="fl">7.56</span>    <span class="fl">2.58</span>  <span class="fl">0.0483</span>  <span class="fl">0.0353</span> </a>
<a class="sourceLine" id="cb41-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>  <span class="fl">58.6</span>      <span class="fl">7.59</span>    <span class="fl">3.43</span> <span class="fl">-0.0440</span> <span class="fl">-0.0988</span> </a>
<a class="sourceLine" id="cb41-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>  <span class="fl">35.0</span>      <span class="fl">7.06</span>    <span class="fl">1.67</span>  <span class="fl">0.0481</span>  <span class="fl">0.0356</span> </a>
<a class="sourceLine" id="cb41-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>  <span class="fl">60.2</span>      <span class="fl">7.96</span>    <span class="fl">2.13</span> <span class="fl">-0.0246</span> <span class="fl">-0.0974</span> </a>
<a class="sourceLine" id="cb41-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>  <span class="fl">67.5</span>      <span class="fl">8.11</span>    <span class="fl">1.09</span>  <span class="fl">0.110</span>   <span class="fl">0.0707</span></a></code></pre></div>
<p><br />
</p>
</div>
<div id="derive-the-bayes-factors" class="section level3">
<h3>Derive the Bayes Factors</h3>
<p><br />
First, make sure the BayesFactor package is loaded (<code>library(BayesFactor)</code>). We can use <code>lmBF</code> to get the Bayes Factor for each model, as we did in the previous session.</p>
<p><br />
</p>
<p>To derive the Bayes Factor for <code>polynomial1</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">polynomial1BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a></code></pre></div>
<p><br />
</p>
<p>To derive the Bayes Factor for <code>polynomial2</code>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># store the Bayes Factor for polynomial2</span></a>
<a class="sourceLine" id="cb43-2" title="2">polynomial2BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(happiness <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a></code></pre></div>
<p><strong>Explanation:</strong> With <code>lmBF</code> we need to specify the polynomial equation with both linear and quadratic components separately, hence <code>happiness ~ age + age2</code>.</p>
<p><br />
</p>
<p>The Bayes Factor comparing <code>polynomial2</code> and <code>polynomial1</code> is then:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">polynomial2BF <span class="op">/</span><span class="st"> </span>polynomial1BF</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] age <span class="op">+</span><span class="st"> </span>age2 <span class="op">:</span><span class="st"> </span><span class="fl">2.618277e+17</span> ±<span class="fl">0.01</span>%</a>
<a class="sourceLine" id="cb44-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb44-7" title="7"><span class="er">&gt;</span><span class="st">   </span>happiness <span class="op">~</span><span class="st"> </span>age </a>
<a class="sourceLine" id="cb44-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb44-9" title="9"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
<div class="exercise">
<p>How many more times likely is a model with a <strong>quadratic component</strong> of <code>age</code> than one with only a <strong>linear component</strong>?
<select class='solveme' data-answer='["2.62e+17"]'> <option></option> <option>2.62</option> <option>2.62e-17</option> <option>2.62e+17</option></select></p>
<p>Does this constitute strong evidence for the addition of a quadratic component?
<select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p>
<div class="solution">
<button>
Explain why
</button>
<p>The Bayes Factor tells us that a model with a quadratic component of <code>age</code> is 2.62e+17 or <span class="math inline">\(2.62 \times 10^{17}\)</span> times more likely than one that simply contains a linear component. This is very strong evidence for the inclusion of a quadratic component of <code>age</code> in the model.</p>
</div>
</div>
<p><br />
</p>
<p>Next, determine the Bayes Factor for <code>polynomial3</code>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">polynomial3BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(happiness <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2 <span class="op">+</span><span class="st"> </span>age3, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a></code></pre></div>
<p><strong>Explanation:</strong> Again, we need to specify the polynomial equation with linear, quadratic, and cubic components separately, hence <code>happiness ~ age + age2 + age3</code>.</p>
<p><br />
</p>
<p>Compare <code>polynomial3BF</code> and <code>polynomial2BF</code>:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">polynomial3BF <span class="op">/</span><span class="st"> </span>polynomial2BF</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] age <span class="op">+</span><span class="st"> </span>age2 <span class="op">+</span><span class="st"> </span>age3 <span class="op">:</span><span class="st"> </span><span class="fl">0.1631281</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb46-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="er">&gt;</span><span class="st">   </span>happiness <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2 </a>
<a class="sourceLine" id="cb46-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
<div class="exercise">
<p>How many more times likely is a model with a <strong>cubic component</strong> than one with only <strong>linear and quadratic components</strong>?
<input class='solveme nospaces' size='4' data-answer='["0.16"]'/></p>
<p><br />
</p>
<p>Does this constitute strong evidence for the inclusion of a cubic component in the model?
<select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p>
<div class="solution">
<button>
Explain why
</button>
<p>The Bayes Factor tells us that a model with a cubic component of <code>age</code> is only 0.16 times more likely than one that contains both linear and quadratic components. Because the Bayes Factor is less than 0.33, this constitutes strong evidence for the simpler model with only linear and quadratic components.</p>
</div>
<p><br />
On the basis of the model comparison with Bayes Factors, which model should be preferred? One with:</p>
<p><select class='solveme' data-answer='["linear and quadratic components of age"]'> <option></option> <option>a linear component of age only</option> <option>linear and quadratic components of age</option> <option>linear, quadratic, cubic components of age</option></select></p>
<p><br />
</p>
<p>A comparison of Bayes Factors agrees with the comparison of the models with <code>anova</code>. There’s strong evidence that the relationship between <code>age</code> and <code>happiness</code> contains both linear and quadratic components of <code>age</code>. There was no evidence for a cubic component.</p>
</div>
</div>
</div>
<div id="exercise-1" class="section level2">
<h2>Exercise</h2>
<div class="exercise">
<p><strong>Now you try incorporating polynomials to a regression, and do so by investigating the relationship between <code>age</code> and <code>anxiety</code> in <code>SurveyData</code>.</strong></p>
<p><br />
</p>
<p>The column <code>anxiety</code> in <code>SurveyData</code> contains responses to the question:</p>
<p><strong>“Overall, how anxious did you feel yesterday? Where 0 is ‘not at all anxious’ and 10 is ‘completely anxious’.”</strong></p>
<ul>
<li>Create a scatterplot of <code>age</code> vs. <code>anxiety</code>. Does there appear to be a linear or non-linear relationship?</li>
</ul>
<div class="solution">
<button>
Try to create the plot yourself first. Click to show the code
</button>
<p><img src="07-fitting-curves_files/figure-html/fig14-1.png" width="336" style="display: block; margin: auto;" /></p>
</div>
<p><br />
What kind of relationship between <code>age</code> and <code>anxiety</code> do you think is present?<br />
</p>
<div class="solution">
<button>
Try yourself first, then click to see answer
</button>
<p>A slight <strong>bow</strong> is evident in the plot such that <code>age</code> and <code>anxiety</code> seem to follow an inverted U-shaped relationship.<br />
Reported <code>anxiety</code> levels increase from 30 years to middle age (approx. 50 years) and then declines from 50 to 70 years. This mirrors the relationship with <code>age</code> and <code>happiness</code>. <code>anxiety</code> is greatest when <code>happiness</code> seems lowest.</p>
</div>
<p><br />
<br />
</p>
<p><strong>Answer the following questions:</strong></p>
<p><strong>Linear component</strong></p>
<ul>
<li>What percentage of the variance in <code>anxiety</code> is explained by a model with <code>age</code> as predictor?
<input class='solveme nospaces' size='4' data-answer='["1.19"]'/> %</li>
</ul>
<p><br />
</p>
<p><strong>Quadratic component</strong></p>
<ul>
<li><p>What percentage of the variance in <code>anxiety</code> is explained by a model containing both linear and quadratic components of <code>age</code> as predictors?
<input class='solveme nospaces' size='4' data-answer='["5.63"]'/> %</p></li>
<li><p>What is the <em>increase</em> in <span class="math inline">\(R^2\)</span> if a quadratic component of <code>age</code> is added to the model?
<input class='solveme nospaces' size='4' data-answer='["4.44"]'/> %</p></li>
<li><p>Does this increase represent a statistically significant increase?
<select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the <em>F</em>-statistic comparing the model with a linear component vs. one with linear and quadratic components?
<em>F</em>(1, 147) = <input class='solveme nospaces' size='4' data-answer='["6.92"]'/>, <em>p</em> = .009</p></li>
</ul>
<p><br />
</p>
<p><strong>Cubic component</strong></p>
<ul>
<li><p>What percentage of the variance in <code>anxiety</code> is explained by a model containing both linear, quadratic and cubic components of <code>age</code> as predictors?
<input class='solveme nospaces' size='4' data-answer='["7.02"]'/> %</p></li>
<li><p>What is the <em>increase</em> in <span class="math inline">\(R^2\)</span> if a cubic component of <code>age</code> is added to the model?
<input class='solveme nospaces' size='4' data-answer='["1.39"]'/> %</p></li>
<li><p>Does this increase represent a statistically significant increase? <select class='solveme' data-answer='["no"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the <em>F</em>-statistic and <em>p</em>-value for the test of the model with a linear + quadratic component vs. linear + quadratic + cubic components?
<em>F</em>(1, 146) = <input class='solveme nospaces' size='4' data-answer='["2.18"]'/>, <em>p</em> = <input class='solveme nospaces' size='4' data-answer='["0.14"]'/></p></li>
</ul>
<p><br />
</p>
<p><strong>Decision</strong>
- On the basis of the model comparison with ANOVA, which model should be preferred?
<select class='solveme' data-answer='["linear and quadratic components of age"]'> <option></option> <option>linear component of age only</option> <option>linear and quadratic components of age</option> <option>linear, quadratic, cubic components of age</option></select></p>
<p><br />
</p>
<div class="solution">
<button>
Show me the code to do all of this
</button>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># fit a linear model, show results</span></a>
<a class="sourceLine" id="cb47-2" title="2">anx1 &lt;-<span class="st"> </span><span class="kw">lm</span>(anxiety <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)</a>
<a class="sourceLine" id="cb47-3" title="3"><span class="kw">summary</span>(anx1)</a>
<a class="sourceLine" id="cb47-4" title="4"></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="co"># fit a quadratic component, show results</span></a>
<a class="sourceLine" id="cb47-6" title="6">anx2 &lt;-<span class="st"> </span><span class="kw">lm</span>(anxiety <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">2</span>), <span class="dt">data=</span>SurveyData)</a>
<a class="sourceLine" id="cb47-7" title="7"><span class="kw">summary</span>(anx2)</a>
<a class="sourceLine" id="cb47-8" title="8"></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co"># compare linear and linear+quadratic models</span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="kw">anova</span>(anx1, anx2)</a>
<a class="sourceLine" id="cb47-11" title="11"></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="co"># fit a cubic component</span></a>
<a class="sourceLine" id="cb47-13" title="13">anx3 &lt;-<span class="st"> </span><span class="kw">lm</span>(anxiety <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">3</span>), <span class="dt">data=</span>SurveyData)</a>
<a class="sourceLine" id="cb47-14" title="14"><span class="kw">summary</span>(anx3)</a>
<a class="sourceLine" id="cb47-15" title="15"></a>
<a class="sourceLine" id="cb47-16" title="16"><span class="co"># compare (linear + quadratic) and (linear + quadratic + cubic) models</span></a>
<a class="sourceLine" id="cb47-17" title="17"><span class="kw">anova</span>(anx2, anx3)</a></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Now use Bayes Factors:</strong></p>
<p>(Note: you do not need to re-add the quadratic and cubic components of age to <code>SurveyData</code>, as we did this before. These should still be in <code>SurveyData</code> as <code>age2</code> and <code>age3</code>.)</p>
<p><br />
</p>
<ul>
<li><p>The Bayes Factor comparing a model with linear and quadratic components vs. one with a linear component only is <input class='solveme nospaces' size='4' data-answer='["5.48"]'/></p></li>
<li><p>This indicates that there is more evidence for which model? <select class='solveme' data-answer='["linear plus quadratic components"]'> <option></option> <option>linear component only</option> <option>linear plus quadratic components</option></select></p></li>
</ul>
<p><br />
</p>
<ul>
<li><p>The Bayes Factor comparing a model with linear, quadratic and cubic components vs. one with linear and quadratic components only is <input class='solveme nospaces' size='4' data-answer='["0.76"]'/></p></li>
<li><p>This indicates that there is more evidence for which model? <select class='solveme' data-answer='["linear plus quadratic component"]'> <option></option> <option>linear plus quadratic component</option> <option>linear, quadratic, and cubic components</option></select></p></li>
</ul>
<p><br />
</p>
<p>Do the comparisons of models with Bayes Factors agree with the conclusions made with anova? <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<div class="solution">
<button>
Show me the code to determine the Bayes Factors
</button>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">library</span>(BayesFactor)</a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># BF for model anx1</span></a>
<a class="sourceLine" id="cb48-4" title="4">anx1BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(anxiety <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a>
<a class="sourceLine" id="cb48-5" title="5"></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co"># BF for model anx2</span></a>
<a class="sourceLine" id="cb48-7" title="7">anx2BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(anxiety <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a>
<a class="sourceLine" id="cb48-8" title="8"></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co"># BF for model anx3</span></a>
<a class="sourceLine" id="cb48-10" title="10">anx3BF &lt;-<span class="st"> </span><span class="kw">lmBF</span>(anxiety<span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2 <span class="op">+</span><span class="st"> </span>age3, <span class="dt">data =</span> <span class="kw">as.data.frame</span>(SurveyData) )</a>
<a class="sourceLine" id="cb48-11" title="11"></a>
<a class="sourceLine" id="cb48-12" title="12"><span class="co"># compare BFs for anx2 and anx1</span></a>
<a class="sourceLine" id="cb48-13" title="13">anx2BF <span class="op">/</span><span class="st"> </span>anx1BF</a>
<a class="sourceLine" id="cb48-14" title="14"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb48-15" title="15"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb48-16" title="16"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] age <span class="op">+</span><span class="st"> </span>age2 <span class="op">:</span><span class="st"> </span><span class="fl">5.476443</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb48-17" title="17"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-18" title="18"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb48-19" title="19"><span class="er">&gt;</span><span class="st">   </span>anxiety <span class="op">~</span><span class="st"> </span>age </a>
<a class="sourceLine" id="cb48-20" title="20"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb48-21" title="21"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a>
<a class="sourceLine" id="cb48-22" title="22"></a>
<a class="sourceLine" id="cb48-23" title="23"><span class="co"># compare BFs for anx3 and anx2</span></a>
<a class="sourceLine" id="cb48-24" title="24">anx3BF <span class="op">/</span><span class="st"> </span>anx2BF</a>
<a class="sourceLine" id="cb48-25" title="25"><span class="op">&gt;</span><span class="st"> </span>Bayes factor analysis</a>
<a class="sourceLine" id="cb48-26" title="26"><span class="op">&gt;</span><span class="st"> </span><span class="op">--------------</span></a>
<a class="sourceLine" id="cb48-27" title="27"><span class="er">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] age <span class="op">+</span><span class="st"> </span>age2 <span class="op">+</span><span class="st"> </span>age3 <span class="op">:</span><span class="st"> </span><span class="fl">0.7556007</span> ±<span class="dv">0</span>%</a>
<a class="sourceLine" id="cb48-28" title="28"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-29" title="29"><span class="er">&gt;</span><span class="st"> </span>Against denominator<span class="op">:</span></a>
<a class="sourceLine" id="cb48-30" title="30"><span class="er">&gt;</span><span class="st">   </span>anxiety <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>age2 </a>
<a class="sourceLine" id="cb48-31" title="31"><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></a>
<a class="sourceLine" id="cb48-32" title="32"><span class="er">&gt;</span><span class="st"> </span>Bayes factor type<span class="op">:</span><span class="st"> </span>BFlinearModel, JZS</a></code></pre></div>
</div>
</div>
</div>
<div id="summary-of-key-points-2" class="section level2">
<h2>Summary of key points</h2>
<ul>
<li>Polynomial terms (e.g., <span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>) can be added to regression models to fit curves in our data.</li>
</ul>
<p><br />
</p>
<ul>
<li><p><code>poly(predictor name, X)</code> can be used with <code>lm</code> to specify models with polynomial terms of the Xth order.</p>
<ul>
<li>The improvement in fit (<span class="math inline">\(R^2\)</span>) as a result of adding in a polynomial term can be tested using <code>anova(polynomial1, polynomial2)</code>.</li>
</ul></li>
</ul>
<p><br />
</p>
<ul>
<li><p>Bayes Factors can also be used to compare models with polynomial terms using <code>lmBF</code>.</p>
<ul>
<li>You must store the polynomial components in the dataset first before using <code>lmBF</code>. Use <code>poly(predictor name, X)[,"X"]</code>, where X is the order of the polynomial you will test (e.g., <code>poly(age, 3)[,"3"]</code>).</li>
</ul></li>
</ul>
<p><br />
</p>
<ul>
<li><p><strong>A note of caution</strong>: Although curves of any complexity can be fit, it may not always be meaningful or parsimonious to do so.</p>
<ul>
<li>Complex models may <em>overfit</em> the data and may not necessarily generalise to new datasets well.</li>
<li>It is also important not to extrapolate beyond the range of data used to generate the model when making predictions from the model, as the same relationship may not be present.</li>
</ul></li>
</ul>
<!--chapter:end:07-fitting-curves.rmd-->
</div>
</div>
<div id="assessment" class="section level1">
<h1>Assessment</h1>
<p>Chris Berry is the lead for the Data Analysis and Visualisation task, worth 50% of the module grade.</p>
<div id="data-analysis-and-visualisation-task" class="section level2">
<h2>Data Analysis and Visualisation Task</h2>
<p>This assignment is due to be submitted to the DLE by the deadline of <strong>12 noon on 21 January 2021</strong>.</p>
<p>In overview, you are required to analyse a set of data with RStudio using techniques from the first half of the course, and submit a short report of your findings, in the style similar to that which you may expect to see in the results section of an academic journal. Further details are below.</p>
<p><br />
</p>
<div id="submitting-your-coursework" class="section level3">
<h3>Submitting your coursework</h3>
<p>You should submit exactly 3 files:</p>
<ol style="list-style-type: decimal">
<li>An <strong>Rmd (R markdown) file</strong></li>
<li>An <strong>html</strong> document, produced by <em>knitting</em> your rmd file.</li>
<li>As a separate document, upload a copy of the standard <strong>coursework coversheet</strong> (and complete the feedback section).</li>
</ol>
<p>Within the Rmd file you should:</p>
<ul>
<li>Clearly set out the code that you have used for your analysis</li>
<li>Where necessary, include comments explaining what specific lines of code do.</li>
<li>Suppress code that you do not want to be visible in your report.</li>
</ul>
<p>Your Rmd file should “Just Work” when the marker opens and runs it, and produce the same output as
the knitted html file you submitted (i.e. there won’t be any errors or missing datafiles).</p>
<p>If you work on your own computer at home, you should check your Rmd file ‘knits’ correctly on the online Rstudio server.</p>
<p><br />
</p>
</div>
<div id="background-and-dataset" class="section level3">
<h3>Background and Dataset</h3>
<p>Stories of tremendous personal drive, integrity, and achievement are common in the sporting world. However, not all individuals are motivated to compete in ways that might be deemed fair, and it is not uncommon to hear stories of cheating and gamesmanship (the use of dubious methods to win a competition).</p>
<p>The dataset held at <a href="https://bit.ly/335N974" class="uri">https://bit.ly/335N974</a> contain responses to a survey, which was conducted to measure the values and attitudes of individuals who play sport. Demographic information was also collected from the respondents.</p>
<div class="tip">
<p>The variables in the dataset:</p>
<p><code>age</code>: age in years</p>
<p><code>gender</code>: female (0) or male (1)</p>
<p><code>sportype</code>: whether the main sport is an individual (0) or team (1) sport</p>
<p><code>perabil</code>: perceived ability. An individual’s self-perceived ability in their chosen sport. Higher scores indicate greater perceived ability.</p>
<p><code>cheating</code>: attitude to cheating. Higher scores indicate a greater willingness to cheat to achieve success.</p>
<p><code>gamesman</code>: attitude to gamesmanship. Higher scores indicate a greater willingness to use various ploys and tactics to gain a psychological advantage over competitors.</p>
<p><code>commit</code>: commitment to sport participation. Higher scores indicate a greater commitment in terms of practising, effort, attempts to improve and persevere after making mistakes.</p>
<p><code>conven</code>: respect for social conventions. Higher scores indicate a greater willingness to display sportsmanship (e.g., shaking hands with opponents, congratulating competitors).</p>
<p><code>task</code>: perception of success and ability in sport, where success is measured relative to how well the <em>task</em> can actually be performed, and also relative to how well the task can be performed by oneself. Higher scores indicate greater perception of task-oriented success.</p>
<p><code>ego</code>: perception of success and ability in sport, where success is measured in terms of how well one performs <em>relative to others</em>. Higher scores indicate greater perception of ego-oriented success.</p>
</div>
</div>
<div id="aims-of-the-assignment" class="section level3">
<h3>Aims of the Assignment</h3>
<p>Your principal objective is to visualise and analyse the dataset using techiques from the first half of the module (i.e., to session 8 on Fitting Curves). You should examine the variables in the dataset and identify interesting questions that you could ask; use these questions to guide the visualisations and analyses that you carry out.</p>
<p>At a minimum, you are expected to:</p>
<ul>
<li><p>Build a multiple regression model to predict one of the variables, and explain the model in your report.</p></li>
<li><p>Create at least <strong>one table</strong> and <strong>one figure</strong> linked to the analysis; they should be of a standard that you would expect to see in an academic journal.</p></li>
<li><p>Present statistics in APA style.</p></li>
<li><p>Not exceed 1500 words in the the text of your html.</p></li>
</ul>
</div>
<div id="tips" class="section level3">
<h3>Tips</h3>
<ul>
<li><p>Rather than just analysing the data all in one huge go, firstly work out what the questions are that seem interesting, and then apply the appropriate analyses and visualisation techniques to the relevant measures for answering them.</p></li>
<li><p>It is often the case that interesting hypotheses or ways of visualising the data emerge after a period of reflection, rather than during the first attempt. Be willing to explore the relationships in the data, and then put them aside for a while, before doing further analyses.</p></li>
<li><p>You are not required to use every technique from the first half of the course, or every variable in the dataset, in order to achieve a good mark.</p></li>
<li><p>Select data and methods that will allow you to focus on questions that seem to make psychological or social sense.</p></li>
<li><p>You can dig deeply into aspects of the data if they particularly interest you, but be prepared to justify what you have done. There is no one <em>correct answer</em> to this assignment, just as with real data there is not only one way of visualising or analysing it. Analyses are right or wrong in so far as they provide insight into the data and into the problems that are being researched. If you are not sure whether you are making the right choices in your analyses, then provide justification for them.</p></li>
<li><p>In the end, keep in mind that the purpose of this assessment is for you to demonstrate that you can use the techniques from this course competently to answer questions concerning a dataset and present the findings coherently in a report.</p></li>
</ul>
</div>
<div id="notes" class="section level3">
<h3>Notes</h3>
<p>The work submitted should be your own work. You may discuss the data with other students but cannot submit shared work. Please note university rules regarding plagiarism apply.</p>
<p>Reasonable amounts of assistance with technical aspects of RStudio may be obtained from the demonstrator for the course, Paul Sharpe, but this does not include recommending what you should choose to do, or helping with specific interpretations of output. As a general guide, if you are asking for something which would put you at an unfair advantage relative to any other student, then the request is probably unreasonable.</p>
<p>Submissions will be graded according to the School categorical mark scheme (i.e., A+ to N), as detailed in the handbook: <a href="https://pghandbook.psy.plymouth.ac.uk/assessment.html" class="uri">https://pghandbook.psy.plymouth.ac.uk/assessment.html</a></p>
<p><br />
</p>
<p><br />
</p>
<p><strong>Responses to frequently asked questions will be posted at this <a href="#FAQ-assessment">FAQ link</a></strong></p>
<!--chapter:end:assessment.rmd-->
</div>
</div>
</div>
<div id="FAQ-assessment" class="section level1">
<h1>FAQ Data Analysis and Visualisation Task</h1>
<p><br />
</p>
<hr />
<div id="how-do-i-add-a-caption-to-a-summary-output-table" class="section level3">
<h3>How do I add a caption to a summary output table?</h3>
<p><code>pander()</code> can be used to output a summary table with a caption. Use the <code>caption=“XXX”</code> argument. For example:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw">library</span>(pander)</a>
<a class="sourceLine" id="cb49-3" title="3"></a>
<a class="sourceLine" id="cb49-4" title="4">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_mpg =</span> <span class="kw">mean</span>(mpg)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-7" title="7"><span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Mean miles per gallon by cyl&quot;</span>)</a></code></pre></div>
<table style="width:24%;">
<caption>Mean miles per gallon by cyl</caption>
<colgroup>
<col width="8%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">cyl</th>
<th align="center">mean_mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">26.66</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">19.74</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">15.1</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<hr />
<!--

### How can I round numbers to X decimal places? 

The `round()` function can be used to round a number. For example, the command:


```r
round(3.14159, 2)
> [1] 3.14
```

rounds 3.14159 to 2 decimal places.

We can combine `round` with commands from the `dplyr` package to round **all** of the numbers in a data frame to two decimal places in one go. 

First look at the built-in dataset `DNase`:


```r
DNase %>% head()
> Grouped Data: density ~ conc | Run
>   Run       conc density
> 1   1 0.04882812   0.017
> 2   1 0.04882812   0.018
> 3   1 0.19531250   0.121
> 4   1 0.19531250   0.124
> 5   1 0.39062500   0.206
> 6   1 0.39062500   0.215
```

The columns `conc` and `density` contain numeric values that we may want to display to 2 decimal places.

We can achieve that using `mutate_if()` from the `dplyr` package, as follows:


```r
DNase %>% mutate_if(is.numeric, round, 2) 
```


**Explanation**: `mutate_if` will change the entry in the data frame **if** some condition is satisfied. In this case, if the entry is a number (i.e.,  `is.numeric`), it will apply `round` to it to `2` decimal places. (The column `Run` is not rounded because it is is an ordinal, rather than a numeric, variable.)

<div class='exercise'>
Try rounding the values in `DNase` to one decimal place.


<div class='solution'><button>Show me</button>


```r
DNase %>% mutate_if(is.numeric, round, 1) 
```

</div>


</div>



\

---

### Cheat sheets

Some handy cheat sheets for RStudio are located here: https://www.rstudio.com/resources/cheatsheets/

The following may be of particular use for topics from this module:

- [Data transformation with dplyr](https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf)
- [Data visualisation with ggplot](https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf)
- [R Markdown](https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf)


\

---

### What does it mean if RStudio prints out "e-" next to a number? {#e-meaning}

If R prints "1.4e-4", in the output this actually means "$1.4 \times 10^{-4}$", or "0.00014". It is a way of printing out very small (or very large) numbers.

"e-4" means "move the decimal point 4 places to the left". See this by executing the command below -- it should return "0.00014".



```r
1.4e-4
> [1] 0.00014
```

So:

- "e-5" means move the decimal point 5 places to the left (e.g., `2.5e-5` is "$2.5 \times 10^{-5}$", or 0.000025)
- "e-10" means move the decimal point 10 places to the left (e.g., `2.5e-10` is "$2.5 \times 10^{-10}$", or 0.00000000025).
- "e5" means move the decimal point 5 places to the **right** (e.g., `2.5e5` is "$2.5 \times 10^{5}$", 250000).


\


---

### How do I set up an R Markdown file?

R-markdown is a way of embedding R code, figures, and text in a single executable document. (As an example, all the worksheets for this module were written in r-markdown.)

If you want to create an R markdown file, go to File > New File > R Markdown.

Ben covered R Markdown in his sessions: https://benwhalley.github.io/datafluency/rmarkdown.html

There's a good cheat sheet here:
- [R Markdown](https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf)


\

---

### How do convert my R Markdown file to PDF?

Click the Knit button in the editor window, and select "Knit to PDF".

If there are no errors in your code, the PDF of your document will appear in the "Files" window.



\

---

### How can I save a file from RStudio to my own hard drive/computer so I can submit it to the DLE?

If using R Studio through the university website (recommended) [rstudio.plymouth.ac.uk](https://rstudio.plymouth.ac.uk), you can save a file in the Files pane as follows:

- Tick the check box next to the file you want to save.
- Click the "More" button > Export. 
- You can then choose where to save the file on your computer.


-->
<!--chapter:end:FAQ-assessment.rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
