<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 5 Multiple regression: evaluating and comparing models | PSYC753 Data Fluency: Analysis</title>
  <meta name="description" content="Course materials for PSYC753 2022" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 5 Multiple regression: evaluating and comparing models | PSYC753 Data Fluency: Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://chrisjberry.github.io/datafluencyCB/" />
  
  <meta property="og:description" content="Course materials for PSYC753 2022" />
  <meta name="github-repo" content="datafluencyCB" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 5 Multiple regression: evaluating and comparing models | PSYC753 Data Fluency: Analysis" />
  
  <meta name="twitter:description" content="Course materials for PSYC753 2022" />
  

<meta name="author" content="Chris Berry" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-regression-one-continuous-one-categorical.html"/>
<link rel="next" href="anova-repeated-measures.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PSYC753 Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>1</b> Simple Regression</a></li>
<li class="chapter" data-level="2" data-path="multiple1.html"><a href="multiple1.html"><i class="fa fa-check"></i><b>2</b> Multiple regression: multiple continuous predictors</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="multiple1.html"><a href="multiple1.html#in-brief"><i class="fa fa-check"></i><b>2.0.1</b> In brief</a></li>
<li class="chapter" data-level="2.1" data-path="multiple1.html"><a href="multiple1.html#multiple-regression-with-several-continuous-predictors"><i class="fa fa-check"></i><b>2.1</b> Multiple regression with several continuous predictors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="multiple1.html"><a href="multiple1.html#overview-1"><i class="fa fa-check"></i><b>2.1.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="multiple1.html"><a href="multiple1.html#analysing-the-model"><i class="fa fa-check"></i><b>2.2</b> Analysing the model</a></li>
<li class="chapter" data-level="2.3" data-path="multiple1.html"><a href="multiple1.html#conceptualising-the-variance-explained-by-predictors"><i class="fa fa-check"></i><b>2.3</b> Conceptualising the variance explained by predictors</a></li>
<li class="chapter" data-level="2.4" data-path="multiple1.html"><a href="multiple1.html#adding-predictor-variables-to-the-model"><i class="fa fa-check"></i><b>2.4</b> Adding predictor variables to the model</a></li>
<li class="chapter" data-level="2.5" data-path="multiple1.html"><a href="multiple1.html#multicollinearity"><i class="fa fa-check"></i><b>2.5</b> Multicollinearity</a></li>
<li class="chapter" data-level="2.6" data-path="multiple1.html"><a href="multiple1.html#final-exercise"><i class="fa fa-check"></i><b>2.6</b> Final exercise</a></li>
<li class="chapter" data-level="2.7" data-path="multiple1.html"><a href="multiple1.html#summary-of-key-points"><i class="fa fa-check"></i><b>2.7</b> Summary of key points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova-2x2-between-subjects.html"><a href="anova-2x2-between-subjects.html"><i class="fa fa-check"></i><b>3</b> ANOVA: 2x2 Between-subjects</a></li>
<li class="chapter" data-level="4" data-path="multiple-regression-one-continuous-one-categorical.html"><a href="multiple-regression-one-continuous-one-categorical.html"><i class="fa fa-check"></i><b>4</b> Multiple regression: one continuous, one categorical</a></li>
<li class="chapter" data-level="5" data-path="multiple3.html"><a href="multiple3.html"><i class="fa fa-check"></i><b>5</b> Multiple regression: evaluating and comparing models</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="multiple3.html"><a href="multiple3.html#in-brief-1"><i class="fa fa-check"></i><b>5.0.1</b> In brief</a></li>
<li class="chapter" data-level="5.1" data-path="multiple3.html"><a href="multiple3.html#using-anova-and-bayes-factors-to-compare-models"><i class="fa fa-check"></i><b>5.1</b> Using ANOVA and Bayes Factors to compare models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple3.html"><a href="multiple3.html#overview-2"><i class="fa fa-check"></i><b>5.1.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple3.html"><a href="multiple3.html#comparing-models-using-anova"><i class="fa fa-check"></i><b>5.2</b> Comparing models using ANOVA</a></li>
<li class="chapter" data-level="5.3" data-path="multiple3.html"><a href="multiple3.html#comparing-models-using-bayes-factors"><i class="fa fa-check"></i><b>5.3</b> Comparing models using Bayes Factors</a></li>
<li class="chapter" data-level="5.4" data-path="multiple3.html"><a href="multiple3.html#exercise"><i class="fa fa-check"></i><b>5.4</b> Exercise</a></li>
<li class="chapter" data-level="5.5" data-path="multiple3.html"><a href="multiple3.html#summary-of-key-points-1"><i class="fa fa-check"></i><b>5.5</b> Summary of key points</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova-repeated-measures.html"><a href="anova-repeated-measures.html"><i class="fa fa-check"></i><b>6</b> ANOVA: Repeated measures</a></li>
<li class="chapter" data-level="7" data-path="pre-post-data-effect-sizes-clinically-significant-change.html"><a href="pre-post-data-effect-sizes-clinically-significant-change.html"><i class="fa fa-check"></i><b>7</b> Pre-post data, effect sizes, clinically significant change</a></li>
<li class="chapter" data-level="8" data-path="regression-assessment-2022.html"><a href="regression-assessment-2022.html"><i class="fa fa-check"></i><b>8</b> Regression Assessment 2022</a></li>
<li class="chapter" data-level="9" data-path="regression-assessment-2022-faqs.html"><a href="regression-assessment-2022-faqs.html"><i class="fa fa-check"></i><b>9</b> Regression Assessment 2022: FAQs</a></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSYC753 Data Fluency: Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple3" class="section level1" number="5">
<h1><span class="header-section-number">Session 5</span> Multiple regression: evaluating and comparing models</h1>
<p><em>January 2022</em></p>
<div id="in-brief-1" class="section level3" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> In brief</h3>
<blockquote>
<p>In this session we discuss model selection in the context of ANOVA and the use
of Bayes Factors to choose between theoretically interesting models.</p>
</blockquote>
</div>
<div id="using-anova-and-bayes-factors-to-compare-models" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Using ANOVA and Bayes Factors to compare models</h2>
<ul>
<li><a href="slides/PSYC753_Chris2.pptx"><strong>Slides for the session</strong></a></li>
<li><a href="slides/PSYC753_Chris2_Rmd.pptx"><strong>Using Rmd files</strong></a></li>
</ul>
<p><br />
</p>
<div id="overview-2" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Overview</h3>
<p>In the previous session, we saw that we can construct a linear model to predict an outcome variable (e.g., <em>final exam score</em> from <em>entrance exam score</em>). We also investigated how we can <em>improve</em> a model by adding several continuous predictors to it.</p>
<p><br />
How do we know if one model is <em>better</em> or should be <em>preferred</em> over another model? We touched on a common sense approach in the last session - we ideally want models that explain the variance in an outcome variable but each predictor in the model should make a sizable and relatively independent contribution to the model.</p>
<p><br />
</p>
<p>Today we will cover a more formal approach to model comparison using:</p>
<ul>
<li><p><strong>ANOVA (Analysis of Variance)</strong> and</p></li>
<li><p><strong>Bayes Factors</strong></p></li>
</ul>
<p><br />
</p>
<p>It's important that you are comfortable with the material from the first <a href="building-models-1.html">Building Models 1 session</a> before proceeding today.</p>
</div>
</div>
<div id="comparing-models-using-anova" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Comparing models using ANOVA</h2>
<p>We can use ANOVA to determine whether the addition of variables into a model leads to a statistically significant improvement in the variance it explains <em>overall</em>. We may want to do this, for example, when building on existing theories or models, or looking at the effects of variables after controlling for others.</p>
<p><br />
We'll start by comparing a model with <em>one</em> predictor vs. a model with <em>three</em> predictors.</p>
<p><br />
Using the <code>ExamData</code> from the previous session, we'll run:</p>
<ul>
<li><p>a linear model with <code>finalex</code> as the outcome variable, and <code>entrex</code> as the predictor.</p></li>
<li><p>a linear model with <code>finalex</code> as the outcome variable, and <code>entrex</code>,<code>age</code>, and <code>project</code> as the predictors.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="multiple3.html#cb13-1" aria-hidden="true" tabindex="-1"></a>ExamData <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://bit.ly/37GkvJg&#39;</span>)              </span>
<span id="cb13-2"><a href="multiple3.html#cb13-2" aria-hidden="true" tabindex="-1"></a>model1   <span class="ot">&lt;-</span> <span class="fu">lm</span>(finalex <span class="sc">~</span> entrex, <span class="at">data =</span> ExamData)           </span>
<span id="cb13-3"><a href="multiple3.html#cb13-3" aria-hidden="true" tabindex="-1"></a>model2   <span class="ot">&lt;-</span> <span class="fu">lm</span>(finalex <span class="sc">~</span> entrex <span class="sc">+</span> age <span class="sc">+</span> project, <span class="at">data =</span> ExamData) </span></code></pre></div>
<p><br />
<strong>Explanation of the code</strong>: first the data is loaded into <code>ExamData</code>. The results of the simple regression are stored in <code>model1</code>. Those of the multiple regression are stored in <code>model2</code>.</p>
<p><br />
Use <code>summary()</code> to display the results of each regression:</p>
<p><strong>Model 1:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="multiple3.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span>
<span id="cb14-2"><a href="multiple3.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb14-3"><a href="multiple3.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb14-4"><a href="multiple3.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> finalex <span class="sc">~</span> entrex, <span class="at">data =</span> ExamData)</span>
<span id="cb14-5"><a href="multiple3.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb14-6"><a href="multiple3.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb14-7"><a href="multiple3.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb14-8"><a href="multiple3.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">54.494</span> <span class="sc">-</span><span class="fl">21.185</span>   <span class="fl">3.733</span>  <span class="fl">18.124</span>  <span class="fl">30.969</span> </span>
<span id="cb14-9"><a href="multiple3.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb14-10"><a href="multiple3.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb14-11"><a href="multiple3.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>             Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb14-12"><a href="multiple3.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept) <span class="sc">-</span><span class="fl">46.3045</span>    <span class="fl">25.4773</span>  <span class="sc">-</span><span class="fl">1.817</span>   <span class="fl">0.0788</span> .  </span>
<span id="cb14-13"><a href="multiple3.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> entrex        <span class="fl">3.1545</span>     <span class="fl">0.5324</span>   <span class="fl">5.925</span> <span class="fl">1.52e-06</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb14-14"><a href="multiple3.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span></span>
<span id="cb14-15"><a href="multiple3.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb14-16"><a href="multiple3.html#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb14-17"><a href="multiple3.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">22.7</span> on <span class="dv">31</span> degrees of freedom</span>
<span id="cb14-18"><a href="multiple3.html#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.531</span>,   Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.5159</span> </span>
<span id="cb14-19"><a href="multiple3.html#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span>  <span class="fl">35.1</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">1.52e-06</span></span></code></pre></div>
<p><br />
<strong>Model 2:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="multiple3.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span>
<span id="cb15-2"><a href="multiple3.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb15-3"><a href="multiple3.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb15-4"><a href="multiple3.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> finalex <span class="sc">~</span> entrex <span class="sc">+</span> age <span class="sc">+</span> project, <span class="at">data =</span> ExamData)</span>
<span id="cb15-5"><a href="multiple3.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb15-6"><a href="multiple3.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb15-7"><a href="multiple3.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb15-8"><a href="multiple3.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">42.563</span> <span class="sc">-</span><span class="fl">16.519</span>   <span class="fl">4.901</span>  <span class="fl">16.991</span>  <span class="fl">36.424</span> </span>
<span id="cb15-9"><a href="multiple3.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb15-10"><a href="multiple3.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb15-11"><a href="multiple3.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>              Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb15-12"><a href="multiple3.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept) <span class="sc">-</span><span class="fl">117.9159</span>    <span class="fl">46.4211</span>  <span class="sc">-</span><span class="fl">2.540</span>   <span class="fl">0.0167</span> <span class="sc">*</span>  </span>
<span id="cb15-13"><a href="multiple3.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> entrex         <span class="fl">3.0889</span>     <span class="fl">0.5734</span>   <span class="fl">5.387</span> <span class="fl">8.66e-06</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb15-14"><a href="multiple3.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> age            <span class="fl">1.4231</span>     <span class="fl">1.3756</span>   <span class="fl">1.035</span>   <span class="fl">0.3094</span>    </span>
<span id="cb15-15"><a href="multiple3.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> project        <span class="fl">0.6280</span>     <span class="fl">0.4609</span>   <span class="fl">1.363</span>   <span class="fl">0.1835</span>    </span>
<span id="cb15-16"><a href="multiple3.html#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb15-17"><a href="multiple3.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb15-18"><a href="multiple3.html#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb15-19"><a href="multiple3.html#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">22.03</span> on <span class="dv">29</span> degrees of freedom</span>
<span id="cb15-20"><a href="multiple3.html#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.5869</span>,  Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.5442</span> </span>
<span id="cb15-21"><a href="multiple3.html#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">13.73</span> on <span class="dv">3</span> and <span class="dv">29</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">9.353e-06</span></span></code></pre></div>
<p><br />
(If you are not sure what it means by "e-06" in the output above then see the FAQs <a href="#e-meaning">here</a>)</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-7" class="exercise"><strong>Exercise 5.1  </strong></span>Make note of the variance explained by each model (<span class="math inline">\(R^2\)</span>), i.e., <code>Multiple R-squared</code>: (report as a percentage, to 2 decimal places)</p>
<ul>
<li><p>Model 1: <span class="math inline">\(R^2\)</span> = <input class='webex-solveme nospaces' size='5' data-answer='["53.10"]'/> %</p></li>
<li><p>Model 2: <span class="math inline">\(R^2\)</span> = <input class='webex-solveme nospaces' size='5' data-answer='["58.69"]'/> %</p></li>
</ul>
<p>Which model explains a greater proportion of variance in <code>finalex</code>? <select class='webex-select'><option value='blank'></option><option value=''>entrex alone</option><option value='answer'>entrex, age, project</option></select></p>
<ul>
<li>Calculate the difference in <span class="math inline">\(R^2\)</span> between the models. <code>model2</code> improves the prediction of <code>finalex</code> by <input class='webex-solveme nospaces' size='4' data-answer='["5.59"]'/> %</li>
</ul>
</div>
<p><br />
To compare the variance explained by each model, use <code>anova()</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="multiple3.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Res.Df</th>
<th align="right">RSS</th>
<th align="right">Df</th>
<th align="right">Sum of Sq</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="right">15980.58</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">29</td>
<td align="right">14077.62</td>
<td align="right">2</td>
<td align="right">1902.957</td>
<td align="right">1.960052</td>
<td align="right">0.1590683</td>
</tr>
</tbody>
</table>
</div>
<p><br />
<strong>Explanation of the output:</strong></p>
<ul>
<li><p><strong><code>anova()</code></strong> compares the variance that <code>model1</code> and <code>model2</code> explain with an <em>F</em>-statistic.</p></li>
<li><p><strong><code>Pr(&gt;F)</code></strong> gives the <em>p</em>-value for this statistic. If the <em>p</em>-value is less than .05, then we can reject the null hypothesis that there is no difference in the variance explained by each model, and we can say that the variance that <code>model2</code> explains in <code>finalex</code> is significantly greater than that of <code>model1</code>.</p></li>
<li><p>We can report the <em>F</em>-statistic in APA style as <em>F</em>(2, 29) = 1.96, <em>p</em> = .16. We can say that the additional 5.59% variance that <code>model2</code> explains relative to <code>model1</code> does not represent a statistically significant increase in <span class="math inline">\(R^2\)</span>, and so <code>model2</code> should <strong>not</strong> be preferred over <code>model1</code>.</p></li>
</ul>
<p><br />
</p>
<div class="tip">
<p>Comparing models in steps as we've done is sometimes called <strong>hierarchical regression</strong> or <strong>sequential regression</strong>. This type of regression is usually used for logical or theoretical reasons, when we want to know the contribution of a predictor (or a set of predictors) <strong>over and above</strong> an existing one.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-8" class="exercise"><strong>Exercise 5.2  </strong></span><strong>Now, you try using <code>anova</code> to compare models.</strong></p>
<p>The variable <code>attendance</code> in <code>ExamData</code> scores individuals according to whether their class attendance was low (0) or high (1). A researcher suspects that <code>attendance</code> may explain additional variance in <code>finalex</code> over and above <code>entrex</code>.</p>
<p>As an exercise, compare the following two models using the <code>anova()</code> approach above:</p>
<ol style="list-style-type: decimal">
<li><p>a model with <code>entrex</code> as a sole predictor of <code>finalex</code> (i.e., <code>model1</code>), and</p></li>
<li><p>a model where <code>finalex</code> is predicted by <code>entrex</code> and <code>attendance</code> (call this <code>model3</code>).</p></li>
</ol>
<p>Is there sufficient evidence that a model with <code>entrex</code> <em>and</em> <code>attendance</code> explains more variance than a model with <code>entrex</code> alone?</p>
<div class="webex-solution">
<button>
Try yourself first, then click to see the code
</button>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="multiple3.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model1 was created earlier</span></span>
<span id="cb17-2"><a href="multiple3.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span>
<span id="cb17-3"><a href="multiple3.html#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="multiple3.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specify model3</span></span>
<span id="cb17-5"><a href="multiple3.html#cb17-5" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(finalex <span class="sc">~</span> entrex <span class="sc">+</span> attendance, <span class="at">data =</span> ExamData)</span>
<span id="cb17-6"><a href="multiple3.html#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="multiple3.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show model3</span></span>
<span id="cb17-8"><a href="multiple3.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span>
<span id="cb17-9"><a href="multiple3.html#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="multiple3.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#compare model1 and model3</span></span>
<span id="cb17-11"><a href="multiple3.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model3)</span>
<span id="cb17-12"><a href="multiple3.html#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-13"><a href="multiple3.html#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb17-14"><a href="multiple3.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> finalex <span class="sc">~</span> entrex, <span class="at">data =</span> ExamData)</span>
<span id="cb17-15"><a href="multiple3.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-16"><a href="multiple3.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb17-17"><a href="multiple3.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb17-18"><a href="multiple3.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">54.494</span> <span class="sc">-</span><span class="fl">21.185</span>   <span class="fl">3.733</span>  <span class="fl">18.124</span>  <span class="fl">30.969</span> </span>
<span id="cb17-19"><a href="multiple3.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-20"><a href="multiple3.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb17-21"><a href="multiple3.html#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>             Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb17-22"><a href="multiple3.html#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept) <span class="sc">-</span><span class="fl">46.3045</span>    <span class="fl">25.4773</span>  <span class="sc">-</span><span class="fl">1.817</span>   <span class="fl">0.0788</span> .  </span>
<span id="cb17-23"><a href="multiple3.html#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> entrex        <span class="fl">3.1545</span>     <span class="fl">0.5324</span>   <span class="fl">5.925</span> <span class="fl">1.52e-06</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb17-24"><a href="multiple3.html#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span></span>
<span id="cb17-25"><a href="multiple3.html#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb17-26"><a href="multiple3.html#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-27"><a href="multiple3.html#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">22.7</span> on <span class="dv">31</span> degrees of freedom</span>
<span id="cb17-28"><a href="multiple3.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.531</span>,   Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.5159</span> </span>
<span id="cb17-29"><a href="multiple3.html#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span>  <span class="fl">35.1</span> on <span class="dv">1</span> and <span class="dv">31</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">1.52e-06</span></span>
<span id="cb17-30"><a href="multiple3.html#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-31"><a href="multiple3.html#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> </span>
<span id="cb17-32"><a href="multiple3.html#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb17-33"><a href="multiple3.html#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> finalex <span class="sc">~</span> entrex <span class="sc">+</span> attendance, <span class="at">data =</span> ExamData)</span>
<span id="cb17-34"><a href="multiple3.html#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-35"><a href="multiple3.html#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb17-36"><a href="multiple3.html#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb17-37"><a href="multiple3.html#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">42.750</span> <span class="sc">-</span><span class="fl">11.750</span>   <span class="fl">1.801</span>   <span class="fl">9.689</span>  <span class="fl">30.347</span> </span>
<span id="cb17-38"><a href="multiple3.html#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-39"><a href="multiple3.html#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb17-40"><a href="multiple3.html#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>             Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb17-41"><a href="multiple3.html#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept) <span class="sc">-</span><span class="fl">63.3108</span>    <span class="fl">20.2768</span>  <span class="sc">-</span><span class="fl">3.122</span>  <span class="fl">0.00395</span> <span class="sc">**</span> </span>
<span id="cb17-42"><a href="multiple3.html#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> entrex        <span class="fl">3.2741</span>     <span class="fl">0.4173</span>   <span class="fl">7.846</span> <span class="fl">9.35e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb17-43"><a href="multiple3.html#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> attendance   <span class="fl">28.8202</span>     <span class="fl">6.3398</span>   <span class="fl">4.546</span> <span class="fl">8.37e-05</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb17-44"><a href="multiple3.html#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span></span>
<span id="cb17-45"><a href="multiple3.html#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb17-46"><a href="multiple3.html#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb17-47"><a href="multiple3.html#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">17.76</span> on <span class="dv">30</span> degrees of freedom</span>
<span id="cb17-48"><a href="multiple3.html#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.7223</span>,  Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.7038</span> </span>
<span id="cb17-49"><a href="multiple3.html#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">39.02</span> on <span class="dv">2</span> and <span class="dv">30</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">4.499e-09</span></span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Res.Df</th>
<th align="right">RSS</th>
<th align="right">Df</th>
<th align="right">Sum of Sq</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="right">15980.580</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">9462.434</td>
<td align="right">1</td>
<td align="right">6518.146</td>
<td align="right">20.66533</td>
<td align="right">8.37e-05</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><p>The variance explained by a model with <code>entrex</code> alone is <span class="math inline">\(R^2\)</span> = <input class='webex-solveme nospaces' size='5' data-answer='["53.10"]'/> %</p></li>
<li><p>The <span class="math inline">\(R^2\)</span> for the model that also included <code>attendance</code> was <span class="math inline">\(R^2\)</span> = <input class='webex-solveme nospaces' size='5' data-answer='["72.23"]'/> %</p></li>
<li><p>The increase in <span class="math inline">\(R^2\)</span> was <input class='webex-solveme nospaces' size='5' data-answer='["19.13"]'/>%</p></li>
<li><p>The ANOVA comparing models can be reported as: <em>F</em>(<input class='webex-solveme nospaces' size='1' data-answer='["1"]'/>, <input class='webex-solveme nospaces' size='2' data-answer='["30"]'/>) = <input class='webex-solveme nospaces' size='5' data-answer='["20.67"]'/>, <em>p</em> &lt; .001.</p></li>
<li><p>The increase in <span class="math inline">\(R^2\)</span> was <select class='webex-select'><option value='blank'></option><option value='answer'>statistically significant</option><option value=''>not significant</option></select>.</p></li>
<li><p>As indicated by the estimates of the coefficients for <code>entrex</code> and <code>attendance</code>, both <select class='webex-select'><option value='blank'></option><option value=''>negatively</option><option value='answer'>positively</option></select> predict <code>finalex</code>.</p></li>
<li><p>A higher <code>entrex</code> score and greater <code>attendance</code> is associated with a <select class='webex-select'><option value='blank'></option><option value='answer'>higher</option><option value=''>lower</option></select> <code>finalex</code> score.</p></li>
</ul>
</div>
</div>
</div>
<div id="comparing-models-using-bayes-factors" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Comparing models using Bayes Factors</h2>
<p>An alternative approach to using ANOVA to compare models is to use <strong>Bayes Factors</strong>.</p>
<p><br />
A <strong>Bayes Factor</strong> is the <strong>probability of obtaining the data under one model compared to another</strong> (Rouder &amp; Morey, 2012).</p>
<p><br />
For example, a Bayes Factor equal to 2 would tell us that the data are <em>twice</em> as likely under one model than another. A Bayes Factor equal to 0.5 would tell us that the data are <em>half</em> as likely under one model than another.</p>
<p><br />
Unlike classical tests of statistical significance (with <em>p</em>-values), Bayes Factors also allow us to <em>quantify</em> evidence for the null hypothesis. Very handy!</p>
<p><br />
To compute a Bayes Factor for a specific linear model, we use <code>lmBF</code> in the <code>BayesFactor</code> package (where <code>lm</code> stands for <em>linear model</em> and <code>BF</code> stands for <em>Bayes Factor</em>).</p>
<p><br />
First, we need to load the <code>BayesFactor</code> package:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="multiple3.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;BayesFactor&#39;</span>)</span></code></pre></div>
<p>We can use the <code>lmBF</code> function in the same way we use <code>lm</code>. The function will return a <strong>Bayes Factor</strong> for the model we specify.</p>
<p><br />
Let's determine the Bayes Factor for <code>model1</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="multiple3.html#cb19-1" aria-hidden="true" tabindex="-1"></a>model1.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(finalex <span class="sc">~</span> entrex, <span class="at">data =</span> <span class="fu">as.data.frame</span>(ExamData) )  </span></code></pre></div>
<p><strong>Explanation of the code</strong>: The model is specified in exactly the same way as with <code>lm</code>. Due to a limitation of the package, however, we must convert <code>ExamData</code> from a tibble to a data frame using <code>as.data.frame</code>. Otherwise, the command works in the same way. The results are stored in <code>model1.BF</code>.</p>
<p><br />
To look at what's stored in <code>model1.BF</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="multiple3.html#cb20-1" aria-hidden="true" tabindex="-1"></a>model1.BF</span>
<span id="cb20-2"><a href="multiple3.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb20-3"><a href="multiple3.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb20-4"><a href="multiple3.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">:</span> <span class="fl">8310.846</span> Â±<span class="fl">0.01</span>%</span>
<span id="cb20-5"><a href="multiple3.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb20-6"><a href="multiple3.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb20-7"><a href="multiple3.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Intercept only </span>
<span id="cb20-8"><a href="multiple3.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb20-9"><a href="multiple3.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
<p><strong>Explanation of the output</strong>:</p>
<ul>
<li><p>The Bayes Factor provided for the model with <code>entrex</code> is equal to <strong>8310.85</strong>.</p></li>
<li><p>The <code>Against denominator: Intercept only</code> means that the model with <code>entrex</code> is being compared with a model that contains an <strong>intercept only</strong>. In an intercept-only model, the coefficient for <code>entrex</code> is equal to zero; that is, the regression line is a flat line (equal to the <em>mean</em> of <code>entrex</code>).</p></li>
<li><p>The value of our Bayes Factor indicates that the model with <code>entrex</code> in is much more likely than a model that contains only an intercept (8310.85 times more likely, to be precise). We can therefore be confident that a model with <code>entrex</code> is preferable to the intercept only model (just as with our classical analysis). Happy days!</p></li>
</ul>
<p><br />
Now let's do the same for <code>model2</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="multiple3.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model</span></span>
<span id="cb21-2"><a href="multiple3.html#cb21-2" aria-hidden="true" tabindex="-1"></a>model2.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(finalex <span class="sc">~</span> entrex <span class="sc">+</span> age <span class="sc">+</span> project, <span class="at">data =</span> <span class="fu">as.data.frame</span>(ExamData) )</span>
<span id="cb21-3"><a href="multiple3.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="multiple3.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the Bayes Factor</span></span>
<span id="cb21-5"><a href="multiple3.html#cb21-5" aria-hidden="true" tabindex="-1"></a>model2.BF</span>
<span id="cb21-6"><a href="multiple3.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb21-7"><a href="multiple3.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb21-8"><a href="multiple3.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">+</span> age <span class="sc">+</span> project <span class="sc">:</span> <span class="fl">2427.676</span> Â±<span class="dv">0</span>%</span>
<span id="cb21-9"><a href="multiple3.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb21-10"><a href="multiple3.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb21-11"><a href="multiple3.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Intercept only </span>
<span id="cb21-12"><a href="multiple3.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb21-13"><a href="multiple3.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
<p><br />
</p>
<p><strong>Explanation:</strong> The Bayes Factor is equal to <strong>2427.68</strong>. Again, this indicates that the model with <code>entrex</code> and <code>age</code> is much more likely than a model with only the intercept in (this is not that surprising given the result for <code>model1.BF</code> above).</p>
<p>But, what we want to know is whether <code>model2</code> (containing <code>entrex</code> and <code>age</code>) is <strong>more</strong> likely than <code>model1</code> (containing only <code>entrex</code>). We can determine this by <em>dividing</em> the Bayes Factor for <code>model2</code> by the Bayes Factor for <code>model1</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="multiple3.html#cb22-1" aria-hidden="true" tabindex="-1"></a>model2.BF <span class="sc">/</span> model1.BF</span>
<span id="cb22-2"><a href="multiple3.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb22-3"><a href="multiple3.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb22-4"><a href="multiple3.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">+</span> age <span class="sc">+</span> project <span class="sc">:</span> <span class="fl">0.2921093</span> Â±<span class="fl">0.01</span>%</span>
<span id="cb22-5"><a href="multiple3.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb22-6"><a href="multiple3.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb22-7"><a href="multiple3.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   finalex <span class="sc">~</span> entrex </span>
<span id="cb22-8"><a href="multiple3.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb22-9"><a href="multiple3.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
<p><strong>Explanation:</strong> The Bayes Factor for this comparison is 0.29. This means that <code>model2</code> is <strong><em>less than a third as likely</em></strong> than <code>model1</code>. So, <code>model2</code> is much <em>less</em> likely than <code>model1</code>. Not good news for <code>model2</code>!</p>
<div class="tip">
<p><strong>Interpreting the Bayes Factor</strong></p>
<ul>
<li><p>A Bayes Factor <strong>equal to 1</strong> tells us that probability of each model is the same.</p></li>
<li><p>A Bayes Factor <strong>greater than 1</strong> means that <code>model2</code> is more likely than <code>model1</code>.</p></li>
<li><p>A Bayes Factor <strong>less than 1</strong> means that <code>model1</code> is more likely than <code>model2</code>.</p></li>
</ul>
<p><strong>Thus, our Bayes Factor of 0.29 indicates that <code>model1</code> is more likely than <code>model2</code>.</strong></p>
</div>
<div class="tip">
<p><strong>Reporting Bayes Factors</strong></p>
<p><br />
</p>
<p><strong>Notation</strong></p>
<p>We usually write the Bayes Factor in reports as <span class="math inline">\(BF_{10}\)</span> where:</p>
<ul>
<li><p>the subscript <strong>1</strong> in <span class="math inline">\(BF_{10}\)</span> denotes the less-constrained model (the alternative hypothesis). This is the model with <strong>more predictors</strong> (our <code>model2</code>).</p></li>
<li><p>the subscript <strong>0</strong> in <span class="math inline">\(BF_{10}\)</span> denotes the more constrained or simpler model (i.e., the null hypothesis). This is the model with <strong>fewer predictors</strong> (our <code>model1</code>).</p></li>
</ul>
<p>(You can just write BF10 if you prefer.)</p>
<p><br />
</p>
<p><strong>The Size of the Bayes Factor</strong></p>
<ul>
<li><p>If the Bayes Factor is <strong>greater than 3</strong> (i.e., <span class="math inline">\(BF_{10}\)</span> &gt; 3), we say that there is <strong>substantial evidence for <code>model2</code></strong> (the less constrained model).</p></li>
<li><p>If the Bayes Factor is <strong>less than 0.33</strong> (i.e., <span class="math inline">\(BF_{10}\)</span> &lt; 0.33), we usually say that there is <strong>substantial evidence for <code>model1</code></strong> (the more constrained model).</p></li>
<li><p>We say that intermediate values for the Bayes Factor (between 0.33 and 3) don't offer strong evidence for either model.</p></li>
</ul>
</div>
<p>Thus, because our Bayes Factor of 0.29 is less than 1, this indicates greater evidence for <code>model1</code> than <code>model2</code>. Furthermore, because the Bayes Factor is less than 0.33, we have <em>substantial</em> evidence for <code>model1</code> over <code>model2</code>.</p>
<p><br />
It's becoming increasingly common to report the Bayes Factor alongside the results of a classical analysis. Thus, we could report our results as follows: "There was insufficient evidence that the addition of age and project to the model containing entrance exam resulted in an increase in <span class="math inline">\(R^2\)</span>, <em>F</em>(2, 29) = 1.96, <em>p</em> = .16; BF10 = 0.29."</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-9" class="exercise"><strong>Exercise 5.3  </strong></span><strong>Now you try using Bayes Factors to compare models</strong></p>
<p>To supplement the comparison of <code>model3</code> and <code>model1</code> that you did with <code>anova</code>, now compute the Bayes Factor for <code>model3</code> vs. <code>model1</code>.</p>
<p><br />
You'll need the following steps:</p>
<ul>
<li><p>Model 1: Obtain the Bayes Factor for a model with <code>entrex</code> as a sole predictor of <code>finalex</code> (we did this already above; it's stored in <code>model1.BF</code>)</p></li>
<li><p>Model 2: Obtain the Bayes Factor for a model where <code>finalex</code> is predicted by <code>entrex</code> <em>and</em> <code>attendance</code> and store this in <code>model3.BF</code>.</p></li>
<li><p>Compare the Bayes Factors in <code>model3.BF</code> and <code>model1.BF</code>.<br />
</p></li>
</ul>
<div class="webex-solution">
<button>
Try yourself first, then click here for the code
</button>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="multiple3.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. show the BF for model1 vs. intercept only</span></span>
<span id="cb23-2"><a href="multiple3.html#cb23-2" aria-hidden="true" tabindex="-1"></a>model1.BF  </span>
<span id="cb23-3"><a href="multiple3.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="multiple3.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Obtain the BF for model3 vs. intercept only, then show it</span></span>
<span id="cb23-5"><a href="multiple3.html#cb23-5" aria-hidden="true" tabindex="-1"></a>model3.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(finalex <span class="sc">~</span> entrex <span class="sc">+</span> attendance, <span class="at">data =</span> <span class="fu">as.data.frame</span>(ExamData) )</span>
<span id="cb23-6"><a href="multiple3.html#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="multiple3.html#cb23-7" aria-hidden="true" tabindex="-1"></a>model3.BF</span>
<span id="cb23-8"><a href="multiple3.html#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="multiple3.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compare the BFs for model3 vs model1</span></span>
<span id="cb23-10"><a href="multiple3.html#cb23-10" aria-hidden="true" tabindex="-1"></a>model3.BF <span class="sc">/</span> model1.BF</span>
<span id="cb23-11"><a href="multiple3.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb23-12"><a href="multiple3.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb23-13"><a href="multiple3.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">:</span> <span class="fl">8310.846</span> Â±<span class="fl">0.01</span>%</span>
<span id="cb23-14"><a href="multiple3.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb23-15"><a href="multiple3.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb23-16"><a href="multiple3.html#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Intercept only </span>
<span id="cb23-17"><a href="multiple3.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb23-18"><a href="multiple3.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span>
<span id="cb23-19"><a href="multiple3.html#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb23-20"><a href="multiple3.html#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor analysis</span>
<span id="cb23-21"><a href="multiple3.html#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb23-22"><a href="multiple3.html#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">+</span> attendance <span class="sc">:</span> <span class="dv">2351114</span> Â±<span class="dv">0</span>%</span>
<span id="cb23-23"><a href="multiple3.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb23-24"><a href="multiple3.html#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb23-25"><a href="multiple3.html#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Intercept only </span>
<span id="cb23-26"><a href="multiple3.html#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb23-27"><a href="multiple3.html#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span>
<span id="cb23-28"><a href="multiple3.html#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb23-29"><a href="multiple3.html#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor analysis</span>
<span id="cb23-30"><a href="multiple3.html#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb23-31"><a href="multiple3.html#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] entrex <span class="sc">+</span> attendance <span class="sc">:</span> <span class="fl">282.897</span> Â±<span class="fl">0.01</span>%</span>
<span id="cb23-32"><a href="multiple3.html#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb23-33"><a href="multiple3.html#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb23-34"><a href="multiple3.html#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   finalex <span class="sc">~</span> entrex </span>
<span id="cb23-35"><a href="multiple3.html#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb23-36"><a href="multiple3.html#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
</div>
<p><br />
<strong>Answer the following questions from the output:</strong></p>
<p>How much more likely is a model with<code>entrex</code> than an intercept only model?</p>
<ul>
<li><input class='webex-solveme nospaces' size='7' data-answer='["8310.85"]'/> times more likely.</li>
</ul>
<p>How much more likely is a model with <code>entrex</code> and <code>attendance</code> than an intercept only model?</p>
<ul>
<li><input class='webex-solveme nospaces' size='7' data-answer='["2351114"]'/> times more likely.</li>
</ul>
<p>How much more likely is a model with <code>entrex</code> and <code>attendance</code> as predictors than a model with <code>entrex</code> alone?</p>
<ul>
<li><input class='webex-solveme nospaces' size='6' data-answer='["282.90"]'/> times more likely.</li>
</ul>
<p>There is <select class='webex-select'><option value='blank'></option><option value=''>insufficient</option><option value='answer'>strong</option></select> evidence that a model with <code>entrex</code> and <code>attendance</code> should be preferred over a model with <code>entrex</code> alone, given the data.</p>
<p>A comparison of the Bayes Factors for the two models therefore <select class='webex-select'><option value='blank'></option><option value=''>does not converge</option><option value='answer'>converges</option></select> with the results of the comparison using ANOVA, and the model in which Final Exam is predicted by <select class='webex-select'><option value='blank'></option><option value=''>Entrance Exam only</option><option value='answer'>Entrance Exam and Attendance</option></select> should be preferred.</p>
</div>
</div>
<div id="exercise" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercise</h2>
<p>Now you will practise using ANOVA and Bayes Factors to compare models with a new dataset.</p>
<p><br />
<strong>Scenario:</strong> A researcher would like to construct a model to predict scores in a memory task from several different variables. The data from 234 individuals are stored in the <code>memory_data</code> dataset, which are located at <a href="https://bit.ly/37pOTrC" class="uri">https://bit.ly/37pOTrC</a>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-10" class="exercise"><strong>Exercise 5.4  </strong></span>Use <code>read_csv</code> to load in the data at the link above to the variable <code>memory_data</code> and preview it with <code>head()</code>.</p>
<div class="webex-solution">
<button>
Try this yourself first. Click to show code
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="multiple3.html#cb24-1" aria-hidden="true" tabindex="-1"></a>memory_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://bit.ly/37pOTrC&#39;</span>)</span>
<span id="cb24-2"><a href="multiple3.html#cb24-2" aria-hidden="true" tabindex="-1"></a>memory_data <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">attention</th>
<th align="right">sex</th>
<th align="right">blueberries</th>
<th align="right">iq</th>
<th align="right">age</th>
<th align="right">sleep</th>
<th align="right">memory_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">95.790</td>
<td align="right">1</td>
<td align="right">308</td>
<td align="right">99.932</td>
<td align="right">44.935</td>
<td align="right">9.945</td>
<td align="right">128.42</td>
</tr>
<tr class="even">
<td align="right">66.748</td>
<td align="right">1</td>
<td align="right">270</td>
<td align="right">136.502</td>
<td align="right">29.450</td>
<td align="right">8.037</td>
<td align="right">127.43</td>
</tr>
<tr class="odd">
<td align="right">102.399</td>
<td align="right">1</td>
<td align="right">442</td>
<td align="right">109.591</td>
<td align="right">31.862</td>
<td align="right">11.011</td>
<td align="right">117.99</td>
</tr>
<tr class="even">
<td align="right">36.863</td>
<td align="right">1</td>
<td align="right">219</td>
<td align="right">110.494</td>
<td align="right">27.894</td>
<td align="right">5.284</td>
<td align="right">95.51</td>
</tr>
<tr class="odd">
<td align="right">91.708</td>
<td align="right">0</td>
<td align="right">450</td>
<td align="right">118.925</td>
<td align="right">36.746</td>
<td align="right">9.303</td>
<td align="right">122.11</td>
</tr>
<tr class="even">
<td align="right">146.196</td>
<td align="right">1</td>
<td align="right">255</td>
<td align="right">85.601</td>
<td align="right">23.902</td>
<td align="right">7.047</td>
<td align="right">102.22</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tip">
<p><strong>About the data:</strong></p>
<ul>
<li><p><strong>attention</strong>: sustained attention score (higher = better attention)</p></li>
<li><p><strong>sex</strong>: 0 = female, 1 = male</p></li>
<li><p><strong>blueberries</strong>: average number of blueberries consumed per year</p></li>
<li><p><strong>iq</strong>: the individual's IQ</p></li>
<li><p><strong>age</strong>: age of person in years</p></li>
<li><p><strong>sleep</strong>: average hours of sleep per night</p></li>
<li><p><strong>memory_score</strong>: memory test score</p></li>
</ul>
</div>
<p>The researcher wants to test whether <code>attention</code> and <code>sleep</code> predict <code>memory_score</code>, but after controlling for <code>iq</code> and <code>age</code> (she suspects memory varies with <code>iq</code> and <code>age</code> to being with).</p>
<p><br />
She therefore wants to use a hierarchical regression approach to determine whether <code>attention</code> and <code>sleep</code> explain additional variance in <code>memory_score</code> <em>over and above</em> <code>iq</code> and <code>age</code>.</p>
<p><br />
1. First, fit a linear model to determine the extent to which <code>memory_score</code> is predicted by <code>iq</code> and <code>age</code>. Store the results in <code>memory1</code>.</p>
<div class="webex-solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="multiple3.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the baseline model</span></span>
<span id="cb25-2"><a href="multiple3.html#cb25-2" aria-hidden="true" tabindex="-1"></a>memory1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(memory_score <span class="sc">~</span> iq <span class="sc">+</span> age, <span class="at">data =</span> memory_data)</span>
<span id="cb25-3"><a href="multiple3.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="multiple3.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the model results</span></span>
<span id="cb25-5"><a href="multiple3.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(memory1)</span>
<span id="cb25-6"><a href="multiple3.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb25-7"><a href="multiple3.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb25-8"><a href="multiple3.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> memory_score <span class="sc">~</span> iq <span class="sc">+</span> age, <span class="at">data =</span> memory_data)</span>
<span id="cb25-9"><a href="multiple3.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb25-10"><a href="multiple3.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb25-11"><a href="multiple3.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb25-12"><a href="multiple3.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">44.154</span> <span class="sc">-</span><span class="fl">11.754</span>   <span class="fl">0.732</span>  <span class="fl">11.608</span>  <span class="fl">40.790</span> </span>
<span id="cb25-13"><a href="multiple3.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb25-14"><a href="multiple3.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb25-15"><a href="multiple3.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>             Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb25-16"><a href="multiple3.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept)  <span class="fl">71.1669</span>     <span class="fl">9.0796</span>   <span class="fl">7.838</span> <span class="fl">1.67e-13</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb25-17"><a href="multiple3.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> iq            <span class="fl">0.1073</span>     <span class="fl">0.0699</span>   <span class="fl">1.534</span>    <span class="fl">0.126</span>    </span>
<span id="cb25-18"><a href="multiple3.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> age           <span class="fl">0.8220</span>     <span class="fl">0.1461</span>   <span class="fl">5.627</span> <span class="fl">5.27e-08</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb25-19"><a href="multiple3.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span></span>
<span id="cb25-20"><a href="multiple3.html#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb25-21"><a href="multiple3.html#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb25-22"><a href="multiple3.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">16.1</span> on <span class="dv">231</span> degrees of freedom</span>
<span id="cb25-23"><a href="multiple3.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.1303</span>,  Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.1228</span> </span>
<span id="cb25-24"><a href="multiple3.html#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">17.31</span> on <span class="dv">2</span> and <span class="dv">231</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">9.875e-08</span></span></code></pre></div>
</div>
<p><br />
2. Next, add <code>attention</code> and <code>sleep</code> to the model, storing your results in <code>memory2</code>.</p>
<div class="webex-solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="multiple3.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the next model</span></span>
<span id="cb26-2"><a href="multiple3.html#cb26-2" aria-hidden="true" tabindex="-1"></a>memory2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(memory_score <span class="sc">~</span> iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep, <span class="at">data =</span> memory_data)</span>
<span id="cb26-3"><a href="multiple3.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="multiple3.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the results</span></span>
<span id="cb26-5"><a href="multiple3.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(memory2)</span>
<span id="cb26-6"><a href="multiple3.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb26-7"><a href="multiple3.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb26-8"><a href="multiple3.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lm</span>(<span class="at">formula =</span> memory_score <span class="sc">~</span> iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep, <span class="at">data =</span> memory_data)</span>
<span id="cb26-9"><a href="multiple3.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb26-10"><a href="multiple3.html#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals<span class="sc">:</span></span>
<span id="cb26-11"><a href="multiple3.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span id="cb26-12"><a href="multiple3.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">28.935</span>  <span class="sc">-</span><span class="fl">8.555</span>   <span class="fl">1.713</span>   <span class="fl">8.450</span>  <span class="fl">31.384</span> </span>
<span id="cb26-13"><a href="multiple3.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb26-14"><a href="multiple3.html#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients<span class="sc">:</span></span>
<span id="cb26-15"><a href="multiple3.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>             Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb26-16"><a href="multiple3.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> (Intercept)  <span class="fl">9.60112</span>    <span class="fl">8.57889</span>   <span class="fl">1.119</span> <span class="fl">0.264246</span>    </span>
<span id="cb26-17"><a href="multiple3.html#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iq           <span class="fl">0.18673</span>    <span class="fl">0.05451</span>   <span class="fl">3.426</span> <span class="fl">0.000726</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb26-18"><a href="multiple3.html#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> age          <span class="fl">0.86579</span>    <span class="fl">0.11308</span>   <span class="fl">7.656</span> <span class="fl">5.32e-13</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb26-19"><a href="multiple3.html#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> attention    <span class="fl">0.22894</span>    <span class="fl">0.02757</span>   <span class="fl">8.302</span> <span class="fl">8.88e-15</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb26-20"><a href="multiple3.html#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> sleep        <span class="fl">3.68609</span>    <span class="fl">0.39328</span>   <span class="fl">9.373</span>  <span class="sc">&lt;</span> <span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb26-21"><a href="multiple3.html#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span></span>
<span id="cb26-22"><a href="multiple3.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb26-23"><a href="multiple3.html#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb26-24"><a href="multiple3.html#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">12.46</span> on <span class="dv">229</span> degrees of freedom</span>
<span id="cb26-25"><a href="multiple3.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Multiple R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.4839</span>,  Adjusted R<span class="sc">-</span>squared<span class="sc">:</span>  <span class="fl">0.4749</span> </span>
<span id="cb26-26"><a href="multiple3.html#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">53.68</span> on <span class="dv">4</span> and <span class="dv">229</span> DF,  p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.2e-16</span></span></code></pre></div>
</div>
<p><br />
3. Now, compare the <code>memory1</code> and <code>memory2</code> models using <code>anova()</code></p>
<div class="webex-solution">
<button>
Try first, then click to see the code
</button>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="multiple3.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(memory1, memory2)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Res.Df</th>
<th align="right">RSS</th>
<th align="right">Df</th>
<th align="right">Sum of Sq</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">231</td>
<td align="right">59912.24</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">229</td>
<td align="right">35553.54</td>
<td align="right">2</td>
<td align="right">24358.7</td>
<td align="right">78.44706</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br />
<br />
<strong>Answer the following questions:</strong></p>
<ul>
<li><p>A model with <code>iq</code> and <code>age</code> as predictors explains <input class='webex-solveme nospaces' size='5' data-answer='["13.03"]'/> % of the variance in <code>memory_scores</code></p></li>
<li><p>A model with <code>iq</code>, <code>age</code>, <code>attention</code> and <code>sleep</code> as predictors explains <input class='webex-solveme nospaces' size='5' data-answer='["48.39"]'/> % of the variance in <code>memory_scores</code></p></li>
<li><p>Calculate the additional variance explained by the second model: Change in <span class="math inline">\(R^2\)</span> = <input class='webex-solveme nospaces' size='5' data-answer='["35.36"]'/> %</p></li>
<li><p>The ANOVA comparing models can be reported as: <em>F</em>(<input class='webex-solveme nospaces' size='1' data-answer='["2"]'/>, <input class='webex-solveme nospaces' size='3' data-answer='["229"]'/>) = <input class='webex-solveme nospaces' size='5' data-answer='["78.45"]'/>, <em>p</em> &lt; .001.</p></li>
<li><p>Is there a statistically significant improvement in the prediction of <code>memory_scores</code> as a result of adding <code>attention</code> and <code>sleep</code> to the model? <select class='webex-select'><option value='blank'></option><option value=''>no</option><option value='answer'>yes</option></select></p></li>
</ul>
<p><br />
<br />
<strong>Now use Bayes Factors to determine how much more likely the <code>memory2</code> model is than the <code>memory1</code> model .</strong></p>
<p><br />
</p>
<div class="webex-solution">
<button>
Try first, click here for a reminder of the steps
</button>
<ul>
<li><p>Determine the Bayes Factor for <code>memory1</code></p></li>
<li><p>Determine the Bayes Factor for <code>memory2</code></p></li>
<li><p>Compare the Bayes Factors for <code>memory2</code> and <code>memory1</code></p></li>
</ul>
</div>
<p><br />
</p>
<div class="webex-solution">
<button>
Try first, click here to see the code
</button>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="multiple3.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the Bayes Factor for the first model in memory1.BF</span></span>
<span id="cb28-2"><a href="multiple3.html#cb28-2" aria-hidden="true" tabindex="-1"></a>memory1.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(memory_score <span class="sc">~</span> iq <span class="sc">+</span> age, <span class="at">data =</span> <span class="fu">as.data.frame</span>(memory_data) )</span>
<span id="cb28-3"><a href="multiple3.html#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="multiple3.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the Bayes Factor for the second model in memory2.BF</span></span>
<span id="cb28-5"><a href="multiple3.html#cb28-5" aria-hidden="true" tabindex="-1"></a>memory2.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(memory_score <span class="sc">~</span> iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep, <span class="at">data =</span> <span class="fu">as.data.frame</span>(memory_data) )</span>
<span id="cb28-6"><a href="multiple3.html#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="multiple3.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Bayes Factors for memory2.BF vs memory1.BF</span></span>
<span id="cb28-8"><a href="multiple3.html#cb28-8" aria-hidden="true" tabindex="-1"></a>memory2.BF <span class="sc">/</span> memory1.BF</span>
<span id="cb28-9"><a href="multiple3.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb28-10"><a href="multiple3.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb28-11"><a href="multiple3.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep <span class="sc">:</span> <span class="fl">4.168455e+23</span> Â±<span class="dv">0</span>%</span>
<span id="cb28-12"><a href="multiple3.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb28-13"><a href="multiple3.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb28-14"><a href="multiple3.html#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   memory_score <span class="sc">~</span> iq <span class="sc">+</span> age </span>
<span id="cb28-15"><a href="multiple3.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb28-16"><a href="multiple3.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Answer the following questions:</strong></p>
<ul>
<li><p>The Bayes Factor comparing <code>memory2</code> and <code>memory1</code> to (2 decimal places) is <input class='webex-solveme nospaces' size='4' data-answer='["4.17"]'/> e+ <input class='webex-solveme nospaces' size='2' data-answer='["23"]'/>.</p></li>
<li><p>Does the Bayes Factor support the conclusions from the ANOVA? <select class='webex-select'><option value='blank'></option><option value=''>no</option><option value='answer'>yes</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Click for answer
</button>
<p>Yes! The Bayes Factor is equal to <span class="math inline">\(4.17 \times 10^{23}\)</span>, and this therefore strongly supports the inclusion of <code>attention</code> and <code>sleep</code> in the model already containing <code>iq</code> and <code>age</code>.</p>
</div>
<p><br />
</p>
<p><br />
<strong>Extra exercises, if there's time</strong></p>
<p><strong>1.</strong></p>
<p>The researcher wishes to predict the <code>memory_score</code> for a new individual with <code>iq</code> = 105, <code>age</code> = 27, <code>attention</code> = 90, <code>sleep</code> = 8. Determine the prediction.</p>
<p><br />
Hint: in a previous session, you have previously used the <code>predict()</code> function to do this.</p>
<p><br />
</p>
<ul>
<li>The predicted <code>memory_score</code> is <input class='webex-solveme nospaces' size='6' data-answer='["102.68"]'/></li>
</ul>
<div class="webex-solution">
<button>
Try first, then click to show the code for the answer
</button>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="multiple3.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create tibble for the new data</span></span>
<span id="cb29-2"><a href="multiple3.html#cb29-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">iq =</span> <span class="dv">105</span>, <span class="at">age =</span> <span class="dv">27</span>, <span class="at">attention =</span> <span class="dv">90</span>, <span class="at">sleep =</span> <span class="dv">8</span>)</span>
<span id="cb29-3"><a href="multiple3.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="multiple3.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use predict to derive prediction from new data</span></span>
<span id="cb29-5"><a href="multiple3.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(memory2, new_data)</span>
<span id="cb29-6"><a href="multiple3.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        <span class="dv">1</span> </span>
<span id="cb29-7"><a href="multiple3.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">102.6768</span></span></code></pre></div>
</div>
<p><br />
<br />
</p>
<p><strong>2.</strong>
Create a scatterplot of <code>attention</code> against <code>memory_score</code>, with the size of each point indicating the hours of <code>sleep</code></p>
<div class="webex-solution">
<button>
Try yourself first, then click for the code
</button>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="multiple3.html#cb30-1" aria-hidden="true" tabindex="-1"></a>memory_data <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="multiple3.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> attention, <span class="at">y =</span> memory_score, <span class="at">size =</span> sleep)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="multiple3.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>   <span class="co"># alpha=0.5 makes points 50% transparent</span></span>
<span id="cb30-4"><a href="multiple3.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Memory Score&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="multiple3.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Attention Score&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="multiple3.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">size=</span><span class="st">&quot;Sleep (hours)&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="05_multiple_regression_3_files/figure-html/unnamed-chunk-19-1.png" alt="TRUE" width="100%" />
<p class="caption">
Figure 5.1: TRUE
</p>
</div>
</div>
<p><br />
<br />
<strong>3.</strong></p>
<p>The researcher is interested to know whether annual consumption of blueberries has any bearing on <code>memory_scores</code>, and so wants to add <code>blueberries</code> to the model in <code>memory2</code>.</p>
<p><br />
Determine the Bayes Factor comparing <code>memory2</code> with a model that additionally contains <code>blueberries</code>.</p>
<ul>
<li><p>The Bayes Factor for the model comparison is <input class='webex-solveme nospaces' size='4' data-answer='["0.17",".17"]'/> (to 2 decimal places)</p></li>
<li><p>The Bayes Factor indicates that the model with <code>blueberries</code> is <select class='webex-select'><option value='blank'></option><option value=''>more likely</option><option value='answer'>less likely</option></select> than the model without it.</p></li>
<li><p>Should the researcher add <code>blueberries</code> to the model? <select class='webex-select'><option value='blank'></option><option value='answer'>no</option><option value=''>yes</option><option value=''>if it tastes good</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Try yourself first, then click for the code
</button>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="multiple3.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add blueberries to memory2; store in memory3.BF</span></span>
<span id="cb31-2"><a href="multiple3.html#cb31-2" aria-hidden="true" tabindex="-1"></a>memory3.BF <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(memory_score <span class="sc">~</span> iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep <span class="sc">+</span> blueberries, <span class="at">data =</span> <span class="fu">as.data.frame</span>(memory_data) )</span>
<span id="cb31-3"><a href="multiple3.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="multiple3.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the BF for memory3 vs memory2</span></span>
<span id="cb31-5"><a href="multiple3.html#cb31-5" aria-hidden="true" tabindex="-1"></a>memory3.BF <span class="sc">/</span> memory2.BF</span>
<span id="cb31-6"><a href="multiple3.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Bayes factor analysis</span>
<span id="cb31-7"><a href="multiple3.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">--------------</span></span>
<span id="cb31-8"><a href="multiple3.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> [<span class="dv">1</span>] iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep <span class="sc">+</span> blueberries <span class="sc">:</span> <span class="fl">0.1663574</span> Â±<span class="dv">0</span>%</span>
<span id="cb31-9"><a href="multiple3.html#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb31-10"><a href="multiple3.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Against denominator<span class="sc">:</span></span>
<span id="cb31-11"><a href="multiple3.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   memory_score <span class="sc">~</span> iq <span class="sc">+</span> age <span class="sc">+</span> attention <span class="sc">+</span> sleep </span>
<span id="cb31-12"><a href="multiple3.html#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb31-13"><a href="multiple3.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Bayes factor type<span class="sc">:</span> BFlinearModel, JZS</span></code></pre></div>
</div>
</div>
</div>
<div id="summary-of-key-points-1" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Summary of key points</h2>
<ul>
<li><p>We can compare a model with one that has more predictors by using <code>anova(model1, model2)</code>.</p></li>
<li><p>We can compare models using Bayes Factors with <code>lmBF</code> in the <code>BayesFactor</code> package.</p></li>
<li><p>A <strong>Bayes Factor</strong> is probability of one model relative to another, <em>given the data</em>.</p></li>
<li><p>To compare Bayes Factors of models:</p>
<ul>
<li><p>First obtain the Bayes Factors for <code>model1</code> and <code>model2</code>.</p></li>
<li><p>Then use <code>model2 / model1</code> to get the Bayes Factor, indicating how much more likely <code>model2</code> is.</p></li>
</ul></li>
<li><p>Bayes Factors less than 1 indicate evidence for <code>model1</code></p></li>
<li><p>Bayes Factors greater than 1 indicate evidence for <code>model2</code></p></li>
<li><p>We can report Bayes Factors as <span class="math inline">\(BF_{10}\)</span> = 2.23 (or BF10 = 2.23)</p></li>
</ul>
<p><br />
</p>
<p>Next week's session will build on what was done in this session, so make sure you understand what was covered and ask if there's anything you're unsure of.</p>

</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-regression-one-continuous-one-categorical.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-repeated-measures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
