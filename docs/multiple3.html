<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 5 Multiple regression: hierarchical regression | PSYC753 Data Fluency: Analysis</title>
  <meta name="description" content="Course materials for PSYC753 2023" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 5 Multiple regression: hierarchical regression | PSYC753 Data Fluency: Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for PSYC753 2023" />
  <meta name="github-repo" content="datafluencyCB" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 5 Multiple regression: hierarchical regression | PSYC753 Data Fluency: Analysis" />
  
  <meta name="twitter:description" content="Course materials for PSYC753 2023" />
  

<meta name="author" content="Chris Berry" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple2.html"/>
<link rel="next" href="anova2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PSYC753 Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="simple1.html"><a href="simple1.html"><i class="fa fa-check"></i><b>1</b> Simple Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simple1.html"><a href="simple1.html#overview-1"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="simple1.html"><a href="simple1.html#worked-example"><i class="fa fa-check"></i><b>1.2</b> Worked Example</a></li>
<li class="chapter" data-level="1.3" data-path="simple1.html"><a href="simple1.html#predicting"><i class="fa fa-check"></i><b>1.3</b> Predicting</a></li>
<li class="chapter" data-level="1.4" data-path="simple1.html"><a href="simple1.html#residuals"><i class="fa fa-check"></i><b>1.4</b> Residuals</a></li>
<li class="chapter" data-level="1.5" data-path="simple1.html"><a href="simple1.html#evaluating-the-model"><i class="fa fa-check"></i><b>1.5</b> Evaluating the model</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="simple1.html"><a href="simple1.html#r2"><i class="fa fa-check"></i><b>1.5.1</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="1.5.2" data-path="simple1.html"><a href="simple1.html#bayes-factor"><i class="fa fa-check"></i><b>1.5.2</b> Bayes factor</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="simple1.html"><a href="simple1.html#exercise"><i class="fa fa-check"></i><b>1.6</b> Exercise</a></li>
<li class="chapter" data-level="1.7" data-path="simple1.html"><a href="simple1.html#further-exercises"><i class="fa fa-check"></i><b>1.7</b> Further Exercises</a></li>
<li class="chapter" data-level="1.8" data-path="simple1.html"><a href="simple1.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="simple1.html"><a href="simple1.html#references"><i class="fa fa-check"></i><b>1.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple1.html"><a href="multiple1.html"><i class="fa fa-check"></i><b>2</b> Multiple regression: multiple continuous predictors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="multiple1.html"><a href="multiple1.html#overview-2"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="multiple1.html"><a href="multiple1.html#worked-example-1"><i class="fa fa-check"></i><b>2.2</b> Worked example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="multiple1.html"><a href="multiple1.html#residual-plot"><i class="fa fa-check"></i><b>2.2.1</b> Residual plot</a></li>
<li class="chapter" data-level="2.2.2" data-path="multiple1.html"><a href="multiple1.html#evaluating-the-model-bayes-factor"><i class="fa fa-check"></i><b>2.2.2</b> Evaluating the model: Bayes factor</a></li>
<li class="chapter" data-level="2.2.3" data-path="multiple1.html"><a href="multiple1.html#evaluating-the-model-r2"><i class="fa fa-check"></i><b>2.2.3</b> Evaluating the model: R<sup>2</sup></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="multiple1.html"><a href="multiple1.html#understanding-the-contribution-of-individual-predictors"><i class="fa fa-check"></i><b>2.3</b> Understanding the contribution of individual predictors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="multiple1.html"><a href="multiple1.html#r2-in-simple-vs.-multiple-regression"><i class="fa fa-check"></i><b>2.3.1</b> R<sup>2</sup> in simple vs. multiple regression</a></li>
<li class="chapter" data-level="2.3.2" data-path="multiple1.html"><a href="multiple1.html#venn-diagrams"><i class="fa fa-check"></i><b>2.3.2</b> Venn Diagrams</a></li>
<li class="chapter" data-level="2.3.3" data-path="multiple1.html"><a href="multiple1.html#using-bayes-factors-to-assess-the-unique-contribution-of-predictors"><i class="fa fa-check"></i><b>2.3.3</b> Using Bayes factors to assess the unique contribution of predictors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="multiple1.html"><a href="multiple1.html#multicollinearity"><i class="fa fa-check"></i><b>2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="2.5" data-path="multiple1.html"><a href="multiple1.html#exercise-1"><i class="fa fa-check"></i><b>2.5</b> Exercise</a></li>
<li class="chapter" data-level="2.6" data-path="multiple1.html"><a href="multiple1.html#further-exercises-1"><i class="fa fa-check"></i><b>2.6</b> Further exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="multiple1.html"><a href="multiple1.html#regressionbf"><i class="fa fa-check"></i><b>2.6.1</b> <code>regressionBF()</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="multiple1.html"><a href="multiple1.html#predicting-new-data"><i class="fa fa-check"></i><b>2.6.2</b> Predicting new data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="multiple1.html"><a href="multiple1.html#summary-of-key-points"><i class="fa fa-check"></i><b>2.7</b> Summary of key points</a></li>
<li class="chapter" data-level="2.8" data-path="multiple1.html"><a href="multiple1.html#references-1"><i class="fa fa-check"></i><b>2.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova1.html"><a href="anova1.html"><i class="fa fa-check"></i><b>3</b> ANOVA: between-subjects designs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="anova1.html"><a href="anova1.html#overview-3"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="anova1.html"><a href="anova1.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>3.2</b> One-way between subjects ANOVA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="anova1.html"><a href="anova1.html#worked-example-2"><i class="fa fa-check"></i><b>3.2.1</b> Worked Example</a></li>
<li class="chapter" data-level="3.2.2" data-path="anova1.html"><a href="anova1.html#read-in-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Read in the data</a></li>
<li class="chapter" data-level="3.2.3" data-path="anova1.html"><a href="anova1.html#convert-the-independent-variable-to-a-factor"><i class="fa fa-check"></i><b>3.2.3</b> Convert the independent variable to a factor</a></li>
<li class="chapter" data-level="3.2.4" data-path="anova1.html"><a href="anova1.html#n-of-each-group"><i class="fa fa-check"></i><b>3.2.4</b> n of each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="anova1.html"><a href="anova1.html#visualise-the-data"><i class="fa fa-check"></i><b>3.2.5</b> Visualise the data</a></li>
<li class="chapter" data-level="3.2.6" data-path="anova1.html"><a href="anova1.html#plot-the-means"><i class="fa fa-check"></i><b>3.2.6</b> Plot the means</a></li>
<li class="chapter" data-level="3.2.7" data-path="anova1.html"><a href="anova1.html#descriptives-mean-of-each-group"><i class="fa fa-check"></i><b>3.2.7</b> Descriptives: Mean of each group</a></li>
<li class="chapter" data-level="3.2.8" data-path="anova1.html"><a href="anova1.html#bayes-factor-1"><i class="fa fa-check"></i><b>3.2.8</b> Bayes factor</a></li>
<li class="chapter" data-level="3.2.9" data-path="anova1.html"><a href="anova1.html#r2-1"><i class="fa fa-check"></i><b>3.2.9</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="3.2.10" data-path="anova1.html"><a href="anova1.html#follow-up-tests"><i class="fa fa-check"></i><b>3.2.10</b> Follow-up tests</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="anova1.html"><a href="anova1.html#two-way-between-subjects-anova"><i class="fa fa-check"></i><b>3.3</b> Two-way between-subjects ANOVA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="anova1.html"><a href="anova1.html#worked-example-3"><i class="fa fa-check"></i><b>3.3.1</b> Worked example</a></li>
<li class="chapter" data-level="3.3.2" data-path="anova1.html"><a href="anova1.html#read-in-the-data-1"><i class="fa fa-check"></i><b>3.3.2</b> Read in the data</a></li>
<li class="chapter" data-level="3.3.3" data-path="anova1.html"><a href="anova1.html#convert-the-independent-variables-to-factors"><i class="fa fa-check"></i><b>3.3.3</b> Convert the independent variables to factors</a></li>
<li class="chapter" data-level="3.3.4" data-path="anova1.html"><a href="anova1.html#n-in-each-group"><i class="fa fa-check"></i><b>3.3.4</b> n in each group</a></li>
<li class="chapter" data-level="3.3.5" data-path="anova1.html"><a href="anova1.html#visualise-the-data-1"><i class="fa fa-check"></i><b>3.3.5</b> Visualise the data</a></li>
<li class="chapter" data-level="3.3.6" data-path="anova1.html"><a href="anova1.html#plot-the-means-1"><i class="fa fa-check"></i><b>3.3.6</b> Plot the means</a></li>
<li class="chapter" data-level="3.3.7" data-path="anova1.html"><a href="anova1.html#bayes-factors"><i class="fa fa-check"></i><b>3.3.7</b> Bayes factors</a></li>
<li class="chapter" data-level="3.3.8" data-path="anova1.html"><a href="anova1.html#r2-2"><i class="fa fa-check"></i><b>3.3.8</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="3.3.9" data-path="anova1.html"><a href="anova1.html#follow-up-comparisons"><i class="fa fa-check"></i><b>3.3.9</b> Follow-up comparisons</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="anova1.html"><a href="anova1.html#exercise-one-way"><i class="fa fa-check"></i><b>3.4</b> Exercise: one-way</a></li>
<li class="chapter" data-level="3.5" data-path="anova1.html"><a href="anova1.html#exercise-two-way"><i class="fa fa-check"></i><b>3.5</b> Exercise: two-way</a></li>
<li class="chapter" data-level="3.6" data-path="anova1.html"><a href="anova1.html#summary-1"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
<li class="chapter" data-level="3.7" data-path="anova1.html"><a href="anova1.html#references-2"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple2.html"><a href="multiple2.html"><i class="fa fa-check"></i><b>4</b> Multiple regression: one continuous, one categorical</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple2.html"><a href="multiple2.html#overview-4"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="multiple2.html"><a href="multiple2.html#worked-example-4"><i class="fa fa-check"></i><b>4.2</b> Worked example</a></li>
<li class="chapter" data-level="4.3" data-path="multiple2.html"><a href="multiple2.html#read-in-the-data-2"><i class="fa fa-check"></i><b>4.3</b> Read in the data</a></li>
<li class="chapter" data-level="4.4" data-path="multiple2.html"><a href="multiple2.html#visualise-the-data-2"><i class="fa fa-check"></i><b>4.4</b> Visualise the data</a></li>
<li class="chapter" data-level="4.5" data-path="multiple2.html"><a href="multiple2.html#evidence-for-the-interaction"><i class="fa fa-check"></i><b>4.5</b> Evidence for the interaction</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="multiple2.html"><a href="multiple2.html#model-without-the-interaction"><i class="fa fa-check"></i><b>4.5.1</b> Model without the interaction</a></li>
<li class="chapter" data-level="4.5.2" data-path="multiple2.html"><a href="multiple2.html#model-with-the-interaction"><i class="fa fa-check"></i><b>4.5.2</b> Model with the interaction</a></li>
<li class="chapter" data-level="4.5.3" data-path="multiple2.html"><a href="multiple2.html#compare-the-model-with-and-without-the-interaction"><i class="fa fa-check"></i><b>4.5.3</b> Compare the model with and without the interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="multiple2.html"><a href="multiple2.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>4.6</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="4.7" data-path="multiple2.html"><a href="multiple2.html#exercises"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
<li class="chapter" data-level="4.8" data-path="multiple2.html"><a href="multiple2.html#further-exercise"><i class="fa fa-check"></i><b>4.8</b> Further exercise</a></li>
<li class="chapter" data-level="4.9" data-path="multiple2.html"><a href="multiple2.html#further-knowledge"><i class="fa fa-check"></i><b>4.9</b> Further knowledge</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="multiple2.html"><a href="multiple2.html#moderation"><i class="fa fa-check"></i><b>4.9.1</b> Moderation</a></li>
<li class="chapter" data-level="4.9.2" data-path="multiple2.html"><a href="multiple2.html#coefficients"><i class="fa fa-check"></i><b>4.9.2</b> Coefficients</a></li>
<li class="chapter" data-level="4.9.3" data-path="multiple2.html"><a href="multiple2.html#centering"><i class="fa fa-check"></i><b>4.9.3</b> Centering</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="multiple2.html"><a href="multiple2.html#summary-2"><i class="fa fa-check"></i><b>4.10</b> Summary</a></li>
<li class="chapter" data-level="4.11" data-path="multiple2.html"><a href="multiple2.html#references-3"><i class="fa fa-check"></i><b>4.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple3.html"><a href="multiple3.html"><i class="fa fa-check"></i><b>5</b> Multiple regression: hierarchical regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple3.html"><a href="multiple3.html#overview-5"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="multiple3.html"><a href="multiple3.html#worked-example-1-wellbeing"><i class="fa fa-check"></i><b>5.2</b> Worked example 1: wellbeing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple3.html"><a href="multiple3.html#read-in-the-data-3"><i class="fa fa-check"></i><b>5.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="5.2.2" data-path="multiple3.html"><a href="multiple3.html#visualisation"><i class="fa fa-check"></i><b>5.2.2</b> Visualisation</a></li>
<li class="chapter" data-level="5.2.3" data-path="multiple3.html"><a href="multiple3.html#correlations"><i class="fa fa-check"></i><b>5.2.3</b> Correlations</a></li>
<li class="chapter" data-level="5.2.4" data-path="multiple3.html"><a href="multiple3.html#hierarchical-regression"><i class="fa fa-check"></i><b>5.2.4</b> Hierarchical regression</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple3.html"><a href="multiple3.html#exercise-1-1"><i class="fa fa-check"></i><b>5.3</b> Exercise 1</a></li>
<li class="chapter" data-level="5.4" data-path="multiple3.html"><a href="multiple3.html#worked-exercise-2-controlling-for-categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Worked Exercise 2: Controlling for categorical variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple3.html"><a href="multiple3.html#visualisation-1"><i class="fa fa-check"></i><b>5.4.1</b> Visualisation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple3.html"><a href="multiple3.html#exercise-2"><i class="fa fa-check"></i><b>5.5</b> Exercise 2</a></li>
<li class="chapter" data-level="5.6" data-path="multiple3.html"><a href="multiple3.html#further-knowledge-and-exercises"><i class="fa fa-check"></i><b>5.6</b> Further knowledge and exercises</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="multiple3.html"><a href="multiple3.html#standardised-coefficients"><i class="fa fa-check"></i><b>5.6.1</b> Standardised Coefficients</a></li>
<li class="chapter" data-level="5.6.2" data-path="multiple3.html"><a href="multiple3.html#prediction"><i class="fa fa-check"></i><b>5.6.2</b> Prediction</a></li>
<li class="chapter" data-level="5.6.3" data-path="multiple3.html"><a href="multiple3.html#residuals-1"><i class="fa fa-check"></i><b>5.6.3</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="multiple3.html"><a href="multiple3.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="multiple3.html"><a href="multiple3.html#references-4"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova2.html"><a href="anova2.html"><i class="fa fa-check"></i><b>6</b> ANOVA: Repeated measures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova2.html"><a href="anova2.html#overview-6"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="anova2.html"><a href="anova2.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>6.2</b> One-way repeated measures ANOVA</a></li>
<li class="chapter" data-level="6.3" data-path="anova2.html"><a href="anova2.html#long-format-data"><i class="fa fa-check"></i><b>6.3</b> Long format data</a></li>
<li class="chapter" data-level="6.4" data-path="anova2.html"><a href="anova2.html#worked-example-5"><i class="fa fa-check"></i><b>6.4</b> Worked Example</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="anova2.html"><a href="anova2.html#read-in-the-data-4"><i class="fa fa-check"></i><b>6.4.1</b> Read in the data</a></li>
<li class="chapter" data-level="6.4.2" data-path="anova2.html"><a href="anova2.html#convert-the-data-to-long-format"><i class="fa fa-check"></i><b>6.4.2</b> Convert the data to long format</a></li>
<li class="chapter" data-level="6.4.3" data-path="anova2.html"><a href="anova2.html#convert-the-participant-and-the-categorical-variable-to-factors"><i class="fa fa-check"></i><b>6.4.3</b> Convert the participant and the categorical variable to factors</a></li>
<li class="chapter" data-level="6.4.4" data-path="anova2.html"><a href="anova2.html#visualise-the-data-3"><i class="fa fa-check"></i><b>6.4.4</b> Visualise the data</a></li>
<li class="chapter" data-level="6.4.5" data-path="anova2.html"><a href="anova2.html#plot-the-means-2"><i class="fa fa-check"></i><b>6.4.5</b> Plot the means</a></li>
<li class="chapter" data-level="6.4.6" data-path="anova2.html"><a href="anova2.html#descriptives-mean-of-each-condition"><i class="fa fa-check"></i><b>6.4.6</b> Descriptives: Mean of each condition</a></li>
<li class="chapter" data-level="6.4.7" data-path="anova2.html"><a href="anova2.html#bayes-factor-2"><i class="fa fa-check"></i><b>6.4.7</b> Bayes factor</a></li>
<li class="chapter" data-level="6.4.8" data-path="anova2.html"><a href="anova2.html#follow-up-tests-1"><i class="fa fa-check"></i><b>6.4.8</b> Follow-up tests</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="anova2.html"><a href="anova2.html#two-way-within-subjects-anova"><i class="fa fa-check"></i><b>6.5</b> Two-way within subjects ANOVA</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="anova2.html"><a href="anova2.html#worked-example-6"><i class="fa fa-check"></i><b>6.5.1</b> Worked Example</a></li>
<li class="chapter" data-level="6.5.2" data-path="anova2.html"><a href="anova2.html#read-in-the-data-5"><i class="fa fa-check"></i><b>6.5.2</b> Read in the data</a></li>
<li class="chapter" data-level="6.5.3" data-path="anova2.html"><a href="anova2.html#visualise-the-data-4"><i class="fa fa-check"></i><b>6.5.3</b> Visualise the data</a></li>
<li class="chapter" data-level="6.5.4" data-path="anova2.html"><a href="anova2.html#plot-the-means-3"><i class="fa fa-check"></i><b>6.5.4</b> Plot the means</a></li>
<li class="chapter" data-level="6.5.5" data-path="anova2.html"><a href="anova2.html#descriptive-statistics---mean"><i class="fa fa-check"></i><b>6.5.5</b> Descriptive statistics - mean</a></li>
<li class="chapter" data-level="6.5.6" data-path="anova2.html"><a href="anova2.html#convert-participant-and-categorical-variables-to-factors"><i class="fa fa-check"></i><b>6.5.6</b> Convert participant and categorical variables to factors</a></li>
<li class="chapter" data-level="6.5.7" data-path="anova2.html"><a href="anova2.html#bayes-factor-3"><i class="fa fa-check"></i><b>6.5.7</b> Bayes factor</a></li>
<li class="chapter" data-level="6.5.8" data-path="anova2.html"><a href="anova2.html#follow-up-comparisons-1"><i class="fa fa-check"></i><b>6.5.8</b> Follow up comparisons</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="anova2.html"><a href="anova2.html#exercise-two-way-mixed-anova"><i class="fa fa-check"></i><b>6.6</b> Exercise: two-way mixed ANOVA</a></li>
<li class="chapter" data-level="6.7" data-path="anova2.html"><a href="anova2.html#further-knowledge---within-subject-errorbars"><i class="fa fa-check"></i><b>6.7</b> Further knowledge - within-subject errorbars</a></li>
<li class="chapter" data-level="6.8" data-path="anova2.html"><a href="anova2.html#further-knowledge---r-squared"><i class="fa fa-check"></i><b>6.8</b> Further knowledge - R-squared</a></li>
<li class="chapter" data-level="6.9" data-path="anova2.html"><a href="anova2.html#summary-4"><i class="fa fa-check"></i><b>6.9</b> Summary</a></li>
<li class="chapter" data-level="6.10" data-path="anova2.html"><a href="anova2.html#references-5"><i class="fa fa-check"></i><b>6.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prepost.html"><a href="prepost.html"><i class="fa fa-check"></i><b>7</b> Pre-post data, clinically significant change</a>
<ul>
<li class="chapter" data-level="7.1" data-path="prepost.html"><a href="prepost.html#overview-7"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="prepost.html"><a href="prepost.html#worked-example-7"><i class="fa fa-check"></i><b>7.1.1</b> Worked example</a></li>
<li class="chapter" data-level="7.1.2" data-path="prepost.html"><a href="prepost.html#read-in-the-data-6"><i class="fa fa-check"></i><b>7.1.2</b> Read in the data</a></li>
<li class="chapter" data-level="7.1.3" data-path="prepost.html"><a href="prepost.html#plot-the-means-4"><i class="fa fa-check"></i><b>7.1.3</b> Plot the means</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="prepost.html"><a href="prepost.html#approach-1---difference-scores"><i class="fa fa-check"></i><b>7.2</b> Approach 1 - Difference scores</a></li>
<li class="chapter" data-level="7.3" data-path="prepost.html"><a href="prepost.html#approach-2---mixed-anova"><i class="fa fa-check"></i><b>7.3</b> Approach 2 - Mixed ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="prepost.html"><a href="prepost.html#approach-3---ancova"><i class="fa fa-check"></i><b>7.4</b> Approach 3 - ANCOVA</a></li>
<li class="chapter" data-level="7.5" data-path="prepost.html"><a href="prepost.html#which-approach-should-you-use"><i class="fa fa-check"></i><b>7.5</b> Which approach should you use?</a></li>
<li class="chapter" data-level="7.6" data-path="prepost.html"><a href="prepost.html#clinical-significance"><i class="fa fa-check"></i><b>7.6</b> Clinical Significance</a></li>
<li class="chapter" data-level="7.7" data-path="prepost.html"><a href="prepost.html#exercises-1"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
<li class="chapter" data-level="7.8" data-path="prepost.html"><a href="prepost.html#further-knowledge-1"><i class="fa fa-check"></i><b>7.8</b> Further Knowledge</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="prepost.html"><a href="prepost.html#reliable-change-rc-index"><i class="fa fa-check"></i><b>7.8.1</b> Reliable Change (RC) index</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="prepost.html"><a href="prepost.html#summary-5"><i class="fa fa-check"></i><b>7.9</b> Summary</a></li>
<li class="chapter" data-level="7.10" data-path="prepost.html"><a href="prepost.html#references-6"><i class="fa fa-check"></i><b>7.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="assessment2023.html"><a href="assessment2023.html"><i class="fa fa-check"></i><b>8</b> Data Analysis Assessment 2023</a></li>
<li class="chapter" data-level="9" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i><b>9</b> FAQs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="faqs.html"><a href="faqs.html#e-meaning"><i class="fa fa-check"></i><b>9.1</b> What does it mean if RStudio prints out "e-" next to a number?</a></li>
<li class="chapter" data-level="9.2" data-path="faqs.html"><a href="faqs.html#how-can-i-find-out-more-about-a-particular-function-so-i-can-explore-its-settings-etc."><i class="fa fa-check"></i><b>9.2</b> How can I find out more about a particular function, so I can explore its settings etc.?</a></li>
<li class="chapter" data-level="9.3" data-path="faqs.html"><a href="faqs.html#how-should-i-write-up-the-report"><i class="fa fa-check"></i><b>9.3</b> How should I write up the report?</a></li>
<li class="chapter" data-level="9.4" data-path="faqs.html"><a href="faqs.html#after-downloading-my-.rmd-file-to-my-computer-how-do-i-open-it-again-in-rstudio"><i class="fa fa-check"></i><b>9.4</b> After downloading my .Rmd file to my computer, how do I open it again in RStudio?</a></li>
<li class="chapter" data-level="9.5" data-path="faqs.html"><a href="faqs.html#on-the-word-count-are-figure-captions-included"><i class="fa fa-check"></i><b>9.5</b> On the word count, are figure captions included?</a></li>
<li class="chapter" data-level="9.6" data-path="faqs.html"><a href="faqs.html#should-i-make-code-visible-in-my-html-report"><i class="fa fa-check"></i><b>9.6</b> Should I make code visible in my html report?</a></li>
<li class="chapter" data-level="9.7" data-path="faqs.html"><a href="faqs.html#do-i-need-to-include-references"><i class="fa fa-check"></i><b>9.7</b> Do I need to include references?</a></li>
<li class="chapter" data-level="9.8" data-path="faqs.html"><a href="faqs.html#can-there-be-overlap-in-the-variables-used-in-each-question"><i class="fa fa-check"></i><b>9.8</b> Can there be overlap in the variables used in each question?</a></li>
<li class="chapter" data-level="9.9" data-path="faqs.html"><a href="faqs.html#do-we-have-to-include-a-certain-number-of-variables-to-achieve-a-good-grade"><i class="fa fa-check"></i><b>9.9</b> Do we have to include a certain number of variables to achieve a good grade?</a></li>
<li class="chapter" data-level="9.10" data-path="faqs.html"><a href="faqs.html#can-i-include-more-than-one-figure"><i class="fa fa-check"></i><b>9.10</b> Can I include more than one figure?</a></li>
<li class="chapter" data-level="9.11" data-path="faqs.html"><a href="faqs.html#can-i-include-categorical-predictor-variables-in-a-hierarchical-regression"><i class="fa fa-check"></i><b>9.11</b> Can I include categorical predictor variables in a hierarchical regression?</a></li>
<li class="chapter" data-level="9.12" data-path="faqs.html"><a href="faqs.html#how-do-i-apply-for-extenuating-circumstances"><i class="fa fa-check"></i><b>9.12</b> How do I apply for extenuating circumstances?</a></li>
<li class="chapter" data-level="9.13" data-path="faqs.html"><a href="faqs.html#can-a-book-a-slot-in-your-office-hours"><i class="fa fa-check"></i><b>9.13</b> Can a book a slot in your office hours?</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSYC753 Data Fluency: Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple3" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Session 5</span> Multiple regression: hierarchical regression<a href="multiple3.html#multiple3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Chris Berry</em><br />
<em>2023</em></p>
<style>
div.exercise { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<style>
div.tip { background-color:#D5F5E3; border-radius: 5px; padding: 20px;}
</style>
<div id="overview-5" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Overview<a href="multiple3.html#overview-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>Slides</strong> from the lecture part of the session: <a href="slides/PSYC753_L5_MultipleRegression3.pptx">Download</a></li>
</ul>
<p><br />
</p>
<p><strong>Hierarchical regression</strong> is a form of multiple regression analysis and can be used when we want to add predictor variables to a model in discrete steps or stages. The technique allows the unique contribution of the variables on each step to be separately determined.</p>
<p>We can use it when we want to know whether a predictor variable (e.g., <code>sense_of_belonging</code>) predicts an outcome (e.g., <code>social_interaction</code>) after controlling for background variables that are categorical (e.g., <code>gender</code>, <code>level of education</code>) or continuous (e.g., <code>age</code>, <code>score on a cognitive test</code>) in nature. The variables entered on each step can also be determined by theoretical considerations, to test specific hypotheses.</p>
<p>At each step in the analysis, the increase in the variance explained in the outcome variable (i.e., R<sup>2</sup>) and evidence for the unique contribution of the predictors (with Bayes factors) can be assessed.</p>
<p>Hierarchical regression is sometimes called <em>sequential regression</em>.</p>
<p><br />
</p>
</div>
<div id="worked-example-1-wellbeing" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Worked example 1: wellbeing<a href="multiple3.html#worked-example-1-wellbeing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Session 2, we analysed some of the data from Iani et al. (2019) and found evidence that <code>brooding</code> and <code>worry</code> predicted <code>wellbeing</code> in a multiple regression.</p>
<p>Iani et al. (2019) were actually primarily interested in whether mindfulness and emotional intelligence predicted psychological wellbeing scores, but <em>after</em> controlling for <code>brooding</code> and <code>worry</code>. The reason for asking the question in this way is because it's a well-established finding that <code>brooding</code> and <code>worry</code> explain <code>wellbeing</code>, but less is known about <code>mindfulness</code> and <code>emotional intelligence</code>.</p>
<p>To control for <code>brooding</code> and <code>worry</code>, these variables are entered into a regression first. Next, mindfulness and emotional intelligence are added, and the <em>change</em> in R<sup>2</sup> associated with their addition to the model can be evaluated. Bayes factors can also be used to assess the unique contribution of the predictors added at each step.</p>
<p><br />
</p>
<div id="read-in-the-data-3" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Read in the data<a href="multiple3.html#read-in-the-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Read the data to R, and store in <code>pwb_data</code> (to stand for Psychological WellBeing data). The data we'll use are located at:</p>
<p><a href="https://raw.githubusercontent.com/chrisjberry/Teaching/master/2_wellbeing_data.csv" class="uri">https://raw.githubusercontent.com/chrisjberry/Teaching/master/2_wellbeing_data.csv</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="multiple3.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First ensure tidyverse is loaded, i.e., &#39;library(tidyverse)&#39;</span></span>
<span id="cb1-2"><a href="multiple3.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="multiple3.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the data using read_csv(), store in pwb_data</span></span>
<span id="cb1-4"><a href="multiple3.html#cb1-4" aria-hidden="true" tabindex="-1"></a>pwb_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/2_wellbeing_data.csv&#39;</span>)</span></code></pre></div>
<p>(<em>Note.</em> The data are publicly available, but I've changed the variable names for clarity. As in Iani et al., missing values were replaced with the mean of the relevant variable.)</p>
<p>Preview the data with <code>head()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="multiple3.html#cb2-1" aria-hidden="true" tabindex="-1"></a>pwb_data <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="10%" />
<col width="9%" />
<col width="6%" />
<col width="13%" />
<col width="10%" />
<col width="9%" />
<col width="7%" />
<col width="6%" />
<col width="8%" />
<col width="5%" />
<col width="9%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">describing</th>
<th align="right">observing</th>
<th align="right">acting</th>
<th align="right">nonreactivity</th>
<th align="right">nonjudging</th>
<th align="right">attention</th>
<th align="right">clarity</th>
<th align="right">repair</th>
<th align="right">brooding</th>
<th align="right">worry</th>
<th align="right">wellbeing</th>
<th align="right">gad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">13</td>
<td align="right">14</td>
<td align="right">19</td>
<td align="right">6</td>
<td align="right">15</td>
<td align="right">23</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">64</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">6</td>
<td align="right">15</td>
<td align="right">13</td>
<td align="right">12</td>
<td align="right">24</td>
<td align="right">20</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">30</td>
<td align="right">72</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">14</td>
<td align="right">16</td>
<td align="right">17</td>
<td align="right">11</td>
<td align="right">31</td>
<td align="right">27</td>
<td align="right">26</td>
<td align="right">15</td>
<td align="right">30</td>
<td align="right">59</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">10</td>
<td align="right">18</td>
<td align="right">18</td>
<td align="right">18</td>
<td align="right">27</td>
<td align="right">18</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">29</td>
<td align="right">62</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">16</td>
<td align="right">21</td>
<td align="right">24</td>
<td align="right">14</td>
<td align="right">8</td>
<td align="right">27</td>
<td align="right">78</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">15</td>
<td align="right">18</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">30</td>
<td align="right">26</td>
<td align="right">23</td>
<td align="right">10</td>
<td align="right">23</td>
<td align="right">78</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<p><strong>About the data:</strong></p>
<p>Mindfulness variables:</p>
<ul>
<li><code>describing</code>: Higher scores indicate greater ability to describe one's inner experiences.</li>
<li><code>observing</code>: Higher scores indicate greater levels of observing.</li>
<li><code>acting</code>: Higher scores indicate greater levels of acting with awareness.</li>
<li><code>nonreactivity</code>: Higher scores indicate greater levels of nonreactivity.</li>
<li><code>nonjudging</code>: Higher scores indicate greater levels of nonjudging.</li>
</ul>
<p>Emotional intelligence variables:</p>
<ul>
<li><code>attention</code>: Higher scores indicate greater skill in attending to their feelings and moods.</li>
<li><code>clarity</code>: Higher scores indicate greater skill in experiencing their feelings clearly.</li>
<li><code>repair</code>: Higher scores indicate greater skill in regulating unpleasant moods or prolonging pleasant ones.</li>
</ul>
<p>Negative functioning variables:</p>
<ul>
<li><code>brooding</code>: Higher scores indicate greater levels of brooding.</li>
<li><code>worry</code>: Higher scores indicate greater levels of worry.</li>
</ul>
<p>Outcome variables:</p>
<ul>
<li><code>wellbeing</code>: Higher scores indicate higher levels of psychological wellbeing in terms of self-acceptance, positive relations with others, autonomy, environmental mastery, purpose in life, and personal growth.</li>
<li><code>gad</code>: higher scores indicate greater severity of Generalised Anxiety Disorder.</li>
</ul>
<p><br />
</p>
</div>
<div id="visualisation" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Visualisation<a href="multiple3.html#visualisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of continuous variables in the dataset that we can visualise with density plots or histograms. We've done this individually, variable by variable in past worksheets. Here I'd like to show you a more advanced way of plotting. The code below will create a density plot of every variable in a dataset that is numeric (continuous) in nature, using different facets:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="multiple3.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot density plots of all the numeric (continuous) variables</span></span>
<span id="cb3-2"><a href="multiple3.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The code below:</span></span>
<span id="cb3-3"><a href="multiple3.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -Keeps only the numeric columns in a data frame</span></span>
<span id="cb3-4"><a href="multiple3.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses pivot_longer() to code each set of scores by its variable name</span></span>
<span id="cb3-5"><a href="multiple3.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -Specifies the &#39;score&#39; to plot in aes()</span></span>
<span id="cb3-6"><a href="multiple3.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses facet_wrap() to plot each variable in a separate panel</span></span>
<span id="cb3-7"><a href="multiple3.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses scales = &quot;free&quot; to allow the range on the x- and y-axis to be different across panels</span></span>
<span id="cb3-8"><a href="multiple3.html#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="multiple3.html#cb3-9" aria-hidden="true" tabindex="-1"></a>pwb_data <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="multiple3.html#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">%&gt;%</span>                     </span>
<span id="cb3-11"><a href="multiple3.html#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-12"><a href="multiple3.html#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(score)) <span class="sc">+</span>                     </span>
<span id="cb3-13"><a href="multiple3.html#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>     </span>
<span id="cb3-14"><a href="multiple3.html#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()        </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="05_multiple_regression_3_files/figure-html/unnamed-chunk-4-1.png" alt="Density plots for each continous predictor in pwb_data" width="100%" />
<p class="caption">
Figure 5.1: Density plots for each continous predictor in pwb_data
</p>
</div>
<p><br />
</p>
</div>
<div id="correlations" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Correlations<a href="multiple3.html#correlations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With many variables being used in a multiple regression, it is good practice to inspect the correlations between all continuous variables first to get an idea of the inter-relations and to check for multicollinearity between predictors.</p>
<p>Obtain a correlation matrix of all of the numeric variables. Ensure the <code>corrr</code> package is loaded, then use <code>correlate()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="multiple3.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(corrr) # ensure this is loaded</span></span>
<span id="cb4-2"><a href="multiple3.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="multiple3.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># correlations of all numeric variables</span></span>
<span id="cb4-4"><a href="multiple3.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use mutate() with round() to round to 2 D.P.</span></span>
<span id="cb4-5"><a href="multiple3.html#cb4-5" aria-hidden="true" tabindex="-1"></a>pwb_data <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="multiple3.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="multiple3.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="multiple3.html#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="at">digits =</span> <span class="dv">2</span>))</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Exercise 5.1  </strong></span>Before conducting the hierarchical regression, Iani et al. (2019) reported the Pearson correlations between <code>wellbeing</code> and <code>gad</code> and the mindfulness and emotional intelligence variables. We'll report a subset of those here to check you can read the correlation matrix that's output. Report the correlations below to two decimal places:</p>
<ul>
<li><code>describing</code> and <code>clarity</code>, <em>r</em> = <input class='webex-solveme nospaces' size='4' data-answer='["0.64",".64"]'/></li>
<li><code>describing</code> and <code>wellbeing</code>, <em>r</em> = <input class='webex-solveme nospaces' size='4' data-answer='["0.54",".54"]'/></li>
<li><code>repair</code> and <code>wellbeing</code>, <em>r</em> = <input class='webex-solveme nospaces' size='4' data-answer='["0.50",".50"]'/></li>
<li><code>nonreactivity</code> and <code>brooding</code>, <em>r</em> = <input class='webex-solveme nospaces' size='5' data-answer='["-0.25","-.25"]'/></li>
<li><code>nonreactivity</code> and <code>gad</code>, <em>r</em> = <input class='webex-solveme nospaces' size='5' data-answer='["-0.22","-.22"]'/></li>
</ul>
<p><br />
</p>
<ul>
<li>Does multicollinearity seem an issue (check the correlations between the <em>predictor variables</em> for <em>r</em> &lt; -0.8 or <em>r</em> &gt; 0.8)? <select class='webex-select'><option value='blank'></option><option value=''>yes</option><option value='answer'>no</option></select></li>
</ul>
</div>
<p><br />
</p>
</div>
<div id="hierarchical-regression" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Hierarchical regression<a href="multiple3.html#hierarchical-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To conduct the hierarchical regression, variables will be entered to the multiple regression in progressive steps, and the change in R<sup>2</sup> associated with the predictors added to the model at each step obtained. Likewise, Bayes factors can be used to determine whether there is evidence that the predictors added at each step make a unique contribution to the prediction of the outcome variable.</p>
<p>Iani et al. (2019) wanted to explain variance in <code>wellbeing</code> (the outcome variable). They reported the non-adjusted R<sup>2</sup>, so that's what we'll do too. Due to theoretical considerations, the variables in each step were entered as follows:</p>
<ul>
<li>Step 1: <code>brooding</code></li>
<li>Step 2: <code>brooding</code>, <code>worry</code></li>
<li>Step 3: <code>brooding</code>, <code>worry</code> and mindfulness variables (<code>describing</code>, <code>observing</code>, <code>acting</code>, <code>nonreactivity</code>, <code>nonjudging</code>)</li>
<li>Step 4: <code>brooding</code>, <code>worry</code>, mindfulness variables (<code>describing</code>, <code>observing</code>, <code>acting</code>, <code>nonreactivity</code>, <code>nonjudging</code>), and emotional intelligence variables (<code>attention</code>, <code>clarity</code>, <code>repair</code>).</li>
</ul>
<p><br />
</p>
<div id="step-1-brooding" class="section level4 hasAnchor" number="5.2.4.1">
<h4><span class="header-section-number">5.2.4.1</span> Step 1: brooding<a href="multiple3.html#step-1-brooding" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, use <code>brooding</code> to predict <code>wellbeing</code>. Use <code>lm()</code> and <code>glance()</code> to obtain the R<sup>2</sup> for the model, then use <code>lmBF()</code> to obtain the BF for the model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="multiple3.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in the step</span></span>
<span id="cb5-2"><a href="multiple3.html#cb5-2" aria-hidden="true" tabindex="-1"></a>step1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wellbeing <span class="sc">~</span> brooding, <span class="at">data =</span> pwb_data)</span>
<span id="cb5-3"><a href="multiple3.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="multiple3.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2^</span></span>
<span id="cb5-5"><a href="multiple3.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure the broom package loaded, i.e., with &#39;library(broom)&#39;</span></span>
<span id="cb5-6"><a href="multiple3.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step1)</span>
<span id="cb5-7"><a href="multiple3.html#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="multiple3.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb5-9"><a href="multiple3.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure the BayesFactor package is loaded, i.e., with &#39;library(BayesFactor)</span></span>
<span id="cb5-10"><a href="multiple3.html#cb5-10" aria-hidden="true" tabindex="-1"></a>BF_step1 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(wellbeing <span class="sc">~</span> brooding, <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb5-11"><a href="multiple3.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="multiple3.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># look at BF</span></span>
<span id="cb5-13"><a href="multiple3.html#cb5-13" aria-hidden="true" tabindex="-1"></a>BF_step1</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="9%" />
<col width="12%" />
<col width="7%" />
<col width="9%" />
<col width="9%" />
<col width="2%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">deviance</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.189052</td>
<td align="right">0.1763809</td>
<td align="right">11.4776</td>
<td align="right">14.91998</td>
<td align="right">0.0002642</td>
<td align="right">1</td>
<td align="right">-253.7007</td>
<td align="right">513.4014</td>
<td align="right">519.9704</td>
<td align="right">8431.064</td>
<td align="right">64</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
</div>
<pre><code>## Bayes factor analysis
## --------------
## [1] brooding : 95.76111 0%
## 
## Against denominator:
##   Intercept only 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The R<sup>2</sup> (non-adjusted, as a proportion, to 2 decimal places) for the model in Step 1 = <input class='webex-solveme nospaces' size='4' data-answer='["0.19"]'/>.</li>
<li>The BF for the model in Step 1 = <input class='webex-solveme nospaces' size='5' data-answer='["95.76"]'/></li>
</ul>
<p><br />
</p>
</div>
<div id="step-2-brooding-worry" class="section level4 hasAnchor" number="5.2.4.2">
<h4><span class="header-section-number">5.2.4.2</span> Step 2: brooding + worry<a href="multiple3.html#step-2-brooding-worry" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, add <code>worry</code> to the model in Step 1, using <code>+ worry</code> and look at R<sup>2</sup> again and obtain the BF. We'll look at:</p>
<ul>
<li>whether the model in Step 2 explains more variance in <code>wellbeing</code> by looking at the amount that R<sup>2</sup> increases.</li>
<li>whether there's evidence for a contribution of <code>worry</code> after controlling for <code>brooding</code>, by dividing the Bayes factor for the model in Step 2 by the BF for the model in Step 1</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="multiple3.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in the step</span></span>
<span id="cb7-2"><a href="multiple3.html#cb7-2" aria-hidden="true" tabindex="-1"></a>step2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry, <span class="at">data =</span> pwb_data)</span>
<span id="cb7-3"><a href="multiple3.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="multiple3.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb7-5"><a href="multiple3.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step2)</span>
<span id="cb7-6"><a href="multiple3.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="multiple3.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb7-8"><a href="multiple3.html#cb7-8" aria-hidden="true" tabindex="-1"></a>BF_step2 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry, <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb7-9"><a href="multiple3.html#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="multiple3.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in Step 2 and Step 1</span></span>
<span id="cb7-11"><a href="multiple3.html#cb7-11" aria-hidden="true" tabindex="-1"></a>BF_step2 <span class="sc">/</span> BF_step1</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="2%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">deviance</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3288693</td>
<td align="right">0.3075636</td>
<td align="right">10.52393</td>
<td align="right">15.43572</td>
<td align="right">3.5e-06</td>
<td align="right">2</td>
<td align="right">-247.4558</td>
<td align="right">502.9116</td>
<td align="right">511.6702</td>
<td align="right">6977.446</td>
<td align="right">63</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
</div>
<pre><code>## Bayes factor analysis
## --------------
## [1] brooding + worry : 56.11175 0%
## 
## Against denominator:
##   wellbeing ~ brooding 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The R<sup>2</sup> for the model in Step 2 is <input class='webex-solveme nospaces' size='4' data-answer='["0.33"]'/></li>
<li>The <em>increase</em> in R<sup>2</sup> associated with the addition of <code>worry</code> to the model is <input class='webex-solveme nospaces' size='4' data-answer='["0.14"]'/> <em>Hint. To calculate this, take the R<sup>2</sup> that you recorded before for the model in Step 2 and subtract the R<sup>2</sup> for the model in Step 1</em>.</li>
<li>The BF for the contribution of <code>worry</code> to the model is <input class='webex-solveme nospaces' size='5' data-answer='["56.11"]'/>. <em>Hint. This is the BF produced by dividing the BF for the model in Step 2, by the BF for the model in Step 1.</em></li>
</ul>
<div class="webex-solution">
<button>
calculatoR
</button>
<p>Did you know that R can function like a calculator too? Simply type the formula next to <code>&gt;</code> in the console window and hit enter, e.g., <code>&gt; 2 + 2</code></p>
<p>Or use code in your script:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="multiple3.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.33</span> <span class="sc">-</span> <span class="fl">0.19</span></span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Change in R-squared symbol
</button>
<p>In reports and articles, you will often see the change in R<sup>2</sup> written as <span class="math inline">\(\Delta R^2\)</span>. The <span class="math inline">\(\Delta\)</span> symbol means "change". For example <span class="math inline">\(\Delta R^2 = 0.33\)</span>.</p>
</div>
<p><br />
</p>
</div>
<div id="step-3-brooding-worry-mindfulness-variables" class="section level4 hasAnchor" number="5.2.4.3">
<h4><span class="header-section-number">5.2.4.3</span> Step 3: brooding + worry + mindfulness variables<a href="multiple3.html#step-3-brooding-worry-mindfulness-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, add the variables associated with mindfulness to the model. The mindfulness measures are <code>observing</code>, <code>describing</code>, <code>acting</code>, <code>nonjudging</code>, and <code>nonreactivity</code>. Add these five variables to the model all in the same step. As before, note R<sup>2</sup> for the model and the BF. To determine whether there's evidence for the addition of the mindfulness variables, compare the BF for the model in Step 3 and the BF of the model in Step 2.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="multiple3.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in the step</span></span>
<span id="cb10-2"><a href="multiple3.html#cb10-2" aria-hidden="true" tabindex="-1"></a>step3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb10-3"><a href="multiple3.html#cb10-3" aria-hidden="true" tabindex="-1"></a>             observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity, </span>
<span id="cb10-4"><a href="multiple3.html#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> pwb_data)</span>
<span id="cb10-5"><a href="multiple3.html#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="multiple3.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb10-7"><a href="multiple3.html#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step3)</span>
<span id="cb10-8"><a href="multiple3.html#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="multiple3.html#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb10-10"><a href="multiple3.html#cb10-10" aria-hidden="true" tabindex="-1"></a>BF_step3 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb10-11"><a href="multiple3.html#cb10-11" aria-hidden="true" tabindex="-1"></a>                   observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity, </span>
<span id="cb10-12"><a href="multiple3.html#cb10-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb10-13"><a href="multiple3.html#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="multiple3.html#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in step 3 and step 2</span></span>
<span id="cb10-15"><a href="multiple3.html#cb10-15" aria-hidden="true" tabindex="-1"></a>BF_step3 <span class="sc">/</span> BF_step2</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="2%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">deviance</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5330601</td>
<td align="right">0.4767053</td>
<td align="right">9.148738</td>
<td align="right">9.458999</td>
<td align="right">1e-07</td>
<td align="right">7</td>
<td align="right">-235.4846</td>
<td align="right">488.9692</td>
<td align="right">508.6761</td>
<td align="right">4854.566</td>
<td align="right">58</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
</div>
<pre><code>## Bayes factor analysis
## --------------
## [1] brooding + worry + observing + describing + acting + nonjudging + nonreactivity : 35.49308 0%
## 
## Against denominator:
##   wellbeing ~ brooding + worry 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The R<sup>2</sup> for the model in Step 3 is <input class='webex-solveme nospaces' size='4' data-answer='["0.53"]'/></li>
<li>The increase in R<sup>2</sup> associated with the addition of the mindfulness variables is <input class='webex-solveme nospaces' size='4' data-answer='["0.20"]'/> <em>Hint. Take the R<sup>2</sup> for the model in Step 3 and subtract the R<sup>2</sup> for the model in Step 2.</em></li>
<li>The BF for the contribution of the mindfulness variables to the model is <input class='webex-solveme nospaces' size='5' data-answer='["35.49"]'/> <em>Hint. This is the BF produced by dividing <code>BF_step3</code> by <code>BF_step2</code>.</em></li>
<li>After controlling for <code>brooding</code> and <code>worry</code>, is there sufficient evidence for the contribution of mindfulness to the prediction of <code>wellbeing</code>? <select class='webex-select'><option value='blank'></option><option value='answer'>yes, BF&gt;3</option><option value=''>no</option></select></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>The BF comparing the models in Steps 3 and 2 was BF = 34.59, indicating that the model in Step 3 is more than thirty five times more likely than the model in Step 2, given the data. Thus, there's substantial evidence that the mindfulness variables contribute to the prediction of <code>wellbeing</code> after controlling for <code>brooding</code> and <code>worry</code>. The mindfulness variables explain an additional R<sup>2</sup> = 0.20, or 20% of the variance in <code>wellbeing</code>, over and above <code>brooding</code> and <code>worry</code>.</p>
</div>
<p><br />
</p>
</div>
<div id="step-4-brooding-worry-mindfulness-emotional-intelligence-variables" class="section level4 hasAnchor" number="5.2.4.4">
<h4><span class="header-section-number">5.2.4.4</span> Step 4: brooding + worry + mindfulness + emotional intelligence variables<a href="multiple3.html#step-4-brooding-worry-mindfulness-emotional-intelligence-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, add the variables associated with emotional intelligence to the model. The emotional intelligence variables are <code>attention</code>, <code>clarity</code>, and <code>repair</code>. These three variables are added to the model all in the same step. Once again, note R<sup>2</sup> for the model and the BF. To determine whether there's evidence for the addition of the emotional intelligence variables, compare the BF for the model in Step 4 and the BF of the model in Step 3.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="multiple3.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in step 4</span></span>
<span id="cb12-2"><a href="multiple3.html#cb12-2" aria-hidden="true" tabindex="-1"></a>step4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb12-3"><a href="multiple3.html#cb12-3" aria-hidden="true" tabindex="-1"></a>              observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity <span class="sc">+</span> </span>
<span id="cb12-4"><a href="multiple3.html#cb12-4" aria-hidden="true" tabindex="-1"></a>              attention <span class="sc">+</span> clarity <span class="sc">+</span> repair, </span>
<span id="cb12-5"><a href="multiple3.html#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> pwb_data)</span>
<span id="cb12-6"><a href="multiple3.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="multiple3.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb12-8"><a href="multiple3.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step4)</span>
<span id="cb12-9"><a href="multiple3.html#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="multiple3.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb12-11"><a href="multiple3.html#cb12-11" aria-hidden="true" tabindex="-1"></a>BF_step4 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb12-12"><a href="multiple3.html#cb12-12" aria-hidden="true" tabindex="-1"></a>                   observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity <span class="sc">+</span> </span>
<span id="cb12-13"><a href="multiple3.html#cb12-13" aria-hidden="true" tabindex="-1"></a>                   attention <span class="sc">+</span> clarity <span class="sc">+</span> repair, </span>
<span id="cb12-14"><a href="multiple3.html#cb12-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb12-15"><a href="multiple3.html#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="multiple3.html#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in step 4 and step 3</span></span>
<span id="cb12-17"><a href="multiple3.html#cb12-17" aria-hidden="true" tabindex="-1"></a>BF_step4 <span class="sc">/</span> BF_step3</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="9%" />
<col width="12%" />
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="2%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">logLik</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">deviance</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6045859</td>
<td align="right">0.5326924</td>
<td align="right">8.645487</td>
<td align="right">8.409467</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">-229.9978</td>
<td align="right">483.9956</td>
<td align="right">510.2715</td>
<td align="right">4110.944</td>
<td align="right">55</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
</div>
<pre><code>## Bayes factor analysis
## --------------
## [1] brooding + worry + observing + describing + acting + nonjudging + nonreactivity + attention + clarity + repair : 2.150042 0%
## 
## Against denominator:
##   wellbeing ~ brooding + worry + observing + describing + acting + nonjudging + nonreactivity 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The R<sup>2</sup> for the model in Step 4 is <input class='webex-solveme nospaces' data-tol='0.01' size='3' data-answer='["0.6",".6"]'/></li>
<li>The increase in R<sup>2</sup> associated with the addition of the emotional intelligence variables is <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["0.07",".07"]'/> <em>Hint. Take the R<sup>2</sup> for the model in Step 4 and subtract the R<sup>2</sup> for the model in Step 3.</em></li>
<li>The BF representing the evidence for the unique contribution of the emotional intelligence variables to the model is <input class='webex-solveme nospaces' size='4' data-answer='["2.15"]'/></li>
<li>After controlling for <code>brooding</code>, <code>worry</code>, and mindfulness, is there sufficient evidence for the contribution of emotional intelligence to the prediction of <code>wellbeing</code>? <select class='webex-select'><option value='blank'></option><option value=''>yes, BF &gt; 3</option><option value='answer'>no, BF &lt; 3</option></select></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>The BF comparing the models in steps 4 and 3 was BF = 2.15. Although this indicates that the model in Step 4 is more than twice as likely than the model in Step 3, given the data, the BF is less than 3, and therefore falls short of the conventional level for declaring that there's substantial evidence for the addition of emotional intelligence. Thus, according to this Bayes factor analysis, there's insufficient evidence that the additional R<sup>2</sup> = 0.07, or 7%, of the variance in <code>wellbeing</code> explained by emotional intelligence represents a genuine improvement in prediction.</p>
</div>
<p><br />
</p>
<p><br />
</p>
</div>
</div>
</div>
<div id="exercise-1-1" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Exercise 1<a href="multiple3.html#exercise-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-2" class="exercise"><strong>Exercise 5.2  </strong></span>Hierarchical regression</p>
<p>Iani et al. (2019) were also interested in whether whether mindfulness and emotional intelligence predicted <code>gad</code> (anxiety symptoms) after controlling for <code>brooding</code> and <code>worry</code>.</p>
<p>Repeat the analysis conducted above, but now with <code>gad</code> as the outcome variable.</p>
<ul>
<li>Step 1: <code>brooding</code></li>
<li>Step 2: <code>brooding</code>, <code>worry</code></li>
<li>Step 3: <code>brooding</code>, <code>worry</code> and mindfulness variables (<code>describing</code>, <code>observing</code>, <code>acting</code>, <code>nonreactivity</code>, <code>nonjudging</code>)</li>
<li>Step 4: <code>brooding</code>, <code>worry</code>, mindfulness variables (<code>describing</code>, <code>observing</code>, <code>acting</code>, <code>nonreactivity</code>, <code>nonjudging</code>), and emotional intelligence variables (<code>attention</code>, <code>clarity</code>, <code>repair</code>).</li>
</ul>
<p><strong>Step 1: brooding</strong></p>
<ul>
<li>The R<sup>2</sup> (non-adjusted, to two decimal places) for the model in Step 1 = <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["0.36",".36"]'/></li>
<li>The BF for the model in Step 1 = <input class='webex-solveme nospaces' data-tol='0.5' size='8' data-answer='["138455.1"]'/></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Rounding can sometimes be unclear when the last digit ends in a 5, and you are unsure of the precision to which something has been printed in the output R gives.</p>
<p>If in doubt, it's better to round from the more precise value. For R<sup>2</sup>, this can be obtained as follows from the glance function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="multiple3.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show R-squared to more decimal places, </span></span>
<span id="cb14-2"><a href="multiple3.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># by calling value from function specifically</span></span>
<span id="cb14-3"><a href="multiple3.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(gad1)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="multiple3.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in step 1, store in gad1</span></span>
<span id="cb15-2"><a href="multiple3.html#cb15-2" aria-hidden="true" tabindex="-1"></a>gad1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gad <span class="sc">~</span> brooding, <span class="at">data =</span> pwb_data)</span>
<span id="cb15-3"><a href="multiple3.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="multiple3.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb15-5"><a href="multiple3.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(gad1)</span>
<span id="cb15-6"><a href="multiple3.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="multiple3.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># store BF</span></span>
<span id="cb15-8"><a href="multiple3.html#cb15-8" aria-hidden="true" tabindex="-1"></a>BF_gad1 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(gad <span class="sc">~</span> brooding, <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb15-9"><a href="multiple3.html#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="multiple3.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># show BF</span></span>
<span id="cb15-11"><a href="multiple3.html#cb15-11" aria-hidden="true" tabindex="-1"></a>BF_gad1</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Step 2: brooding + worry</strong></p>
<ul>
<li>The R<sup>2</sup> for the model in Step 2 is <input class='webex-solveme nospaces' size='4' data-answer='["0.45"]'/></li>
<li>The increase in R<sup>2</sup> associated with the addition of <code>worry</code> is <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["0.08",".08"]'/></li>
<li>The BF for the contribution of <code>worry</code> to the model is <input class='webex-solveme nospaces' data-tol='0.03' size='5' data-answer='["12.66"]'/></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Next, add <code>worry</code> to the model, using <code>+ worry</code>. Look at R<sup>2</sup> again and obtain the BF.</p>
<ul>
<li>To determine the R<sup>2</sup> change for the model, take the R<sup>2</sup> for the model in Step 2 and subtract the R<sup>2</sup> value for the model in Step 1.</li>
<li>To determine whether there's evidence for a contribution of <code>worry</code> after controlling for <code>brooding</code>, divide the Bayes factor for the model by the BF for the model in Step 1.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="multiple3.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in Step 2</span></span>
<span id="cb16-2"><a href="multiple3.html#cb16-2" aria-hidden="true" tabindex="-1"></a>gad2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry, <span class="at">data =</span> pwb_data)</span>
<span id="cb16-3"><a href="multiple3.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="multiple3.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R sq</span></span>
<span id="cb16-5"><a href="multiple3.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(gad2)</span>
<span id="cb16-6"><a href="multiple3.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="multiple3.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb16-8"><a href="multiple3.html#cb16-8" aria-hidden="true" tabindex="-1"></a>BF_gad2 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry, <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb16-9"><a href="multiple3.html#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="multiple3.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in Step 2 and Step 1</span></span>
<span id="cb16-11"><a href="multiple3.html#cb16-11" aria-hidden="true" tabindex="-1"></a>BF_gad2 <span class="sc">/</span> BF_gad1</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Step 3: brooding + worry + mindfulness variables</strong></p>
<ul>
<li>The R<sup>2</sup> for the model in Step 3 is <input class='webex-solveme nospaces' size='4' data-answer='["0.48"]'/></li>
<li>The increase in R<sup>2</sup> associated with the addition of the mindfulness variables is <input class='webex-solveme nospaces' size='4' data-answer='["0.03"]'/></li>
<li>The BF for the contribution of the mindfulness variables to the model is <input class='webex-solveme nospaces' size='5' data-answer='["0.006","0.01"]'/></li>
<li>After controlling for <code>brooding</code> and <code>worry</code>, is there sufficient evidence for the contribution of mindfulness to the prediction of <code>gad</code>? <select class='webex-select'><option value='blank'></option><option value=''>yes</option><option value='answer'>no</option></select></li>
<li>There's <select class='webex-select'><option value='blank'></option><option value='answer'>substantial</option><option value=''>inconclusive</option></select> evidence for the model in Step 2, compared to Step 3, because the Bayes factor for the model in Step 3 divided by that of the model in Step 2 is <select class='webex-select'><option value='blank'></option><option value='answer'>less than 0.33</option><option value=''>equal to 1</option><option value=''>greater than 3</option></select>.</li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Add the variables associated with mindfulness to the model. The mindfulness measures are <code>observing</code>, <code>describing</code>, <code>acting</code>, <code>nonjudging</code>, and <code>nonreactivity</code>. These five variables are added to the model all in the same step.</p>
<ul>
<li>To calculate the increase in R<sup>2</sup>, take the R<sup>2</sup> for the model in Step 3 and subtract the R<sup>2</sup> for the model in Step 2.</li>
<li>To obtain the BF for the contribution of the mindfulness variables, take the BF for the model in Step 3 and divide it by the BF for the model in Step 2.</li>
<li>If the BF is greater than 3, there's substantial evidence for the model in Step 3. If the BF &lt; 0.33, then there's substantial evidence for the model in Step 2. Intermediate BFs are inconclusive.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="multiple3.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in Step 3</span></span>
<span id="cb17-2"><a href="multiple3.html#cb17-2" aria-hidden="true" tabindex="-1"></a>gad3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb17-3"><a href="multiple3.html#cb17-3" aria-hidden="true" tabindex="-1"></a>              observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> </span>
<span id="cb17-4"><a href="multiple3.html#cb17-4" aria-hidden="true" tabindex="-1"></a>              nonjudging <span class="sc">+</span> nonreactivity, </span>
<span id="cb17-5"><a href="multiple3.html#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> pwb_data)</span>
<span id="cb17-6"><a href="multiple3.html#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="multiple3.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb17-8"><a href="multiple3.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(gad3)</span>
<span id="cb17-9"><a href="multiple3.html#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="multiple3.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb17-11"><a href="multiple3.html#cb17-11" aria-hidden="true" tabindex="-1"></a>BF_gad3 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb17-12"><a href="multiple3.html#cb17-12" aria-hidden="true" tabindex="-1"></a>                   observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> </span>
<span id="cb17-13"><a href="multiple3.html#cb17-13" aria-hidden="true" tabindex="-1"></a>                   nonjudging <span class="sc">+</span> nonreactivity, </span>
<span id="cb17-14"><a href="multiple3.html#cb17-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb17-15"><a href="multiple3.html#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="multiple3.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in Step 3 and Step 2</span></span>
<span id="cb17-17"><a href="multiple3.html#cb17-17" aria-hidden="true" tabindex="-1"></a>BF_gad3 <span class="sc">/</span> BF_gad2</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Step 4: brooding + worry + mindfulness + emotional intelligence variables</strong></p>
<ul>
<li>The R<sup>2</sup> for the model in Step 4 is <input class='webex-solveme nospaces' size='4' data-answer='["0.55"]'/></li>
<li>The increase in R<sup>2</sup> associated with the addition of the emotional intelligence variables to the model is <input class='webex-solveme nospaces' size='4' data-answer='["0.07"]'/>.</li>
<li>The BF associated with the contribution of the emotional intelligence variables to the model is <input class='webex-solveme nospaces' size='4' data-answer='["1.33"]'/></li>
<li>After controlling for <code>brooding</code>, <code>worry</code>, and mindfulness, is there sufficient evidence for the contribution of emotional intelligence to the prediction of <code>gad</code>? <select class='webex-select'><option value='blank'></option><option value=''>yes</option><option value='answer'>no</option></select></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Add the variables associated with emotional intelligence to the model. The emotional intelligence measures are <code>attention</code>, <code>clarity</code>, and <code>repair</code>. These three variables are added to the model all in the same step.</p>
<ul>
<li>To calculate the increase in R<sup>2</sup>, take the R<sup>2</sup> for the model in Step 4 and subtract the R<sup>2</sup> for the model in Step 3.</li>
<li>To obtain the BF for the contribution of the emotional intelligence variables, take the BF for the model in Step 4 and divide it by the BF for the model in Step 3.</li>
<li>If the BF is greater than 3, there's substantial evidence for the model in Step 4. If the BF &lt; 0.33, then there's substantial evidence for the model in Step 3. Intermediate BFs are inconclusive.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="multiple3.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model in Step 4</span></span>
<span id="cb18-2"><a href="multiple3.html#cb18-2" aria-hidden="true" tabindex="-1"></a>gad4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb18-3"><a href="multiple3.html#cb18-3" aria-hidden="true" tabindex="-1"></a>                  observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity <span class="sc">+</span> </span>
<span id="cb18-4"><a href="multiple3.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                  attention <span class="sc">+</span> clarity <span class="sc">+</span> repair, </span>
<span id="cb18-5"><a href="multiple3.html#cb18-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> pwb_data)</span>
<span id="cb18-6"><a href="multiple3.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="multiple3.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb18-8"><a href="multiple3.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(gad4)</span>
<span id="cb18-9"><a href="multiple3.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="multiple3.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># store the BF</span></span>
<span id="cb18-11"><a href="multiple3.html#cb18-11" aria-hidden="true" tabindex="-1"></a>BF_gad4 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(gad <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb18-12"><a href="multiple3.html#cb18-12" aria-hidden="true" tabindex="-1"></a>                       observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity <span class="sc">+</span></span>
<span id="cb18-13"><a href="multiple3.html#cb18-13" aria-hidden="true" tabindex="-1"></a>                       attention <span class="sc">+</span> clarity <span class="sc">+</span> repair, </span>
<span id="cb18-14"><a href="multiple3.html#cb18-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> <span class="fu">data.frame</span>(pwb_data))</span>
<span id="cb18-15"><a href="multiple3.html#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="multiple3.html#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the BFs for the models in Step 3 and Step 2</span></span>
<span id="cb18-17"><a href="multiple3.html#cb18-17" aria-hidden="true" tabindex="-1"></a>BF_gad4 <span class="sc">/</span> BF_gad3</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>In summary, regarding the hypothesis of Iani et al. (2019):</strong></p>
<ul>
<li>After controlling for <code>brooding</code> and <code>worry</code>, there's evidence for the contribution of mindfulness and emotional intelligence to the prediction of <code>gad</code>. <select class='webex-select'><option value='blank'></option><option value='answer'>no</option><option value=''>yes</option></select></li>
</ul>
</div>
<p><br />
</p>
</div>
<div id="worked-exercise-2-controlling-for-categorical-variables" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Worked Exercise 2: Controlling for categorical variables<a href="multiple3.html#worked-exercise-2-controlling-for-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All of the variables considered in the previous exercise were continuous (or at were least assumed to be). It is also possible to use hierarchical regression to control for the influence of variables that are <em>categorical</em> in nature.</p>
<p>How do human-animal relationships affect mental health? Ratschen et al. (2020) looked at the impact of relationships with animals (e.g., pets) on mental health and loneliness in individuals during the Covid-19 pandemic.</p>
<p>Data from their study are located at the link below.</p>
<p><a href="https://raw.githubusercontent.com/chrisjberry/Teaching/master/5_animal_data.csv" class="uri">https://raw.githubusercontent.com/chrisjberry/Teaching/master/5_animal_data.csv</a></p>
<div class="webex-solution">
<button>
More on the data
</button>
<p>The data are publicly available and variable names have been changed here for clarity. Missing data have been dealt with differently to the way the researchers dealt with them, so the data you are analysing (and therefore the results) are not identical to theirs.</p>
</div>
<p><br />
</p>
<p>About the data:</p>
<ul>
<li><code>comfort</code>: Comfort from companion animals. Higher scores indicate greater comfort from the companion animal.</li>
<li><code>mental_health_pre</code>: Mental health before lockdown. Higher scores indicate better mental health.</li>
<li><code>mental_health_since</code>: Mental health during lockdown. Higher scores indicate better mental health.</li>
<li><code>wellbeing_since</code>: Higher scores indicate better wellbeing.</li>
<li><code>gender</code>: Male, female, another option, or prefer not to say</li>
<li><code>age</code>: Age group.</li>
<li><code>partner</code>: Whether the participant lives with their partner or not.</li>
<li><code>species</code>: The type of animal companion.</li>
<li><code>loneliness_pre</code>: Loneliness before lockdown. Higher scores indicate greater loneliness.</li>
<li><code>loneliness_since</code>: Loneliness during lockdown. Higher scores indicate greater loneliness.</li>
</ul>
<p><br />
</p>
<div id="visualisation-1" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Visualisation<a href="multiple3.html#visualisation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inspect the distributions of the continuous variables:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="multiple3.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data</span></span>
<span id="cb19-2"><a href="multiple3.html#cb19-2" aria-hidden="true" tabindex="-1"></a>animal_data <span class="ot">&lt;-</span> </span>
<span id="cb19-3"><a href="multiple3.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/5_animal_data.csv&#39;</span>)</span>
<span id="cb19-4"><a href="multiple3.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="multiple3.html#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="multiple3.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot density plots of all the numeric (continuous) variables</span></span>
<span id="cb19-7"><a href="multiple3.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The code below:</span></span>
<span id="cb19-8"><a href="multiple3.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># -Keeps only the numeric columns in a data frame</span></span>
<span id="cb19-9"><a href="multiple3.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses pivot_longer() to code each set of scores by its variable name</span></span>
<span id="cb19-10"><a href="multiple3.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># -Specifies the &#39;score&#39; to plot in aes()</span></span>
<span id="cb19-11"><a href="multiple3.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses facet_wrap() to plot each variable in a separate panel</span></span>
<span id="cb19-12"><a href="multiple3.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses scales = &quot;free&quot; to allow the range on the x- and y-axis to be different across panels</span></span>
<span id="cb19-13"><a href="multiple3.html#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="multiple3.html#cb19-14" aria-hidden="true" tabindex="-1"></a>animal_data <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="multiple3.html#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.numeric) <span class="sc">%&gt;%</span>                     </span>
<span id="cb19-16"><a href="multiple3.html#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb19-17"><a href="multiple3.html#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(score)) <span class="sc">+</span>     </span>
<span id="cb19-18"><a href="multiple3.html#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>     </span>
<span id="cb19-19"><a href="multiple3.html#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()            </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="05_multiple_regression_3_files/figure-html/unnamed-chunk-16-1.png" alt="Histogram plots for each continous predictor" width="100%" />
<p class="caption">
Figure 5.2: Histogram plots for each continous predictor
</p>
</div>
<p><br />
</p>
<p>The code can be modified to obtain histograms of all of the categorical variables:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="multiple3.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histograms of all the categorical vars (i.e., count data)</span></span>
<span id="cb20-2"><a href="multiple3.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The code:</span></span>
<span id="cb20-3"><a href="multiple3.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -Keeps only the character columns in the dataset</span></span>
<span id="cb20-4"><a href="multiple3.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses pivot_longer() to code each set of scores by variable</span></span>
<span id="cb20-5"><a href="multiple3.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -Specifies the &#39;score&#39; to plot in aes()</span></span>
<span id="cb20-6"><a href="multiple3.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># -Uses facet_wrap() to plot in separate panels</span></span>
<span id="cb20-7"><a href="multiple3.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># -Tells geom_histogram() to plot count data </span></span>
<span id="cb20-8"><a href="multiple3.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="multiple3.html#cb20-9" aria-hidden="true" tabindex="-1"></a>animal_data <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="multiple3.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">keep</span>(is.character)  <span class="sc">%&gt;%</span> </span>
<span id="cb20-11"><a href="multiple3.html#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb20-12"><a href="multiple3.html#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(score)) <span class="sc">+</span>     </span>
<span id="cb20-13"><a href="multiple3.html#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>     </span>
<span id="cb20-14"><a href="multiple3.html#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>)        </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="05_multiple_regression_3_files/figure-html/unnamed-chunk-17-1.png" alt="Histograms for each categorical predictor" width="100%" />
<p class="caption">
Figure 5.3: Histograms for each categorical predictor
</p>
</div>
<p>By looking at the histograms of the categorical variables, answer the following:</p>
<ul>
<li>Age: The majority of people were in age group <select class='webex-select'><option value='blank'></option><option value=''>18_24</option><option value=''>25_34</option><option value=''>35_44</option><option value='answer'>45_54</option><option value=''>55_64</option><option value=''>65_70</option><option value=''>70_over</option></select></li>
<li>Gender: The majority of people were <select class='webex-select'><option value='blank'></option><option value=''>in another way</option><option value='answer'>female</option><option value=''>male</option><option value=''>prefer not to say</option></select></li>
<li>Partner: The majority of people were <select class='webex-select'><option value='blank'></option><option value='answer'>living with partner</option><option value=''>not_living_with_partner</option></select></li>
<li>Species: The most common animal companion was <select class='webex-select'><option value='blank'></option><option value=''>bird</option><option value=''>cat</option><option value='answer'>dog</option><option value=''>fish</option><option value=''>horse</option><option value=''>other</option><option value=''>reptile</option><option value=''>small</option></select></li>
</ul>
<p><br />
</p>
<p>The scores on the <code>loneliness_pre</code> variable range from 3 to 9, so there are only 7 possible scores. When there are many data points, this can create issues when visualising the variable in a scatterplot because there are only so many combinations of scores for the variable, so they overlap.</p>
<p>The code below uses the <code>gridExtra</code> package to display two plots created with <code>ggplot()</code>. Each plot is stored in a separate variable <code>panel1</code> and <code>panel2</code>, then placed side-by-side using <code>grid.arrange()</code> from the <code>gridExtra</code> package:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="multiple3.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library(gridExtra)</span></span>
<span id="cb21-2"><a href="multiple3.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for displaying different plots on multiple panels</span></span>
<span id="cb21-3"><a href="multiple3.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb21-4"><a href="multiple3.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="multiple3.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatterplot of loneliness scores</span></span>
<span id="cb21-6"><a href="multiple3.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># without random jittering of points</span></span>
<span id="cb21-7"><a href="multiple3.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># store in panel1</span></span>
<span id="cb21-8"><a href="multiple3.html#cb21-8" aria-hidden="true" tabindex="-1"></a>panel1 <span class="ot">&lt;-</span> </span>
<span id="cb21-9"><a href="multiple3.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  animal_data <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="multiple3.html#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>loneliness_pre, <span class="at">y =</span> loneliness_since)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="multiple3.html#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="multiple3.html#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb21-13"><a href="multiple3.html#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Without geom_jitter()&quot;</span>)</span>
<span id="cb21-14"><a href="multiple3.html#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="multiple3.html#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatterplot of loneliness scores</span></span>
<span id="cb21-16"><a href="multiple3.html#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># with random jittering of points using geom_jitter()</span></span>
<span id="cb21-17"><a href="multiple3.html#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># store in panel2</span></span>
<span id="cb21-18"><a href="multiple3.html#cb21-18" aria-hidden="true" tabindex="-1"></a>panel2 <span class="ot">&lt;-</span> </span>
<span id="cb21-19"><a href="multiple3.html#cb21-19" aria-hidden="true" tabindex="-1"></a>  animal_data <span class="sc">%&gt;%</span> </span>
<span id="cb21-20"><a href="multiple3.html#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>loneliness_pre, <span class="at">y =</span> loneliness_since)) <span class="sc">+</span></span>
<span id="cb21-21"><a href="multiple3.html#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb21-22"><a href="multiple3.html#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F)<span class="sc">+</span></span>
<span id="cb21-23"><a href="multiple3.html#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;With geom_jitter()&quot;</span>)</span>
<span id="cb21-24"><a href="multiple3.html#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="multiple3.html#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(panel1, panel2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="05_multiple_regression_3_files/figure-html/unnamed-chunk-18-1.png" alt="Using geom_jitter(): loneliness_since vs. londliness_pre" width="100%" />
<p class="caption">
Figure 5.4: Using geom_jitter(): loneliness_since vs. londliness_pre
</p>
</div>
<p>Using <code>geom_jitter()</code> instead of <code>geom_point()</code> means that the scores will be randomly jittered by a tiny amount. This reduces overlap, making it much easier to see how the scores are distributed. It's useful to use <code>geom_jitter()</code> when the response variable is on an ordinal scale, but the responses are discrete (e.g., 1, 2, 3, 4, 5), as is often the case with survey data and likert scales. Thus, if you ever create a scatterplot of survey data and it ends up looking like the plot on the left, try using <code>geom_jitter()</code> instead of <code>geom_point()</code>.</p>
<p><br />
</p>
<p>The next step isn't strictly necessary because the categorical variables are stored as character variables (i.e., <code>&lt;chr&gt;</code>), but it is good practice to convert the categorical variables to <code>factors</code> before the analysis.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="multiple3.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical variables to factors</span></span>
<span id="cb22-2"><a href="multiple3.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (remember, age is grouped, so is categorical here)</span></span>
<span id="cb22-3"><a href="multiple3.html#cb22-3" aria-hidden="true" tabindex="-1"></a>animal_data <span class="ot">&lt;-</span> </span>
<span id="cb22-4"><a href="multiple3.html#cb22-4" aria-hidden="true" tabindex="-1"></a>  animal_data <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="multiple3.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb22-6"><a href="multiple3.html#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> <span class="fu">factor</span>(age),</span>
<span id="cb22-7"><a href="multiple3.html#cb22-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">partner =</span> <span class="fu">factor</span>(partner),</span>
<span id="cb22-8"><a href="multiple3.html#cb22-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">species =</span> <span class="fu">factor</span>(species))</span></code></pre></div>
</div>
</div>
<div id="exercise-2" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercise 2<a href="multiple3.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Exercise 5.3  </strong></span>Hierarchical regression</p>
<p>Using the <code>animal_data</code>, we'll look at whether <code>comfort</code> scores predict <code>mental_health_pre</code> after controlling for <code>gender</code>, <code>age</code>, <code>partner</code>, <code>species</code> and <code>loneliness_pre</code>.</p>
<ul>
<li>How many steps do you think there'll be in the hierarchical regression analyses? <select class='webex-select'><option value='blank'></option><option value=''>1</option><option value='answer'>2</option><option value=''>3</option><option value=''>4</option><option value=''>5</option><option value=''>6</option><option value=''>7</option></select></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>The variables we want to control for can go into the model in the Step 1. Then we can add <code>comfort</code> to the model in Step 2, to see whether it explains <code>mental_health_pre</code> over and above all the variables in Step 1.</p>
</div>
<p><br />
</p>
<ul>
<li>How many participants are in this dataset? <input class='webex-solveme nospaces' size='4' data-answer='["4947"]'/></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>The number of participants is the same as the number of rows. One way of checking is as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="multiple3.html#cb23-1" aria-hidden="true" tabindex="-1"></a>animal_data <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code></pre></div>
</div>
<p><br />
</p>
<p>The variables that are controlled for in a multiple regression are sometimes called <strong>covariates</strong></p>
<p><br />
</p>
<p><strong>Step 1: Covariates only</strong></p>
<ul>
<li>R<sup>2</sup> for the model containing the covariates only is <input class='webex-solveme nospaces' size='5' data-answer='["0.119"]'/> (to <strong>three</strong> decimal places; this level of precision is required for this answer)</li>
<li>The BF for the model containing the covariates only is <select class='webex-select'><option value='blank'></option><option value=''>&lt; 0.33</option><option value=''>between 0.33 and 3</option><option value='answer'>&gt; 10000</option></select></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Run a regression to predict <code>mental_health_pre</code> from the covariates only. The covariates are the things we want to control for, and are <code>gender</code>, <code>age</code>, <code>partner</code>, <code>species</code> and <code>loneliness_pre</code>.</p>
<ul>
<li>Obtain R<sup>2</sup> for the model using <code>glance()</code> in the <code>broom</code> package.</li>
<li>Obtain the BF for the model using <code>lmBF()</code> in the <code>BayesFactor</code> package.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="multiple3.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store model with covariates only</span></span>
<span id="cb24-2"><a href="multiple3.html#cb24-2" aria-hidden="true" tabindex="-1"></a>step1_covariates <span class="ot">&lt;-</span> </span>
<span id="cb24-3"><a href="multiple3.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mental_health_pre <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> partner <span class="sc">+</span> species <span class="sc">+</span> loneliness_pre,</span>
<span id="cb24-4"><a href="multiple3.html#cb24-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> animal_data)</span>
<span id="cb24-5"><a href="multiple3.html#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="multiple3.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb24-7"><a href="multiple3.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step1_covariates)</span>
<span id="cb24-8"><a href="multiple3.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="multiple3.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the BF</span></span>
<span id="cb24-10"><a href="multiple3.html#cb24-10" aria-hidden="true" tabindex="-1"></a>BF_step1_covariates <span class="ot">&lt;-</span> </span>
<span id="cb24-11"><a href="multiple3.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmBF</span>(mental_health_pre <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> partner <span class="sc">+</span> species <span class="sc">+</span> loneliness_pre, </span>
<span id="cb24-12"><a href="multiple3.html#cb24-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> <span class="fu">data.frame</span>(animal_data))</span>
<span id="cb24-13"><a href="multiple3.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="multiple3.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View the BF for step 1</span></span>
<span id="cb24-15"><a href="multiple3.html#cb24-15" aria-hidden="true" tabindex="-1"></a>BF_step1_covariates</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>Step 2: Covariates plus comfort</strong></p>
<ul>
<li>The R<sup>2</sup> for the model with the covariates and the <code>comfort</code> predictor is <input class='webex-solveme nospaces' size='5' data-answer='["0.121"]'/> (report to <strong>three</strong> decimal places)</li>
<li>The <em>increase</em> in R<sup>2</sup> as a result of the addition of <code>comfort</code> to the model with the covariates is <input class='webex-solveme nospaces' size='5' data-answer='["0.002"]'/> <em>Hint: subtract the R<sup>2</sup> for Step 1 from that of Step 2. It's necessary to use the R<sup>2</sup> values to three decimal places because the increase is so small!</em></li>
<li>The Bayes factor for the comparison of the model in Step 2 and Step 1 is <select class='webex-select'><option value='blank'></option><option value=''>&lt; 0.33</option><option value=''>between 0.33 and 3</option><option value='answer'>&gt; 3</option></select></li>
<li>Is there sufficient evidence that comfort from animal companions explains mental health levels before lockdown, after controlling for <code>gender</code>, <code>age</code>, <code>partner</code>, <code>species</code> of animal, and <code>loneliness_pre</code>? <select class='webex-select'><option value='blank'></option><option value=''>no, BF &lt; 0.33</option><option value=''>no, BF between 0.33 and 3</option><option value='answer'>yes, BF &gt; 3</option></select></li>
<li>Individuals who reported deriving greater comfort from animals also tended to have <select class='webex-select'><option value='blank'></option><option value=''>higher</option><option value='answer'>lower</option></select> levels of mental health, as measured before lockdown.</li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<p>Run a regression to predict <code>mental_health_pre</code> from the covariates and <code>comfort</code>. The covariates are the things we want to control for, and are <code>gender</code>, <code>age</code>, <code>partner</code>, <code>species</code> and <code>loneliness_pre</code>.</p>
<ul>
<li>Obtain R<sup>2</sup> for the model using <code>glance()</code> in the <code>broom</code> package.</li>
<li>Obtain the BF for the model using <code>lmBF()</code> in the <code>BayesFactor</code> package.</li>
<li>Calculate the difference in R<sup>2</sup> for the model in Step 2 and the model in Step 1</li>
<li>Divide the BF for the model in Step 2 by the BF for the model in Step 1 to obtain the BF representing the evidence for the contribution of <code>comfort</code> to the model, after controlling for the covariates.</li>
<li>To determine whether the association between <code>comfort</code> and <code>mental_health_pre</code> is positive or negative, look at the sign on the coefficient for <code>comfort</code> by using <code>step2_full</code>.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="multiple3.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariates + comfort</span></span>
<span id="cb25-2"><a href="multiple3.html#cb25-2" aria-hidden="true" tabindex="-1"></a>step2_full <span class="ot">&lt;-</span> </span>
<span id="cb25-3"><a href="multiple3.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(mental_health_pre <span class="sc">~</span> comfort <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> partner <span class="sc">+</span> species <span class="sc">+</span> loneliness_pre, </span>
<span id="cb25-4"><a href="multiple3.html#cb25-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> animal_data)</span>
<span id="cb25-5"><a href="multiple3.html#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="multiple3.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R-sq</span></span>
<span id="cb25-7"><a href="multiple3.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(step2_full) </span>
<span id="cb25-8"><a href="multiple3.html#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="multiple3.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># store BF</span></span>
<span id="cb25-10"><a href="multiple3.html#cb25-10" aria-hidden="true" tabindex="-1"></a>BF_step2_full <span class="ot">&lt;-</span> </span>
<span id="cb25-11"><a href="multiple3.html#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmBF</span>(mental_health_pre <span class="sc">~</span> comfort <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> partner <span class="sc">+</span> species <span class="sc">+</span> loneliness_pre, </span>
<span id="cb25-12"><a href="multiple3.html#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> <span class="fu">data.frame</span>(animal_data))</span>
<span id="cb25-13"><a href="multiple3.html#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="multiple3.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># evidence for comfort, controlling for covariates</span></span>
<span id="cb25-15"><a href="multiple3.html#cb25-15" aria-hidden="true" tabindex="-1"></a>BF_step2_full <span class="sc">/</span> BF_step1_covariates</span>
<span id="cb25-16"><a href="multiple3.html#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="multiple3.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the sign on the coefficient for comfort</span></span>
<span id="cb25-18"><a href="multiple3.html#cb25-18" aria-hidden="true" tabindex="-1"></a>step2_full</span></code></pre></div>
</div>
</div>
<p><br />
</p>
</div>
<div id="further-knowledge-and-exercises" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Further knowledge and exercises<a href="multiple3.html#further-knowledge-and-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="standardised-coefficients" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Standardised Coefficients<a href="multiple3.html#standardised-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class='webex-solution'>
<button>
Standardised coefficients
</button>
<p>Iani et al. (2019) also reported the values of the coefficients for the predictors at each step (see their Table 2).</p>
<p>When a multiple regression has been performed using the raw data, the coefficients given by <code>lm()</code> are <strong>unstandardised</strong>. This means that they are in the same units as the predictor variable they correspond to. For example, if the coefficient for <code>brooding</code> is -1.57, this means that a 1 unit increase in <code>brooding</code> score is associated with a 1.57 <em>decrease</em> in <code>wellbeing</code> score.</p>
<p>We'd like to be able to compare the coefficients of predictors to get some idea of their relative strength of the contribution to the model. The trouble is that predictors are often measured on different scales, with different ranges. For example, scores of <code>brooding</code> range from 5 to 20, and those of <code>clarity</code> range from 10 to 40. Use <code>summary(pwb_data)</code> to see this. Because the scales are so different, it doesn't make sense to directly compare the coefficients of the predictors.</p>
<div class="tip">
<p>To compare the coefficients of predictor variables in a model, we need to compare the <strong>standardised regression coefficients</strong>. These are the coefficients derived from the data after the scores of each predictor have been standardised. To standardise the scores of a variable, subtract the mean value from each score, and then divide each score by the standard deviation of the scores. The transformed scores will have a mean of zero and standard deviation of 1, and so will all be on the same scale. The <code>scale()</code> function does this automatically for us.</p>
</div>
<p><br />
</p>
<p>To standardise all the numeric variables in the <code>pwb_data</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="multiple3.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the result in std_pwb_data</span></span>
<span id="cb26-2"><a href="multiple3.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Take pwb_data, pipe it to</span></span>
<span id="cb26-3"><a href="multiple3.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate_if().</span></span>
<span id="cb26-4"><a href="multiple3.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell mutate_if() to standardise a column</span></span>
<span id="cb26-5"><a href="multiple3.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># using &#39;scale&#39; if the variable type &#39;is.numeric&#39;</span></span>
<span id="cb26-6"><a href="multiple3.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (note, it&#39;s not possible to standardise non-numeric variables)</span></span>
<span id="cb26-7"><a href="multiple3.html#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="multiple3.html#cb26-8" aria-hidden="true" tabindex="-1"></a>std_pwb_data <span class="ot">&lt;-</span></span>
<span id="cb26-9"><a href="multiple3.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  pwb_data <span class="sc">%&gt;%</span> </span>
<span id="cb26-10"><a href="multiple3.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, scale)</span></code></pre></div>
<p><br />
</p>
<p>Let's compare the mean and standard deviation before and after standardising the scores:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="multiple3.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use summarise() and across() to obtain </span></span>
<span id="cb27-2"><a href="multiple3.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the mean and sd of each column</span></span>
<span id="cb27-3"><a href="multiple3.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># see ?summarise()</span></span>
<span id="cb27-4"><a href="multiple3.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see ?across()</span></span>
<span id="cb27-5"><a href="multiple3.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="multiple3.html#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="multiple3.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># before standardising</span></span>
<span id="cb27-8"><a href="multiple3.html#cb27-8" aria-hidden="true" tabindex="-1"></a>pwb_data <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="multiple3.html#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb27-10"><a href="multiple3.html#cb27-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd))) <span class="sc">%&gt;%</span> </span>
<span id="cb27-11"><a href="multiple3.html#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb27-12"><a href="multiple3.html#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="multiple3.html#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="multiple3.html#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># after standardising</span></span>
<span id="cb27-15"><a href="multiple3.html#cb27-15" aria-hidden="true" tabindex="-1"></a>std_pwb_data <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="multiple3.html#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb27-17"><a href="multiple3.html#cb27-17" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd))) <span class="sc">%&gt;%</span> </span>
<span id="cb27-18"><a href="multiple3.html#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<p><br />
</p>
<p>Now re-run Step 4 (i.e., the final model) of the hierarchical regression in Iani et al. (2019), but with <code>std_pwb_data</code> instead of <code>pwb_data</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="multiple3.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run the regression using standardised data</span></span>
<span id="cb28-2"><a href="multiple3.html#cb28-2" aria-hidden="true" tabindex="-1"></a>std_step4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wellbeing <span class="sc">~</span> brooding <span class="sc">+</span> worry <span class="sc">+</span> </span>
<span id="cb28-3"><a href="multiple3.html#cb28-3" aria-hidden="true" tabindex="-1"></a>              observing <span class="sc">+</span> describing <span class="sc">+</span> acting <span class="sc">+</span> nonjudging <span class="sc">+</span> nonreactivity <span class="sc">+</span> </span>
<span id="cb28-4"><a href="multiple3.html#cb28-4" aria-hidden="true" tabindex="-1"></a>              attention <span class="sc">+</span> clarity <span class="sc">+</span> repair, </span>
<span id="cb28-5"><a href="multiple3.html#cb28-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> std_pwb_data)</span>
<span id="cb28-6"><a href="multiple3.html#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="multiple3.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># look at standardised coefficients</span></span>
<span id="cb28-8"><a href="multiple3.html#cb28-8" aria-hidden="true" tabindex="-1"></a>std_step4</span></code></pre></div>
<p>The standardised coefficients are called the <strong>beta</strong> coefficients, and have the symbol <span class="math inline">\(\beta\)</span>. Beta coefficients range from -1 to +1, so the zero is usually omitted when reporting, e.g., <span class="math inline">\(\beta(brooding) = -.12\)</span></p>
<p>Make a note of the standardised (beta) coefficients for the model in Iani et al. (2019):</p>
<ul>
<li><code>brooding</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.12","-0.12"]'/></li>
<li><code>worry</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.28","-0.28"]'/></li>
<li><code>observing</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.07","-0.07"]'/></li>
<li><code>describing</code> = <input class='webex-solveme nospaces' size='4' data-answer='[".38","0.38"]'/></li>
<li><code>acting</code> = <input class='webex-solveme nospaces' size='4' data-answer='[".10","0.10"]'/></li>
<li><code>nonjudging</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.24","-0.24"]'/></li>
<li><code>nonreactivity</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.11","-0.11"]'/></li>
<li><code>attention</code> = <input class='webex-solveme nospaces' size='5' data-answer='["-.29","-0.29"]'/></li>
<li><code>clarity</code> = <input class='webex-solveme nospaces' size='4' data-answer='[".02","0.02"]'/></li>
<li><code>repair</code> = <input class='webex-solveme nospaces' size='4' data-answer='[".20","0.20"]'/></li>
</ul>
<p><br />
</p>
<p>As with the unstandardised coefficients, the sign on the beta coefficient indicates the direction of the association with the outcome variable (i.e., positive or negative).</p>
<p>Because the beta coefficients are now on the same scale, their magnitudes (i.e., their absolute size, ignoring the sign) can be compared to determine the relative "importance" of each predictor.</p>
<p><br />
</p>
<p>Which predictor variable makes the greatest contribution to the prediction of <code>wellbeing</code>? <select class='webex-select'><option value='blank'></option><option value=''>brooding</option><option value=''>worry</option><option value=''>observing</option><option value='answer'>describing</option><option value=''>acting</option><option value=''>nonjudging</option><option value=''>nonreactivity</option><option value=''>attention</option><option value=''>clarity</option><option value=''>repair</option></select></p>
<p>Which predictor variable makes the smallest contribution to the prediction of <code>wellbeing</code>? <select class='webex-select'><option value='blank'></option><option value=''>brooding</option><option value=''>worry</option><option value=''>observing</option><option value=''>describing</option><option value=''>acting</option><option value=''>nonjudging</option><option value=''>nonreactivity</option><option value=''>attention</option><option value='answer'>clarity</option><option value=''>repair</option></select></p>
<div class="webex-solution">
<button>
Explain
</button>
<p><code>describing</code> has the largest beta coeffcient (.38); it therefore makes the greatest contribution to the prediction of <code>wellbeing</code> in the full model. <code>clarity</code> makes the smallest contribution (beta = .02).</p>
</div>
<p><br />
</p>
<p>Note, some of the beta coefficients differ slightly from those reported by Iani et al. (2019). This is most likely due to differences in rounding introduced during standardisation by different software packages. The values are very close though and the ordinal pattern in the beta coefficients is the same.</p>
<p><br />
</p>
</div>
<div id="prediction" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Prediction<a href="multiple3.html#prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="webex-solution">
<button>
Prediction
</button>
<p>The final model can be used to predict new data points (as in earlier sessions). For the model with continuous predictors:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="multiple3.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify data for new ppt</span></span>
<span id="cb29-2"><a href="multiple3.html#cb29-2" aria-hidden="true" tabindex="-1"></a>new_pwb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(  <span class="at">brooding =</span> <span class="dv">6</span>,</span>
<span id="cb29-3"><a href="multiple3.html#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">worry =</span> <span class="dv">12</span>,</span>
<span id="cb29-4"><a href="multiple3.html#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">observing =</span> <span class="dv">12</span>,</span>
<span id="cb29-5"><a href="multiple3.html#cb29-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">describing =</span> <span class="dv">18</span>,</span>
<span id="cb29-6"><a href="multiple3.html#cb29-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">acting =</span> <span class="dv">17</span>,</span>
<span id="cb29-7"><a href="multiple3.html#cb29-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nonjudging =</span> <span class="dv">20</span>,</span>
<span id="cb29-8"><a href="multiple3.html#cb29-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nonreactivity =</span> <span class="dv">19</span>,</span>
<span id="cb29-9"><a href="multiple3.html#cb29-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">attention =</span> <span class="dv">30</span>,</span>
<span id="cb29-10"><a href="multiple3.html#cb29-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">clarity =</span> <span class="dv">27</span>,</span>
<span id="cb29-11"><a href="multiple3.html#cb29-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">repair =</span> <span class="dv">27</span> )</span>
<span id="cb29-12"><a href="multiple3.html#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="multiple3.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># use augment() in broom package. </span></span>
<span id="cb29-14"><a href="multiple3.html#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># .fitted = predicted wellbeing value</span></span>
<span id="cb29-15"><a href="multiple3.html#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(step4, <span class="at">newdata =</span> new_pwb)</span></code></pre></div>
<p>The predicted value of wellbeing for the new participant in <code>new_pwb</code> is <input class='webex-solveme nospaces' size='5' data-answer='["73.29"]'/>.</p>
<p><br />
</p>
<p>For the model with categorical predictors:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="multiple3.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify data for new ppt</span></span>
<span id="cb30-2"><a href="multiple3.html#cb30-2" aria-hidden="true" tabindex="-1"></a>new_animal_dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">comfort =</span> <span class="dv">45</span>,</span>
<span id="cb30-3"><a href="multiple3.html#cb30-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gender =</span> <span class="st">&#39;female&#39;</span>,</span>
<span id="cb30-4"><a href="multiple3.html#cb30-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">age =</span> <span class="st">&#39;18_24&#39;</span>,</span>
<span id="cb30-5"><a href="multiple3.html#cb30-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">partner =</span> <span class="st">&#39;living_partner&#39;</span>,</span>
<span id="cb30-6"><a href="multiple3.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">species =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb30-7"><a href="multiple3.html#cb30-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">loneliness_pre =</span> <span class="dv">7</span>)</span>
<span id="cb30-8"><a href="multiple3.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="multiple3.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use augment() in broom package. </span></span>
<span id="cb30-10"><a href="multiple3.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># .fitted = predicted value</span></span>
<span id="cb30-11"><a href="multiple3.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(step2_full, <span class="at">newdata =</span> new_animal_dat)</span></code></pre></div>
<p>The predicted value of <code>mental_health_pre</code> for the new participant in <code>new_animal_dat</code> is <input class='webex-solveme nospaces' size='5' data-answer='["18.03","18.00"]'/>.</p>
</div>
<p><br />
</p>
</div>
<div id="residuals-1" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Residuals<a href="multiple3.html#residuals-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="webex-solution">
<button>
Residuals
</button>
<p>As in earlier sessions, the residuals can be inspected in a plot of the predicted values vs. the residuals:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="multiple3.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot of the predicted outcome values vs. residuals</span></span>
<span id="cb31-2"><a href="multiple3.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(step4) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="multiple3.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>.resid)) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="multiple3.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-5"><a href="multiple3.html#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>)</span></code></pre></div>
<p>We can also inspect the histogram of the residuals for normality:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="multiple3.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of the residuals</span></span>
<span id="cb32-2"><a href="multiple3.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(step4) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="multiple3.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.resid)) <span class="sc">+</span> </span>
<span id="cb32-4"><a href="multiple3.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code></pre></div>
</div>
<p><br />
</p>
</div>
</div>
<div id="summary-3" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Summary<a href="multiple3.html#summary-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Hierarchical regression</strong></p>
<ul>
<li>In hierarchical regression, predictors are added to a regression model in successive steps.</li>
<li>It can be used to test particular theories or hypotheses.</li>
<li>It can also be used to control the influence of particular variables (e.g., background variables) before analysing whether a predictor variable (or set of variables) of interest explains the outcome variable.</li>
<li>As before, <code>lm()</code> and <code>glance()</code> can be used to obtain R<sup>2</sup> for the model at each step.</li>
<li>The change in R<sup>2</sup> associated with each step can be obtained to determine the unique contribution of the predictors in each step.</li>
<li><code>lmBF()</code> can be used to obtain the Bayes factor for the model in each step. Bayes factors of models from successive steps can be compared to determine the evidence for the unique contribution of predictors in a step.</li>
</ul>
<p><br />
</p>
<p><strong>Plotting tips:</strong></p>
<ul>
<li>Use <code>geom_jitter()</code> to make scatterplots with overlapping points easier to interpret. Useful for survey data.</li>
<li>Use <code>keep()</code> with <code>pivot_longer()</code>, <code>ggplot()</code> and <code>facet_wrap()</code> to plot lots of variables of a certain type (e.g., numeric or character) on separate panels.</li>
<li>Use <code>grid.arrange()</code> in the <code>gridExtra</code> package to display figures on separate panels.</li>
</ul>
<p><br />
</p>
</div>
<div id="references-4" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> References<a href="multiple3.html#references-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Iani, L., Quinto, R. M., Lauriola, M., Crosta, M. L., &amp; Pozzi, G. (2019). Psychological well-being and distress in patients with generalized anxiety disorder: The roles of positive and negative functioning. <em>PloS ONE</em>, <em>14</em>(11), e0225646. <a href="https://doi.org/10.1371/journal.pone.0225646" class="uri">https://doi.org/10.1371/journal.pone.0225646</a></p>
<p>Ratschen E., Shoesmith E., Shahab L., Silva K., Kale D., Toner P., et al. (2020) Human-animal relationships and interactions during the Covid-19 lockdown phase in the UK: Investigating links with mental health and loneliness. <em>PLoS ONE</em>, <em>15</em>(9):e0239397. <a href="https://doi.org/10.1371/journal.pone.0239397" class="uri">https://doi.org/10.1371/journal.pone.0239397</a></p>

</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="multiple2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
