<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Identifying polynomial components | PSYC753 Data Fluency</title>
  <meta name="description" content="Identifying polynomial components | PSYC753 Data Fluency" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Identifying polynomial components | PSYC753 Data Fluency" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Identifying polynomial components | PSYC753 Data Fluency" />
  
  
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="polynomials.html">
<link rel="next" href="bayesian-approach.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="media/webex.css" rel="stylesheet" />
<link href="media/psystats.css" rel="stylesheet" />
<script src="media/webex.js"></script>
<script src="media/psystats.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118343766-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-118343766-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Fluency</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="building1.html"><a href="building1.html"><i class="fa fa-check"></i>Building models 1</a><ul>
<li class="chapter" data-level="" data-path="multiple-regression-with-several-continuous-predictors.html"><a href="multiple-regression-with-several-continuous-predictors.html"><i class="fa fa-check"></i>Multiple regression with several continuous predictors</a></li>
<li class="chapter" data-level="" data-path="analysing-the-model.html"><a href="analysing-the-model.html"><i class="fa fa-check"></i>Analysing the model</a></li>
<li class="chapter" data-level="" data-path="conceptualising-the-variance-explained-by-predictors.html"><a href="conceptualising-the-variance-explained-by-predictors.html"><i class="fa fa-check"></i>Conceptualising the variance explained by predictors</a></li>
<li class="chapter" data-level="" data-path="adding-predictor-variables-to-the-model.html"><a href="adding-predictor-variables-to-the-model.html"><i class="fa fa-check"></i>Adding predictor variables to the model</a></li>
<li class="chapter" data-level="" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="final-exercise.html"><a href="final-exercise.html"><i class="fa fa-check"></i>Final exercise</a></li>
<li class="chapter" data-level="" data-path="summary-of-key-points.html"><a href="summary-of-key-points.html"><i class="fa fa-check"></i>Summary of key points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building2.html"><a href="building2.html"><i class="fa fa-check"></i>Building models 2</a><ul>
<li class="chapter" data-level="" data-path="using-anova-and-bayes-factors-to-compare-models.html"><a href="using-anova-and-bayes-factors-to-compare-models.html"><i class="fa fa-check"></i>Using ANOVA and Bayes Factors to compare models</a></li>
<li class="chapter" data-level="" data-path="comparing-models-using-anova.html"><a href="comparing-models-using-anova.html"><i class="fa fa-check"></i>Comparing models using ANOVA</a></li>
<li class="chapter" data-level="" data-path="comparing-models-using-bayes-factors.html"><a href="comparing-models-using-bayes-factors.html"><i class="fa fa-check"></i>Comparing models using Bayes Factors</a></li>
<li class="chapter" data-level="" data-path="exercise.html"><a href="exercise.html"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="summary-of-key-points-1.html"><a href="summary-of-key-points-1.html"><i class="fa fa-check"></i>Summary of key points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitcurves.html"><a href="fitcurves.html"><i class="fa fa-check"></i>Fitting curves</a><ul>
<li class="chapter" data-level="" data-path="using-polynomials-to-fit-curves.html"><a href="using-polynomials-to-fit-curves.html"><i class="fa fa-check"></i>Using polynomials to fit curves</a></li>
<li class="chapter" data-level="" data-path="polynomials.html"><a href="polynomials.html"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="identifying-polynomial-components.html"><a href="identifying-polynomial-components.html"><i class="fa fa-check"></i>Identifying polynomial components</a></li>
<li class="chapter" data-level="" data-path="bayesian-approach.html"><a href="bayesian-approach.html"><i class="fa fa-check"></i>Bayesian approach</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="summary-of-key-points-2.html"><a href="summary-of-key-points-2.html"><i class="fa fa-check"></i>Summary of key points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a><ul>
<li class="chapter" data-level="" data-path="data-analysis-and-visualisation-task.html"><a href="data-analysis-and-visualisation-task.html"><i class="fa fa-check"></i>Data Analysis and Visualisation Task</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="FAQ-assessment.html"><a href="FAQ-assessment.html"><i class="fa fa-check"></i>FAQ Data Analysis and Visualisation Task</a></li>
<li class="divider"></li>
<li><a href="./LICENCE" target="blank">Licence: CC BY-SA 4</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSYC753 Data Fluency</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="identifying-polynomial-components" class="section level2">
<h2>Identifying polynomial components</h2>
<p>To determine whether a model should have quadratic, cubic, or higher order components, we can use the <strong>sequential regression</strong> approach covered in the previous session. We take the following steps, and look at the change in <span class="math inline">\(R^2\)</span> associated with each step.</p>
<ul>
<li><p>First fit the <strong>linear</strong> model</p></li>
<li><p>then test for the addition of the <strong>quadratic (<span class="math inline">\(x^2\)</span>)</strong> component</p></li>
<li><p>then test for the addition of the <strong>cubic (<span class="math inline">\(x^3\)</span>)</strong> component</p></li>
</ul>
<p><br />
</p>
<p>Let’s see this in action!</p>
<div class="tip">
<p><strong>Learning tip</strong></p>
<p>Try storing all your code in an <strong>R Markdown</strong> file today if you are not doing so already! You can use code chunks and write text to describe each chunk as was described in the slides.</p>
</div>
<p><br />
We’ll use a dataset inspired by a 2016 survey of the National Office for Statistics. They investigated happiness across the life span. Approximately 300,000 individuals of all ages answered questions related to well-being.</p>
<p><br />
Each participant answered the following question regarding their <em>happiness</em>:</p>
<p><strong>"Overall, how happy did you feel yesterday?</strong><br />
<strong>Where 0 is ‘not at all happy’ and 10 is ‘completely happy’."</strong></p>
<p> </p>
<p>This <code>happy</code> dataset are located at “<a href="https://bit.ly/2uIxM5K" class="uri">https://bit.ly/2uIxM5K</a>”.</p>
<p><br />
</p>
<p>Let’s load the data into R, and preview the data using <code>head</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load the data</span>
SurveyData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://bit.ly/2uIxM5K&quot;</span>)

<span class="co"># preview it</span>
SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()
<span class="op">&gt;</span><span class="st"> </span><span class="co"># A tibble: 6 x 3</span>
<span class="er">&gt;</span><span class="st">     </span>age happiness anxiety
<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span>
<span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span>  <span class="fl">66.0</span>      <span class="fl">7.85</span>    <span class="fl">2.33</span>
<span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>  <span class="fl">35.0</span>      <span class="fl">7.56</span>    <span class="fl">2.58</span>
<span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>  <span class="fl">58.6</span>      <span class="fl">7.59</span>    <span class="fl">3.43</span>
<span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>  <span class="fl">35.0</span>      <span class="fl">7.06</span>    <span class="fl">1.67</span>
<span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>  <span class="fl">60.2</span>      <span class="fl">7.96</span>    <span class="fl">2.13</span>
<span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>  <span class="fl">67.5</span>      <span class="fl">8.11</span>    <span class="fl">1.09</span></code></pre>
<p><br />
Plot the relationship between <code>age</code> and <code>happiness</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">SurveyData <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>happiness)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre>
<p><img src="07-fitting-curves_files/figure-html/fig11-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p>If you had to guess from the plot, which components seem to be present in the relationship between <code>happiness</code> and <code>age</code>?</p>
<p>Linear: <select class='solveme' data-answer='["possibly"]'> <option></option> <option>no</option> <option>possibly</option></select></p>
<p>Quadratic: <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<p>Cubic: <select class='solveme' data-answer='["no"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<p><br />
</p>
<p>Try to describe the relationship between <code>happiness</code> and <code>age</code>.</p>
<div class="solution">
<button>
Try first, click here for a description
</button>
<p>Happiness of individuals appears to decline from 30 years to the late forties. Happiness then increases beyond the late forties, reaching its peak at 70 years, at which age people reported the highest levels of happiness - higher even than levels shown in early thirties.</p>
</div>
</div>
<p><br />
</p>
<div id="linear-component" class="section level3">
<h3>Linear component</h3>
<p>To determine whether there is a linear component, run a simple regression with <code>happiness</code> as the outcome variable and <code>age</code> as the predictor:</p>
<pre class="sourceCode r"><code class="sourceCode r">polynomial1 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)
<span class="kw">summary</span>(polynomial1)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span>
<span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.78019</span> <span class="fl">-0.16858</span> <span class="fl">-0.04762</span>  <span class="fl">0.19811</span>  <span class="fl">0.84368</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    
<span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">6.484101</span>   <span class="fl">0.102340</span>   <span class="fl">63.36</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span>age         <span class="fl">0.021076</span>   <span class="fl">0.001979</span>   <span class="fl">10.65</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2912</span> on <span class="dv">148</span> degrees of freedom
<span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4339</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4301</span> 
<span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">113.5</span> on <span class="dv">1</span> and <span class="dv">148</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></code></pre>
<p><strong>Explanation:</strong> The linear model is stored in <code>polynomial1</code>. <code>summary</code> displays the results.</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> scores is explained by <code>age</code>? <select class='solveme' data-answer='["43.39"]'> <option></option> <option>0.44</option> <option>43.39</option> <option>29.12</option></select> %</p>
<p>Is <code>age</code> a statistically significant predictor of <code>happiness</code> <select class='solveme' data-answer='["yes"]'> <option></option> <option>no</option> <option>yes</option></select></p>
</div>
<p><br />
</p>
<p>The linear model does okay, but remember it is only fitting a straight line through our data, which appear to show a curved relationship!</p>
<p><br />
</p>
</div>
<div id="adding-a-quadratic-component" class="section level3">
<h3>Adding a quadratic component</h3>
<p>We can add a quadratic component to the regression model using <code>poly()</code>. If we type <code>poly(age, 2)</code> when specifying the model, the ‘2’ in the <code>poly()</code> function tells R that we want to fit a model with <strong>both</strong> linear and quadratic components of <code>age</code>. This is the model it’ll fit:</p>
<p><br />
</p>
<p><span class="math inline">\(predicted \: happiness = a + b_1(age) + b_2(age^2)\)</span></p>
<p><br />
</p>
<p>where <span class="math inline">\(a\)</span> is the intercept, and <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are the coefficients for the linear and quadratic components, respectively.</p>
<pre class="sourceCode r"><code class="sourceCode r">
polynomial2 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">2</span>), <span class="dt">data =</span> SurveyData)
<span class="kw">summary</span>(polynomial2)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>), <span class="dt">data =</span> SurveyData)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span>
<span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.58896</span> <span class="fl">-0.12752</span> <span class="fl">-0.02333</span>  <span class="fl">0.13274</span>  <span class="fl">0.59724</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">               </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    
<span class="op">&gt;</span><span class="st"> </span>(Intercept)    <span class="fl">7.54433</span>    <span class="fl">0.01779</span>  <span class="fl">424.06</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)<span class="dv">1</span>  <span class="fl">3.10223</span>    <span class="fl">0.21789</span>   <span class="fl">14.24</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)<span class="dv">2</span>  <span class="fl">2.36118</span>    <span class="fl">0.21789</span>   <span class="fl">10.84</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2179</span> on <span class="dv">147</span> degrees of freedom
<span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6853</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.681</span> 
<span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">160.1</span> on <span class="dv">2</span> and <span class="dv">147</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></code></pre>
<p><strong>Explanation of the code:</strong> We’ve told R we want to add a quadratic component to the model by using <code>happiness ~ poly(age, 2)</code>.</p>
<p><br />
</p>
<p><strong>Explanation of the output:</strong> You will see in the output separate coefficient estimates for <code>poly(age, 2)1</code> and <code>poly(age, 2)</code>. These are the estimates of the coefficients for the linear and quadratic components of <code>age</code> (i.e., <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> in the equation above).</p>
<p><br />
</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> does a model with a <strong>quadratic component</strong> of <code>age</code> explain? <input class='solveme nospaces' size='5' data-answer='["68.53"]'/> %</p>
<p><br />
</p>
<p>Compare the value of <span class="math inline">\(R^2\)</span> in <code>polynomial1</code> and <code>polynomial2</code>.</p>
<ul>
<li><p>Does the addition of a quadratic component result in a numerical increase in <span class="math inline">\(R^2\)</span> in <code>polynomial2</code>? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the change in <span class="math inline">\(R^2\)</span>? <input class='solveme nospaces' size='5' data-answer='["25.14"]'/> % (to 2 decimal places)</p></li>
</ul>
<div class="solution">
<button>
Click to see how the answer is calculated
</button>
<p><span class="math inline">\(R^2\)</span> change from <code>polynomial1</code> to <code>polynomial2</code> = 68.53 - 43.39 = 25.14%</p>
<p>Therefore, the model with the quadratic component of <code>age</code> accounts for <strong>25.14% more variance</strong> in <code>happiness</code> than the model with only a linear component.</p>
</div>
</div>
<p><br />
</p>
<p>We can test whether the <strong><em>increase</em> in <em>R</em><sup>2</sup></strong> in <code>polynomial2</code> represents a statistically significant increase by comparing <code>polynomial1</code> and <code>polynomial2</code> using <code>anova</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">anova</span>(polynomial1, polynomial2)
<span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span>age
<span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)
<span class="op">&gt;</span><span class="st">   </span>Res.Df     RSS Df Sum of Sq      F    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    
<span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>    <span class="dv">148</span> <span class="fl">12.5542</span>                                  
<span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>    <span class="dv">147</span>  <span class="fl">6.9791</span>  <span class="dv">1</span>    <span class="fl">5.5752</span> <span class="fl">117.43</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></code></pre>
<div class="exercise">
<p>Is the increase in <span class="math inline">\(R^2\)</span> associated with the addition of the quadratic component statistically significant? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p>
<div class="solution">
<button>
Answer
</button>
<p>Yes. We can report the improvement in fit as follows:</p>
<p>A model with a quadratic component of <code>age</code> accounted for a statistically significantly greater proportion of variance in <code>happiness</code> than a model with only a linear component, <em>F</em>(1, 147) = 117.43, <em>p</em> &lt; .001.</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="adding-a-cubic-component" class="section level3">
<h3>Adding a cubic component</h3>
<p>Now we’ll test for a cubic component.</p>
<pre class="sourceCode r"><code class="sourceCode r">polynomial3 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age,<span class="dv">3</span>), <span class="dt">data =</span> SurveyData)
<span class="kw">summary</span>(polynomial3)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>), <span class="dt">data =</span> SurveyData)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span>
<span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.60468</span> <span class="fl">-0.14165</span> <span class="fl">-0.01844</span>  <span class="fl">0.13839</span>  <span class="fl">0.58176</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">               </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    
<span class="op">&gt;</span><span class="st"> </span>(Intercept)    <span class="fl">7.54433</span>    <span class="fl">0.01777</span> <span class="fl">424.447</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">1</span>  <span class="fl">3.10223</span>    <span class="fl">0.21769</span>  <span class="fl">14.251</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">2</span>  <span class="fl">2.36118</span>    <span class="fl">0.21769</span>  <span class="fl">10.846</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)<span class="dv">3</span> <span class="fl">-0.24530</span>    <span class="fl">0.21769</span>  <span class="fl">-1.127</span>    <span class="fl">0.262</span>    
<span class="op">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2177</span> on <span class="dv">146</span> degrees of freedom
<span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.688</span>,   Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6816</span> 
<span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">107.3</span> on <span class="dv">3</span> and <span class="dv">146</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></code></pre>
<p>The ‘3’ in <code>poly(age,3)</code> tells R that we want to specify a model with linear, quadratic <em>and</em> cubic components, of the form:</p>
<p><br />
</p>
<p><span class="math inline">\(happiness = a + b_1(age) + b_2(age^2) + b_3(age^3)\)</span></p>
<p><br />
</p>
<div class="exercise">
<p>What percentage of the variance in <code>happiness</code> does a model with a <strong>cubic component</strong> of <code>age</code> explain? <input class='solveme nospaces' size='4' data-answer='["68.8"]'/> %</p>
<p><br />
</p>
<p>Compare the value of <span class="math inline">\(R^2\)</span> in <code>polynomial3</code> and <code>polynomial2</code>.</p>
<ul>
<li><p>Does the addition of a cubic component result in a numerical increase in <span class="math inline">\(R^2\)</span> in <code>polynomial3</code>? <select class='solveme' data-answer='["yes"]'> <option></option> <option>yes</option> <option>no</option></select></p></li>
<li><p>What is the increase in <span class="math inline">\(R^2\)</span> as a result of adding in the cubic component? (Compare <span class="math inline">\(R^2\)</span> between <code>polynomial3</code> and <code>polynomial2</code>).</p>
The increase in <span class="math inline">\(R^2\)</span> is <input class='solveme nospaces' size='4' data-answer='["0.27",".27"]'/> %</li>
</ul>
</div>
<p>To determine if the increase in <span class="math inline">\(R^2\)</span> is statistically significant, we can again use <code>anova</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">anova</span>(polynomial2, polynomial3)
<span class="op">&gt;</span><span class="st"> </span>Analysis of Variance Table
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Model <span class="dv">1</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">2</span>)
<span class="op">&gt;</span><span class="st"> </span>Model <span class="dv">2</span><span class="op">:</span><span class="st"> </span>happiness <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(age, <span class="dv">3</span>)
<span class="op">&gt;</span><span class="st">   </span>Res.Df    RSS Df Sum of Sq      F <span class="kw">Pr</span>(<span class="op">&gt;</span>F)
<span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>    <span class="dv">147</span> <span class="fl">6.9791</span>                           
<span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>    <span class="dv">146</span> <span class="fl">6.9189</span>  <span class="dv">1</span>  <span class="fl">0.060171</span> <span class="fl">1.2697</span> <span class="fl">0.2617</span></code></pre>
<div class="exercise">
<p>Is the increase in <span class="math inline">\(R^2\)</span> associated with the addition of a cubic component statistically significant? <select class='solveme' data-answer='["no"]'> <option></option> <option>no</option> <option>yes</option></select></p>
<div class="solution">
<button>
Description of the answer
</button>
<p>The <code>anova</code> comparing <code>polynomial3</code> and <code>polynomial2</code> is not statistically significant, <em>F</em>(1, 146) = 1.27, <em>p</em> = .26, indicating that the addition of the cubic component of <code>age</code> into the regression model does not increase the variance in <code>happiness</code> explained.</p>
</div>
<p><br />
On the basis of the tests conducted so far, which model should be preferred? One with:</p>
<p><select class='solveme' data-answer='["linear and quadratic components of age"]'> <option></option> <option>a linear component of age only</option> <option>linear and quadratic components of age</option> <option>linear, quadratic, and cubic components of age</option></select></p>
<div class="solution">
<button>
Explain
</button>
<p>Our analyses suggest that a model with a quadratic component of <code>age</code> (i.e., the model in <code>polynomial2</code>) is sufficient to explain the data.</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="a-note-about-poly" class="section level3">
<h3>A note about <code>poly()</code></h3>
<p><code>poly</code> automatically creates polynomial terms for us. The polynomials it creates are actually a special type, called <strong>orthogonal</strong> polynomials. This means that the polynomials are not correlated with one another. For example, the correlation between the <span class="math inline">\(age\)</span> and <span class="math inline">\(age^2\)</span> components created by <code>poly</code> is zero . Likewise, the correlation betweem <span class="math inline">\(age^2\)</span> and <span class="math inline">\(age^3\)</span> components created by <code>poly</code> is also zero.</p>
<p><br />
This is desirable because if the components were not <strong>orthogonalised</strong>, they’d be highly correlated with each other. That is, the raw scores for <span class="math inline">\(age\)</span> and <span class="math inline">\(age \times age\)</span> are likely to be highly correlated. As we covered in the first Building Models 1 session, high correlations between our predictors is undesirable as it can lead to <strong>multicolinearity</strong>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="polynomials.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-approach.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
