<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Linear regression | Data Fluency - Chris Berry Sessions</title>
  <meta name="description" content="Linear regression | Data Fluency - Chris Berry Sessions" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Linear regression | Data Fluency - Chris Berry Sessions" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Linear regression | Data Fluency - Chris Berry Sessions" />
  
  
  

<meta name="author" content="Chris Berry" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fitting-curves-to-data-rather-than-straight-lines.html">
<link rel="next" href="adding-a-quadratic-component.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="media/webex.css" rel="stylesheet" />
<link href="media/psystats.css" rel="stylesheet" />
<script src="media/webex.js"></script>
<script src="media/psystats.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118343766-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-118343766-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Fluency</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="assessments.html"><a href="assessments.html"><i class="fa fa-check"></i>Assessments</a><ul>
<li class="chapter" data-level="" data-path="core-skills-test.html"><a href="core-skills-test.html"><i class="fa fa-check"></i>Core skills test</a></li>
<li class="chapter" data-level="" data-path="data-analysis-and-visualisation-task.html"><a href="data-analysis-and-visualisation-task.html"><i class="fa fa-check"></i>Data analysis and visualisation task</a></li>
<li class="chapter" data-level="" data-path="assessment-authentic-analysis.html"><a href="assessment-authentic-analysis.html"><i class="fa fa-check"></i>Authentic analysis assessment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-models.html"><a href="building-models.html"><i class="fa fa-check"></i>Building models</a><ul>
<li class="chapter" data-level="" data-path="session-1-multiple-regression.html"><a href="session-1-multiple-regression.html"><i class="fa fa-check"></i>Session 1: Multiple regression</a></li>
<li class="chapter" data-level="" data-path="analysis-of-regression.html"><a href="analysis-of-regression.html"><i class="fa fa-check"></i>Analysis of regression</a></li>
<li class="chapter" data-level="" data-path="conceptualising-the-variance-explained-by-predictors.html"><a href="conceptualising-the-variance-explained-by-predictors.html"><i class="fa fa-check"></i>Conceptualising the variance explained by predictors</a></li>
<li class="chapter" data-level="" data-path="adding-predictor-variables-to-the-model.html"><a href="adding-predictor-variables-to-the-model.html"><i class="fa fa-check"></i>Adding predictor variables to the model</a></li>
<li class="chapter" data-level="" data-path="multicolinearity.html"><a href="multicolinearity.html"><i class="fa fa-check"></i>Multicolinearity</a></li>
<li class="chapter" data-level="" data-path="final-exercise.html"><a href="final-exercise.html"><i class="fa fa-check"></i>Final exercise</a></li>
<li class="chapter" data-level="" data-path="summary-of-key-points.html"><a href="summary-of-key-points.html"><i class="fa fa-check"></i>Summary of key points</a></li>
<li class="chapter" data-level="" data-path="session-2-anova-and-bayes-factor.html"><a href="session-2-anova-and-bayes-factor.html"><i class="fa fa-check"></i>Session 2: ANOVA and Bayes Factor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-curves.html"><a href="fitting-curves.html"><i class="fa fa-check"></i>Fitting curves</a><ul>
<li class="chapter" data-level="" data-path="session-1.html"><a href="session-1.html"><i class="fa fa-check"></i>Session 1</a></li>
<li class="chapter" data-level="" data-path="learning-outcomes.html"><a href="learning-outcomes.html"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i>Structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="polynomials.html"><a href="polynomials.html"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="constant.html"><a href="constant.html"><i class="fa fa-check"></i>Constant</a></li>
<li class="chapter" data-level="" data-path="linear.html"><a href="linear.html"><i class="fa fa-check"></i>Linear</a></li>
<li class="chapter" data-level="" data-path="constant-linear-component.html"><a href="constant-linear-component.html"><i class="fa fa-check"></i>Constant + linear component</a></li>
<li class="chapter" data-level="" data-path="quadratic.html"><a href="quadratic.html"><i class="fa fa-check"></i>Quadratic</a></li>
<li class="chapter" data-level="" data-path="linear-plus-quadratic-components.html"><a href="linear-plus-quadratic-components.html"><i class="fa fa-check"></i>Linear plus quadratic components</a></li>
<li class="chapter" data-level="" data-path="identifying-components.html"><a href="identifying-components.html"><i class="fa fa-check"></i>Identifying components</a><ul>
<li class="chapter" data-level="" data-path="linear-first-order-components.html"><a href="linear-first-order-components.html"><i class="fa fa-check"></i>Linear (first-order) components</a></li>
<li class="chapter" data-level="" data-path="quadratic-second-order-components.html"><a href="quadratic-second-order-components.html"><i class="fa fa-check"></i>Quadratic (second-order) components</a></li>
<li class="chapter" data-level="" data-path="cubic-third-order-components.html"><a href="cubic-third-order-components.html"><i class="fa fa-check"></i>Cubic (third) order components</a></li>
<li class="chapter" data-level="" data-path="quartic-fourth-order-components.html"><a href="quartic-fourth-order-components.html"><i class="fa fa-check"></i>Quartic (fourth) order components</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-curves-to-data-rather-than-straight-lines.html"><a href="fitting-curves-to-data-rather-than-straight-lines.html"><i class="fa fa-check"></i>Fitting curves to data rather than straight lines</a><ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear regression</a></li>
<li class="chapter" data-level="" data-path="adding-a-quadratic-component.html"><a href="adding-a-quadratic-component.html"><i class="fa fa-check"></i>Adding a quadratic component</a></li>
<li class="chapter" data-level="" data-path="adding-a-cubic-component.html"><a href="adding-a-cubic-component.html"><i class="fa fa-check"></i>Adding a cubic component</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-approach.html"><a href="bayesian-approach.html"><i class="fa fa-check"></i>Bayesian approach</a></li>
<li class="chapter" data-level="" data-path="exercise.html"><a href="exercise.html"><i class="fa fa-check"></i>Exercise</a><ul>
<li><a href="does-age-predict-anxiety.html#does-age-predict-anxiety">Does <code>age</code> predict <code>anxiety</code>?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="divider"></li>
<li><a href="./LICENCE" target="blank">Licence: CC BY-SA 4</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Fluency - Chris Berry Sessions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level2">
<h2>Linear regression</h2>
<p>Run a linear regression to determine whether <code>happiness</code> can be predicted from <code>age</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)
<span class="kw">summary</span>(model1)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> happiness <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> SurveyData)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span>
<span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.78019</span> <span class="fl">-0.16858</span> <span class="fl">-0.04762</span>  <span class="fl">0.19811</span>  <span class="fl">0.84368</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    
<span class="op">&gt;</span><span class="st"> </span>(Intercept) <span class="fl">6.484101</span>   <span class="fl">0.102340</span>   <span class="fl">63.36</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span>age         <span class="fl">0.021076</span>   <span class="fl">0.001979</span>   <span class="fl">10.65</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.2912</span> on <span class="dv">148</span> degrees of freedom
<span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4339</span>,  Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4301</span> 
<span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">113.5</span> on <span class="dv">1</span> and <span class="dv">148</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></code></pre>
<div class="exercise">
<p>Write the regression equation for predicting <code>happiness</code> from <code>age</code>, using the values from the <code>Estimate</code> column.</p>
<div class="solution">
<button>
Show me
</button>
<p>The regression equation is:</p>
<p>Predicted happiness = 6.48 + 0.02*age</p>
</div>
</div>
<p>The following parts of the output tell us how well the model explains the data:</p>
<ul>
<li><p><strong>Multiple <em>R</em>-squared</strong> (<span class="math inline">\(R^2\)</span>) is the proportion of variance in the outcome variable (happiness) that can be accounted for by the regression model. It gives us some idea of how well our model explains the data. If we multiply the value by 100, we get a percentage. Therefore, in this model, <code>age</code> explains <strong>43.4%</strong> of the variance in <code>happiness</code> scores.</p></li>
<li><p>The <strong><em>F</em>-statistic</strong> gives us an idea of how much variance in happiness the model explains, relative to how much variance in happiness it does not explain (i.e., the error in prediction or residuals). There are two separate degrees of freedom associated with the <em>F</em>-statistic (1, 148).</p></li>
<li><p>A <em>p</em>-value associated with <em>F</em> is also given. This is the probability of obtaining an <em>F</em>-statistic as extreme as this, given that the null hypothesis is true. Given that our <em>p</em>-value is less than .05, we can declare age to be a statistically significant predictor of happiness, and could report <em>F</em> as follows:</p></li>
</ul>
<div class="exercise">
<ul>
<li>Age is a statistically significant predictor of happiness, <em>F</em>(1,148) = 113.00, <em>p</em> &lt; .001.</li>
</ul>
</div>
<p>Now let’s see how well the happiness values predicted by the regression equation match the trends in our data. Plot the regression line from <code>model1</code> on the same plot as the data:</p>
<pre class="sourceCode r"><code class="sourceCode r">SurveyData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fit1 =</span> <span class="kw">fitted</span>(model1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>happiness)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>fit1))</code></pre>
<p><img src="07-fitting-curves_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>The above code uses the <code>mutate</code> function from the <code>dplyr</code> package to add an additional column named <code>fit1</code> to the SurveyData. <code>fit1</code> contains the values of happiness that are predicted by the model, given each individual’s age.</p>
<div class="tip">
<p>An alternative way to plot this graph, consistent with the session on regression, would be to use the <code>augment()</code> function in the <code>broom</code> package.</p>
<pre class="sourceCode r"><code class="sourceCode r">broom<span class="op">::</span><span class="kw">augment</span>(model1) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y=</span>happiness)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>.fitted))</code></pre>
<p><img src="07-fitting-curves_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p><code>.fitted</code> are the predicted values computed by <code>augment()</code></p>
</div>
<div class="exercise">
<p>By visual inspection, does the model capture the trend in the data well?</p>
</div>
<p>According to the model, happiness increases with age in a linear fashion. However, it is clear from the plot that this straight line is <em>not</em> capturing the non-linear trend that is evident in our data.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fitting-curves-to-data-rather-than-straight-lines.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="adding-a-quadratic-component.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
