<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 6 ANOVA: Repeated measures | PSYC761 Data Analysis</title>
  <meta name="description" content="Course materials for PSYC761 2024" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 6 ANOVA: Repeated measures | PSYC761 Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for PSYC761 2024" />
  <meta name="github-repo" content="datafluencyCB" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 6 ANOVA: Repeated measures | PSYC761 Data Analysis" />
  
  <meta name="twitter:description" content="Course materials for PSYC761 2024" />
  

<meta name="author" content="Chris Berry" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple3.html"/>
<link rel="next" href="prepost.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PSYC761 Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="simple1.html"><a href="simple1.html"><i class="fa fa-check"></i><b>1</b> Simple Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simple1.html"><a href="simple1.html#overview-1"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="simple1.html"><a href="simple1.html#worked-example"><i class="fa fa-check"></i><b>1.2</b> Worked Example</a></li>
<li class="chapter" data-level="1.3" data-path="simple1.html"><a href="simple1.html#predicting"><i class="fa fa-check"></i><b>1.3</b> Predicting</a></li>
<li class="chapter" data-level="1.4" data-path="simple1.html"><a href="simple1.html#residuals"><i class="fa fa-check"></i><b>1.4</b> Residuals</a></li>
<li class="chapter" data-level="1.5" data-path="simple1.html"><a href="simple1.html#evaluating-the-model"><i class="fa fa-check"></i><b>1.5</b> Evaluating the model</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="simple1.html"><a href="simple1.html#r2"><i class="fa fa-check"></i><b>1.5.1</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="1.5.2" data-path="simple1.html"><a href="simple1.html#bayes-factor"><i class="fa fa-check"></i><b>1.5.2</b> Bayes factor</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="simple1.html"><a href="simple1.html#exercise"><i class="fa fa-check"></i><b>1.6</b> Exercise</a></li>
<li class="chapter" data-level="1.7" data-path="simple1.html"><a href="simple1.html#further-exercises"><i class="fa fa-check"></i><b>1.7</b> Further Exercises</a></li>
<li class="chapter" data-level="1.8" data-path="simple1.html"><a href="simple1.html#going-further-p-values"><i class="fa fa-check"></i><b>1.8</b> Going further: <em>p</em>-values</a></li>
<li class="chapter" data-level="1.9" data-path="simple1.html"><a href="simple1.html#summary"><i class="fa fa-check"></i><b>1.9</b> Summary</a></li>
<li class="chapter" data-level="1.10" data-path="simple1.html"><a href="simple1.html#references"><i class="fa fa-check"></i><b>1.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple1.html"><a href="multiple1.html"><i class="fa fa-check"></i><b>2</b> Multiple regression: multiple continuous predictors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="multiple1.html"><a href="multiple1.html#overview-2"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="multiple1.html"><a href="multiple1.html#worked-example-1"><i class="fa fa-check"></i><b>2.2</b> Worked example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="multiple1.html"><a href="multiple1.html#residual-plot"><i class="fa fa-check"></i><b>2.2.1</b> Residual plot</a></li>
<li class="chapter" data-level="2.2.2" data-path="multiple1.html"><a href="multiple1.html#evaluating-the-model-bayes-factor"><i class="fa fa-check"></i><b>2.2.2</b> Evaluating the model: Bayes factor</a></li>
<li class="chapter" data-level="2.2.3" data-path="multiple1.html"><a href="multiple1.html#evaluating-the-model-r2"><i class="fa fa-check"></i><b>2.2.3</b> Evaluating the model: R<sup>2</sup></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="multiple1.html"><a href="multiple1.html#understanding-the-contribution-of-individual-predictors"><i class="fa fa-check"></i><b>2.3</b> Understanding the contribution of individual predictors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="multiple1.html"><a href="multiple1.html#r2-in-simple-vs.-multiple-regression"><i class="fa fa-check"></i><b>2.3.1</b> R<sup>2</sup> in simple vs. multiple regression</a></li>
<li class="chapter" data-level="2.3.2" data-path="multiple1.html"><a href="multiple1.html#venn-diagrams"><i class="fa fa-check"></i><b>2.3.2</b> Venn Diagrams</a></li>
<li class="chapter" data-level="2.3.3" data-path="multiple1.html"><a href="multiple1.html#using-bayes-factors-to-assess-the-unique-contribution-of-predictors"><i class="fa fa-check"></i><b>2.3.3</b> Using Bayes factors to assess the unique contribution of predictors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="multiple1.html"><a href="multiple1.html#multicollinearity"><i class="fa fa-check"></i><b>2.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="2.5" data-path="multiple1.html"><a href="multiple1.html#exercise-1"><i class="fa fa-check"></i><b>2.5</b> Exercise</a></li>
<li class="chapter" data-level="2.6" data-path="multiple1.html"><a href="multiple1.html#further-exercises-1"><i class="fa fa-check"></i><b>2.6</b> Further exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="multiple1.html"><a href="multiple1.html#regressionbf"><i class="fa fa-check"></i><b>2.6.1</b> <code>regressionBF()</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="multiple1.html"><a href="multiple1.html#predicting-new-data"><i class="fa fa-check"></i><b>2.6.2</b> Predicting new data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="multiple1.html"><a href="multiple1.html#going-further-p-values-1"><i class="fa fa-check"></i><b>2.7</b> Going further: <em>p</em>-values</a></li>
<li class="chapter" data-level="2.8" data-path="multiple1.html"><a href="multiple1.html#summary-of-key-points"><i class="fa fa-check"></i><b>2.8</b> Summary of key points</a></li>
<li class="chapter" data-level="2.9" data-path="multiple1.html"><a href="multiple1.html#references-1"><i class="fa fa-check"></i><b>2.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova1.html"><a href="anova1.html"><i class="fa fa-check"></i><b>3</b> ANOVA: between-subjects designs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="anova1.html"><a href="anova1.html#overview-3"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="anova1.html"><a href="anova1.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>3.2</b> One-way between subjects ANOVA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="anova1.html"><a href="anova1.html#worked-example-2"><i class="fa fa-check"></i><b>3.2.1</b> Worked Example</a></li>
<li class="chapter" data-level="3.2.2" data-path="anova1.html"><a href="anova1.html#read-in-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Read in the data</a></li>
<li class="chapter" data-level="3.2.3" data-path="anova1.html"><a href="anova1.html#convert-the-independent-variable-to-a-factor"><i class="fa fa-check"></i><b>3.2.3</b> Convert the independent variable to a factor</a></li>
<li class="chapter" data-level="3.2.4" data-path="anova1.html"><a href="anova1.html#n-of-each-group"><i class="fa fa-check"></i><b>3.2.4</b> n of each group</a></li>
<li class="chapter" data-level="3.2.5" data-path="anova1.html"><a href="anova1.html#visualise-the-data"><i class="fa fa-check"></i><b>3.2.5</b> Visualise the data</a></li>
<li class="chapter" data-level="3.2.6" data-path="anova1.html"><a href="anova1.html#plot-the-means"><i class="fa fa-check"></i><b>3.2.6</b> Plot the means</a></li>
<li class="chapter" data-level="3.2.7" data-path="anova1.html"><a href="anova1.html#descriptives-mean-of-each-group"><i class="fa fa-check"></i><b>3.2.7</b> Descriptives: Mean of each group</a></li>
<li class="chapter" data-level="3.2.8" data-path="anova1.html"><a href="anova1.html#bayes-factor-1"><i class="fa fa-check"></i><b>3.2.8</b> Bayes factor</a></li>
<li class="chapter" data-level="3.2.9" data-path="anova1.html"><a href="anova1.html#r2-1"><i class="fa fa-check"></i><b>3.2.9</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="3.2.10" data-path="anova1.html"><a href="anova1.html#follow-up-tests"><i class="fa fa-check"></i><b>3.2.10</b> Follow-up tests</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="anova1.html"><a href="anova1.html#two-way-between-subjects-anova"><i class="fa fa-check"></i><b>3.3</b> Two-way between-subjects ANOVA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="anova1.html"><a href="anova1.html#worked-example-3"><i class="fa fa-check"></i><b>3.3.1</b> Worked example</a></li>
<li class="chapter" data-level="3.3.2" data-path="anova1.html"><a href="anova1.html#read-in-the-data-1"><i class="fa fa-check"></i><b>3.3.2</b> Read in the data</a></li>
<li class="chapter" data-level="3.3.3" data-path="anova1.html"><a href="anova1.html#convert-the-independent-variables-to-factors"><i class="fa fa-check"></i><b>3.3.3</b> Convert the independent variables to factors</a></li>
<li class="chapter" data-level="3.3.4" data-path="anova1.html"><a href="anova1.html#n-in-each-group"><i class="fa fa-check"></i><b>3.3.4</b> n in each group</a></li>
<li class="chapter" data-level="3.3.5" data-path="anova1.html"><a href="anova1.html#visualise-the-data-1"><i class="fa fa-check"></i><b>3.3.5</b> Visualise the data</a></li>
<li class="chapter" data-level="3.3.6" data-path="anova1.html"><a href="anova1.html#plot-the-means-1"><i class="fa fa-check"></i><b>3.3.6</b> Plot the means</a></li>
<li class="chapter" data-level="3.3.7" data-path="anova1.html"><a href="anova1.html#bayes-factors"><i class="fa fa-check"></i><b>3.3.7</b> Bayes factors</a></li>
<li class="chapter" data-level="3.3.8" data-path="anova1.html"><a href="anova1.html#r2-2"><i class="fa fa-check"></i><b>3.3.8</b> R<sup>2</sup></a></li>
<li class="chapter" data-level="3.3.9" data-path="anova1.html"><a href="anova1.html#follow-up-comparisons"><i class="fa fa-check"></i><b>3.3.9</b> Follow-up comparisons</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="anova1.html"><a href="anova1.html#exercise-one-way"><i class="fa fa-check"></i><b>3.4</b> Exercise: one-way</a></li>
<li class="chapter" data-level="3.5" data-path="anova1.html"><a href="anova1.html#exercise-two-way"><i class="fa fa-check"></i><b>3.5</b> Exercise: two-way</a></li>
<li class="chapter" data-level="3.6" data-path="anova1.html"><a href="anova1.html#summary-1"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
<li class="chapter" data-level="3.7" data-path="anova1.html"><a href="anova1.html#references-2"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple2.html"><a href="multiple2.html"><i class="fa fa-check"></i><b>4</b> Multiple regression: one continuous, one categorical</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple2.html"><a href="multiple2.html#overview-4"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="multiple2.html"><a href="multiple2.html#worked-example-4"><i class="fa fa-check"></i><b>4.2</b> Worked example</a></li>
<li class="chapter" data-level="4.3" data-path="multiple2.html"><a href="multiple2.html#read-in-the-data-2"><i class="fa fa-check"></i><b>4.3</b> Read in the data</a></li>
<li class="chapter" data-level="4.4" data-path="multiple2.html"><a href="multiple2.html#visualise-the-data-2"><i class="fa fa-check"></i><b>4.4</b> Visualise the data</a></li>
<li class="chapter" data-level="4.5" data-path="multiple2.html"><a href="multiple2.html#evidence-for-the-interaction"><i class="fa fa-check"></i><b>4.5</b> Evidence for the interaction</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="multiple2.html"><a href="multiple2.html#model-without-the-interaction"><i class="fa fa-check"></i><b>4.5.1</b> Model without the interaction</a></li>
<li class="chapter" data-level="4.5.2" data-path="multiple2.html"><a href="multiple2.html#model-with-the-interaction"><i class="fa fa-check"></i><b>4.5.2</b> Model with the interaction</a></li>
<li class="chapter" data-level="4.5.3" data-path="multiple2.html"><a href="multiple2.html#compare-the-model-with-and-without-the-interaction"><i class="fa fa-check"></i><b>4.5.3</b> Compare the model with and without the interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="multiple2.html"><a href="multiple2.html#simple-slopes-analysis"><i class="fa fa-check"></i><b>4.6</b> Simple slopes analysis</a></li>
<li class="chapter" data-level="4.7" data-path="multiple2.html"><a href="multiple2.html#exercises"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
<li class="chapter" data-level="4.8" data-path="multiple2.html"><a href="multiple2.html#further-exercise"><i class="fa fa-check"></i><b>4.8</b> Further exercise</a></li>
<li class="chapter" data-level="4.9" data-path="multiple2.html"><a href="multiple2.html#further-knowledge"><i class="fa fa-check"></i><b>4.9</b> Further knowledge</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="multiple2.html"><a href="multiple2.html#moderation"><i class="fa fa-check"></i><b>4.9.1</b> Moderation</a></li>
<li class="chapter" data-level="4.9.2" data-path="multiple2.html"><a href="multiple2.html#coefficients"><i class="fa fa-check"></i><b>4.9.2</b> Coefficients</a></li>
<li class="chapter" data-level="4.9.3" data-path="multiple2.html"><a href="multiple2.html#centering"><i class="fa fa-check"></i><b>4.9.3</b> Centering</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="multiple2.html"><a href="multiple2.html#summary-2"><i class="fa fa-check"></i><b>4.10</b> Summary</a></li>
<li class="chapter" data-level="4.11" data-path="multiple2.html"><a href="multiple2.html#references-3"><i class="fa fa-check"></i><b>4.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple3.html"><a href="multiple3.html"><i class="fa fa-check"></i><b>5</b> Multiple regression: hierarchical regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple3.html"><a href="multiple3.html#overview-5"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="multiple3.html"><a href="multiple3.html#worked-example-1-wellbeing"><i class="fa fa-check"></i><b>5.2</b> Worked example 1: wellbeing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple3.html"><a href="multiple3.html#read-in-the-data-3"><i class="fa fa-check"></i><b>5.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="5.2.2" data-path="multiple3.html"><a href="multiple3.html#visualisation"><i class="fa fa-check"></i><b>5.2.2</b> Visualisation</a></li>
<li class="chapter" data-level="5.2.3" data-path="multiple3.html"><a href="multiple3.html#correlations"><i class="fa fa-check"></i><b>5.2.3</b> Correlations</a></li>
<li class="chapter" data-level="5.2.4" data-path="multiple3.html"><a href="multiple3.html#hierarchical-regression"><i class="fa fa-check"></i><b>5.2.4</b> Hierarchical regression</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple3.html"><a href="multiple3.html#exercise-1-1"><i class="fa fa-check"></i><b>5.3</b> Exercise 1</a></li>
<li class="chapter" data-level="5.4" data-path="multiple3.html"><a href="multiple3.html#worked-exercise-2-controlling-for-categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Worked Exercise 2: Controlling for categorical variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple3.html"><a href="multiple3.html#visualisation-1"><i class="fa fa-check"></i><b>5.4.1</b> Visualisation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple3.html"><a href="multiple3.html#exercise-2"><i class="fa fa-check"></i><b>5.5</b> Exercise 2</a></li>
<li class="chapter" data-level="5.6" data-path="multiple3.html"><a href="multiple3.html#further-knowledge-and-exercises"><i class="fa fa-check"></i><b>5.6</b> Further knowledge and exercises</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="multiple3.html"><a href="multiple3.html#standardised-coefficients"><i class="fa fa-check"></i><b>5.6.1</b> Standardised Coefficients</a></li>
<li class="chapter" data-level="5.6.2" data-path="multiple3.html"><a href="multiple3.html#prediction"><i class="fa fa-check"></i><b>5.6.2</b> Prediction</a></li>
<li class="chapter" data-level="5.6.3" data-path="multiple3.html"><a href="multiple3.html#residuals-1"><i class="fa fa-check"></i><b>5.6.3</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="multiple3.html"><a href="multiple3.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="multiple3.html"><a href="multiple3.html#references-4"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova2.html"><a href="anova2.html"><i class="fa fa-check"></i><b>6</b> ANOVA: Repeated measures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova2.html"><a href="anova2.html#overview-6"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="anova2.html"><a href="anova2.html#one-way-repeated-measures-anova"><i class="fa fa-check"></i><b>6.2</b> One-way repeated measures ANOVA</a></li>
<li class="chapter" data-level="6.3" data-path="anova2.html"><a href="anova2.html#long-format-data"><i class="fa fa-check"></i><b>6.3</b> Long format data</a></li>
<li class="chapter" data-level="6.4" data-path="anova2.html"><a href="anova2.html#worked-example-5"><i class="fa fa-check"></i><b>6.4</b> Worked Example</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="anova2.html"><a href="anova2.html#read-in-the-data-4"><i class="fa fa-check"></i><b>6.4.1</b> Read in the data</a></li>
<li class="chapter" data-level="6.4.2" data-path="anova2.html"><a href="anova2.html#convert-the-data-to-long-format"><i class="fa fa-check"></i><b>6.4.2</b> Convert the data to long format</a></li>
<li class="chapter" data-level="6.4.3" data-path="anova2.html"><a href="anova2.html#convert-the-participant-and-the-categorical-variable-to-factors"><i class="fa fa-check"></i><b>6.4.3</b> Convert the participant and the categorical variable to factors</a></li>
<li class="chapter" data-level="6.4.4" data-path="anova2.html"><a href="anova2.html#visualise-the-data-3"><i class="fa fa-check"></i><b>6.4.4</b> Visualise the data</a></li>
<li class="chapter" data-level="6.4.5" data-path="anova2.html"><a href="anova2.html#plot-the-means-2"><i class="fa fa-check"></i><b>6.4.5</b> Plot the means</a></li>
<li class="chapter" data-level="6.4.6" data-path="anova2.html"><a href="anova2.html#descriptives-mean-of-each-condition"><i class="fa fa-check"></i><b>6.4.6</b> Descriptives: Mean of each condition</a></li>
<li class="chapter" data-level="6.4.7" data-path="anova2.html"><a href="anova2.html#bayes-factor-2"><i class="fa fa-check"></i><b>6.4.7</b> Bayes factor</a></li>
<li class="chapter" data-level="6.4.8" data-path="anova2.html"><a href="anova2.html#follow-up-tests-1"><i class="fa fa-check"></i><b>6.4.8</b> Follow-up tests</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="anova2.html"><a href="anova2.html#two-way-within-subjects-anova"><i class="fa fa-check"></i><b>6.5</b> Two-way within subjects ANOVA</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="anova2.html"><a href="anova2.html#worked-example-6"><i class="fa fa-check"></i><b>6.5.1</b> Worked Example</a></li>
<li class="chapter" data-level="6.5.2" data-path="anova2.html"><a href="anova2.html#read-in-the-data-5"><i class="fa fa-check"></i><b>6.5.2</b> Read in the data</a></li>
<li class="chapter" data-level="6.5.3" data-path="anova2.html"><a href="anova2.html#visualise-the-data-4"><i class="fa fa-check"></i><b>6.5.3</b> Visualise the data</a></li>
<li class="chapter" data-level="6.5.4" data-path="anova2.html"><a href="anova2.html#plot-the-means-3"><i class="fa fa-check"></i><b>6.5.4</b> Plot the means</a></li>
<li class="chapter" data-level="6.5.5" data-path="anova2.html"><a href="anova2.html#descriptive-statistics---mean"><i class="fa fa-check"></i><b>6.5.5</b> Descriptive statistics - mean</a></li>
<li class="chapter" data-level="6.5.6" data-path="anova2.html"><a href="anova2.html#convert-participant-and-categorical-variables-to-factors"><i class="fa fa-check"></i><b>6.5.6</b> Convert participant and categorical variables to factors</a></li>
<li class="chapter" data-level="6.5.7" data-path="anova2.html"><a href="anova2.html#bayes-factor-3"><i class="fa fa-check"></i><b>6.5.7</b> Bayes factor</a></li>
<li class="chapter" data-level="6.5.8" data-path="anova2.html"><a href="anova2.html#follow-up-comparisons-1"><i class="fa fa-check"></i><b>6.5.8</b> Follow up comparisons</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="anova2.html"><a href="anova2.html#exercise-two-way-mixed-anova"><i class="fa fa-check"></i><b>6.6</b> Exercise: two-way mixed ANOVA</a></li>
<li class="chapter" data-level="6.7" data-path="anova2.html"><a href="anova2.html#further-knowledge---within-subject-errorbars"><i class="fa fa-check"></i><b>6.7</b> Further knowledge - within-subject errorbars</a></li>
<li class="chapter" data-level="6.8" data-path="anova2.html"><a href="anova2.html#further-knowledge---r-squared"><i class="fa fa-check"></i><b>6.8</b> Further knowledge - R-squared</a></li>
<li class="chapter" data-level="6.9" data-path="anova2.html"><a href="anova2.html#summary-4"><i class="fa fa-check"></i><b>6.9</b> Summary</a></li>
<li class="chapter" data-level="6.10" data-path="anova2.html"><a href="anova2.html#references-5"><i class="fa fa-check"></i><b>6.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prepost.html"><a href="prepost.html"><i class="fa fa-check"></i><b>7</b> Pre-post data, clinically significant change</a>
<ul>
<li class="chapter" data-level="7.1" data-path="prepost.html"><a href="prepost.html#overview-7"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="prepost.html"><a href="prepost.html#worked-example-7"><i class="fa fa-check"></i><b>7.1.1</b> Worked example</a></li>
<li class="chapter" data-level="7.1.2" data-path="prepost.html"><a href="prepost.html#read-in-the-data-6"><i class="fa fa-check"></i><b>7.1.2</b> Read in the data</a></li>
<li class="chapter" data-level="7.1.3" data-path="prepost.html"><a href="prepost.html#plot-the-means-4"><i class="fa fa-check"></i><b>7.1.3</b> Plot the means</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="prepost.html"><a href="prepost.html#approach-1---difference-scores"><i class="fa fa-check"></i><b>7.2</b> Approach 1 - Difference scores</a></li>
<li class="chapter" data-level="7.3" data-path="prepost.html"><a href="prepost.html#approach-2---mixed-anova"><i class="fa fa-check"></i><b>7.3</b> Approach 2 - Mixed ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="prepost.html"><a href="prepost.html#approach-3---ancova"><i class="fa fa-check"></i><b>7.4</b> Approach 3 - ANCOVA</a></li>
<li class="chapter" data-level="7.5" data-path="prepost.html"><a href="prepost.html#which-approach-should-you-use"><i class="fa fa-check"></i><b>7.5</b> Which approach should you use?</a></li>
<li class="chapter" data-level="7.6" data-path="prepost.html"><a href="prepost.html#clinical-significance"><i class="fa fa-check"></i><b>7.6</b> Clinical Significance</a></li>
<li class="chapter" data-level="7.7" data-path="prepost.html"><a href="prepost.html#exercises-1"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
<li class="chapter" data-level="7.8" data-path="prepost.html"><a href="prepost.html#further-knowledge-1"><i class="fa fa-check"></i><b>7.8</b> Further Knowledge</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="prepost.html"><a href="prepost.html#reliable-change-rc-index"><i class="fa fa-check"></i><b>7.8.1</b> Reliable Change (RC) index</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="prepost.html"><a href="prepost.html#summary-5"><i class="fa fa-check"></i><b>7.9</b> Summary</a></li>
<li class="chapter" data-level="7.10" data-path="prepost.html"><a href="prepost.html#references-6"><i class="fa fa-check"></i><b>7.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed.html"><a href="mixed.html"><i class="fa fa-check"></i><b>8</b> Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mixed.html"><a href="mixed.html#overview-8"><i class="fa fa-check"></i><b>8.1</b> Overview</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mixed.html"><a href="mixed.html#worked-example-8"><i class="fa fa-check"></i><b>8.1.1</b> Worked example</a></li>
<li class="chapter" data-level="8.1.2" data-path="mixed.html"><a href="mixed.html#read-in-the-data-7"><i class="fa fa-check"></i><b>8.1.2</b> Read in the data</a></li>
<li class="chapter" data-level="8.1.3" data-path="mixed.html"><a href="mixed.html#plot-the-means-5"><i class="fa fa-check"></i><b>8.1.3</b> Plot the means</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mixed.html"><a href="mixed.html#approach-1---difference-scores-1"><i class="fa fa-check"></i><b>8.2</b> Approach 1 - Difference scores</a></li>
<li class="chapter" data-level="8.3" data-path="mixed.html"><a href="mixed.html#approach-2---mixed-anova-1"><i class="fa fa-check"></i><b>8.3</b> Approach 2 - Mixed ANOVA</a></li>
<li class="chapter" data-level="8.4" data-path="mixed.html"><a href="mixed.html#approach-3---ancova-1"><i class="fa fa-check"></i><b>8.4</b> Approach 3 - ANCOVA</a></li>
<li class="chapter" data-level="8.5" data-path="mixed.html"><a href="mixed.html#which-approach-should-you-use-1"><i class="fa fa-check"></i><b>8.5</b> Which approach should you use?</a></li>
<li class="chapter" data-level="8.6" data-path="mixed.html"><a href="mixed.html#clinical-significance-1"><i class="fa fa-check"></i><b>8.6</b> Clinical Significance</a></li>
<li class="chapter" data-level="8.7" data-path="mixed.html"><a href="mixed.html#exercises-2"><i class="fa fa-check"></i><b>8.7</b> Exercises</a></li>
<li class="chapter" data-level="8.8" data-path="mixed.html"><a href="mixed.html#further-knowledge-2"><i class="fa fa-check"></i><b>8.8</b> Further Knowledge</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="mixed.html"><a href="mixed.html#reliable-change-rc-index-1"><i class="fa fa-check"></i><b>8.8.1</b> Reliable Change (RC) index</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="mixed.html"><a href="mixed.html#summary-6"><i class="fa fa-check"></i><b>8.9</b> Summary</a></li>
<li class="chapter" data-level="8.10" data-path="mixed.html"><a href="mixed.html#references-7"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assessment2024.html"><a href="assessment2024.html"><i class="fa fa-check"></i><b>9</b> Data Analysis Assessment 2024</a></li>
<li class="chapter" data-level="10" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i><b>10</b> FAQs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="faqs.html"><a href="faqs.html#e-meaning"><i class="fa fa-check"></i><b>10.1</b> What does it mean if RStudio prints out "e-" next to a number?</a></li>
<li class="chapter" data-level="10.2" data-path="faqs.html"><a href="faqs.html#how-can-i-find-out-more-about-a-particular-function-so-i-can-explore-its-settings-etc."><i class="fa fa-check"></i><b>10.2</b> How can I find out more about a particular function, so I can explore its settings etc.?</a></li>
<li class="chapter" data-level="10.3" data-path="faqs.html"><a href="faqs.html#how-do-i-import-a-data-file-to-r-studio"><i class="fa fa-check"></i><b>10.3</b> How do I import a data file to R Studio?</a></li>
<li class="chapter" data-level="10.4" data-path="faqs.html"><a href="faqs.html#how-should-i-write-up-the-report"><i class="fa fa-check"></i><b>10.4</b> How should I write up the report?</a></li>
<li class="chapter" data-level="10.5" data-path="faqs.html"><a href="faqs.html#after-downloading-my-.rmd-file-to-my-computer-how-do-i-open-it-again-in-rstudio"><i class="fa fa-check"></i><b>10.5</b> After downloading my .Rmd file to my computer, how do I open it again in RStudio?</a></li>
<li class="chapter" data-level="10.6" data-path="faqs.html"><a href="faqs.html#on-the-word-count-are-figure-captions-included"><i class="fa fa-check"></i><b>10.6</b> On the word count, are figure captions included?</a></li>
<li class="chapter" data-level="10.7" data-path="faqs.html"><a href="faqs.html#should-i-make-code-visible-in-my-html-report"><i class="fa fa-check"></i><b>10.7</b> Should I make code visible in my html report?</a></li>
<li class="chapter" data-level="10.8" data-path="faqs.html"><a href="faqs.html#do-i-need-to-include-references"><i class="fa fa-check"></i><b>10.8</b> Do I need to include references?</a></li>
<li class="chapter" data-level="10.9" data-path="faqs.html"><a href="faqs.html#can-there-be-overlap-in-the-variables-used-in-each-question"><i class="fa fa-check"></i><b>10.9</b> Can there be overlap in the variables used in each question?</a></li>
<li class="chapter" data-level="10.10" data-path="faqs.html"><a href="faqs.html#do-we-have-to-include-a-certain-number-of-variables-to-achieve-a-good-grade"><i class="fa fa-check"></i><b>10.10</b> Do we have to include a certain number of variables to achieve a good grade?</a></li>
<li class="chapter" data-level="10.11" data-path="faqs.html"><a href="faqs.html#can-i-include-more-than-one-figure"><i class="fa fa-check"></i><b>10.11</b> Can I include more than one figure?</a></li>
<li class="chapter" data-level="10.12" data-path="faqs.html"><a href="faqs.html#can-i-include-categorical-predictor-variables-in-a-hierarchical-regression"><i class="fa fa-check"></i><b>10.12</b> Can I include categorical predictor variables in a hierarchical regression?</a></li>
<li class="chapter" data-level="10.13" data-path="faqs.html"><a href="faqs.html#how-do-i-apply-for-extenuating-circumstances"><i class="fa fa-check"></i><b>10.13</b> How do I apply for extenuating circumstances?</a></li>
<li class="chapter" data-level="10.14" data-path="faqs.html"><a href="faqs.html#can-a-book-a-slot-in-your-office-hours"><i class="fa fa-check"></i><b>10.14</b> Can a book a slot in your office hours?</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>11</b> Reading</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reading.html"><a href="reading.html#recommended-texts-and-resources"><i class="fa fa-check"></i><b>11.1</b> Recommended texts and resources</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="reading.html"><a href="reading.html#library-books"><i class="fa fa-check"></i><b>11.1.1</b> Library books</a></li>
<li class="chapter" data-level="11.1.2" data-path="reading.html"><a href="reading.html#electronic-resources-and-books"><i class="fa fa-check"></i><b>11.1.2</b> Electronic resources and books</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PSYC761 Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova2" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Session 6</span> ANOVA: Repeated measures<a href="anova2.html#anova2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Chris Berry</em><br />
<em>2024</em></p>
<!--
commented text
commented text
-->
<style>
div.exercise { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<style>
div.tip { background-color:#D5F5E3; border-radius: 5px; padding: 20px;}
</style>
<div id="overview-6" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Overview<a href="anova2.html#overview-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>Slides</strong> from the lecture part of the session: <a href="slides/PSYC761_L6_ANOVA_2.pptx">Download</a></li>
<li><strong>R Studio online</strong> <a href="https://psyrstudio.plymouth.ac.uk/">Access here using University log-in</a></li>
</ul>
<p><br />
</p>
<p>Previously, we saw that when all of the predictor variables in a multiple regression are categorical then the analysis has the name ANOVA (in Session 3).</p>
<p>Here we will analyse <em>repeated measures</em> (or <em>within-subjects</em>) designs with ANOVA. In a repeated measures design, the scores for the different levels of an independent variable come from the same participants, rather than separate groups of participants.</p>
<p>We consider two types of ANOVA for within-subjects designs: one-way ANOVA and two-way factorial ANOVA.</p>
<p>The methods are similar to those in Session 3, where we analysed between-subjects designs with ANOVA.</p>
<p>The exercise at the end is for a mixed factorial design, where one of the factors is manipulated between-subjects, and the other is manipulated within-subjects.</p>
<p><br />
</p>
</div>
<div id="one-way-repeated-measures-anova" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> One-way repeated measures ANOVA<a href="anova2.html#one-way-repeated-measures-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="tip">
<p><strong>A one-way repeated measures ANOVA</strong> is used to compare the scores from a dependent variable for the same individuals across different time points. For example, do depression scores differ in a group of individuals across three time points: before CBT therapy, during therapy, and 1 year after therapy?</p>
<p><strong>One-way within-subjects ANOVA</strong> refers to the same analysis. The scores for each level of the independent variable manipulated within-subjects come from the same group of participants. For example, we can say that the independent variable of <em>time</em> is manipulated <em>within-subjects</em>.</p>
</div>
<p><br />
</p>
<ul>
<li><strong>One-way</strong> means that there is one independent variable, for example, <em>time</em>.</li>
<li>Independent variables are also called <strong>factors</strong> in ANOVA.</li>
<li>A factor is made up of different <strong>levels</strong>. <em>Time</em> could have three levels: before, during and after therapy.</li>
<li>In repeated measures/within-subjects designs, these levels are often referred to as <strong>conditions</strong>.</li>
<li><strong>Repeated measures</strong> means that the same dependent variable (depression score) is measured multiple times on the same participant. Here, it's measured at different time points. Each participant provides multiple measurements.</li>
</ul>
<p><br />
</p>
</div>
<div id="long-format-data" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Long format data<a href="anova2.html#long-format-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To conduct a repeated measures ANOVA in R, the data must be in <strong>long format</strong>. This is crucial.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Exercise 6.1  </strong></span>Wide vs. long format</p>
<ul>
<li>When the data are in <em>wide</em> format, all of the data for a single participant is stored:</li>
</ul>
<div id="radio_FIEOOFYXUC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FIEOOFYXUC" value="answer"></input> <span>on one row, across multiple columns</span></label><label><input type="radio" autocomplete="off" name="radio_FIEOOFYXUC" value=""></input> <span>on multiple rows, with each row representing a separate observation</span></label>
</div>
<p><br />
</p>
<ul>
<li>When the data are in <em>long</em> format, all of the data for a single participant is stored:</li>
</ul>
<div id="radio_MAEZXJXXSU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MAEZXJXXSU" value=""></input> <span>on one row, across multiple columns</span></label><label><input type="radio" autocomplete="off" name="radio_MAEZXJXXSU" value="answer"></input> <span>on multiple rows, with each row representing a separate observation</span></label>
</div>
</div>
<p><br />
</p>
</div>
<div id="worked-example-5" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Worked Example<a href="anova2.html#worked-example-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In an investigation of language learning, Chang et al., (2021) provided neuro-feedback training to 6 individuals attempting to discriminate particular sounds in a foreign language. Performance was measured as the proportion of correct responses in the discrimination task, and was measured at three time points relative to when the training was administered: before training was given (<code>pre</code>), after 3 days (<code>day3</code>), and after two months (<code>month2</code>).</p>
<p><br />
</p>
<p>The data are at the link below:</p>
<p><a href="https://raw.githubusercontent.com/chrisjberry/Teaching/master/6a_discrimination_test.csv" class="uri">https://raw.githubusercontent.com/chrisjberry/Teaching/master/6a_discrimination_test.csv</a></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-2" class="exercise"><strong>Exercise 6.2  </strong></span>Design check.</p>
<ul>
<li><p>What is the independent variable (or <em>factor</em>) in this design? <select class='webex-select'><option value='blank'></option><option value=''>proportion correct</option><option value='answer'>time since training</option></select></p></li>
<li><p>How many levels does the factor have? <select class='webex-select'><option value='blank'></option><option value=''>1</option><option value=''>2</option><option value='answer'>3</option><option value=''>4</option></select></p></li>
<li><p>What is the dependent variable? <select class='webex-select'><option value='blank'></option><option value='answer'>proportion correct</option><option value=''>time</option></select></p></li>
<li><p>What is the nature of the independent variable? <select class='webex-select'><option value='blank'></option><option value='answer'>categorical</option><option value=''>continuous</option></select></p></li>
<li><p>Is the independent variable manipulated within- or between-subjects?
<select class='webex-select'><option value='blank'></option><option value=''>between-subjects</option><option value='answer'>within-subjects</option></select></p></li>
</ul>
</div>
<p><br />
</p>
<div id="read-in-the-data-4" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Read in the data<a href="anova2.html#read-in-the-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="anova2.html#cb1-1" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb1-2"><a href="anova2.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="anova2.html#cb1-3" tabindex="-1"></a><span class="co"># read in the data</span></span>
<span id="cb1-4"><a href="anova2.html#cb1-4" tabindex="-1"></a>discriminate_wide <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/6a_discrimination_test.csv&#39;</span>)</span>
<span id="cb1-5"><a href="anova2.html#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="anova2.html#cb1-6" tabindex="-1"></a><span class="co"># look at the data</span></span>
<span id="cb1-7"><a href="anova2.html#cb1-7" tabindex="-1"></a>discriminate_wide</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">ppt</th>
<th align="right">pre</th>
<th align="right">day3</th>
<th align="right">month2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.56</td>
<td align="right">0.63</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.71</td>
<td align="right">0.79</td>
<td align="right">0.76</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.53</td>
<td align="right">0.86</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.56</td>
<td align="right">0.81</td>
<td align="right">0.77</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.49</td>
<td align="right">0.85</td>
<td align="right">0.84</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.55</td>
<td align="right">0.84</td>
<td align="right">0.84</td>
</tr>
</tbody>
</table>
</div>
<p>Columns:</p>
<ul>
<li><code>ppt</code>: the participant number</li>
<li><code>pre</code>: proportion correct before training</li>
<li><code>day3</code>: proportion correct 3 days after training</li>
<li><code>month2</code>: proportion correct 2 months after training</li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Exercise 6.3  </strong></span>Data check</p>
<ul>
<li><p>How many participants are there in this dataset? <select class='webex-select'><option value='blank'></option><option value=''>3</option><option value=''>4</option><option value='answer'>6</option><option value=''>18</option></select></p></li>
<li><p>Are the data in long format or wide format? <select class='webex-select'><option value='blank'></option><option value=''>long</option><option value='answer'>wide</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>The data for each of the 6 participants is on a different row in <code>discriminate_wide</code>, with the scores for each level of the independent variable <em>time</em> in different columns. The data are therefore in <strong>wide format</strong>.</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="convert-the-data-to-long-format" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Convert the data to long format<a href="anova2.html#convert-the-data-to-long-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data must be in <em>long format</em> in order to be analysed using a repeated measures ANOVA.</p>
<p>Use <code>pivot_longer()</code> to convert the data to long format:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="anova2.html#cb2-1" tabindex="-1"></a><span class="co"># The code below:</span></span>
<span id="cb2-2"><a href="anova2.html#cb2-2" tabindex="-1"></a><span class="co"># - stores the result in discriminate_long</span></span>
<span id="cb2-3"><a href="anova2.html#cb2-3" tabindex="-1"></a><span class="co"># - takes discriminate_wide and pipes it to</span></span>
<span id="cb2-4"><a href="anova2.html#cb2-4" tabindex="-1"></a><span class="co"># - pivot_longer()</span></span>
<span id="cb2-5"><a href="anova2.html#cb2-5" tabindex="-1"></a><span class="co"># - specifies which of the existing columns to make into a new single column</span></span>
<span id="cb2-6"><a href="anova2.html#cb2-6" tabindex="-1"></a><span class="co"># - specifies the name of the new column labeling the conditions</span></span>
<span id="cb2-7"><a href="anova2.html#cb2-7" tabindex="-1"></a><span class="co"># - specifies the name of the column containing the dependent variable</span></span>
<span id="cb2-8"><a href="anova2.html#cb2-8" tabindex="-1"></a>discriminate_long <span class="ot">&lt;-</span></span>
<span id="cb2-9"><a href="anova2.html#cb2-9" tabindex="-1"></a>  discriminate_wide <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="anova2.html#cb2-10" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;day3&quot;</span>, <span class="st">&quot;month2&quot;</span>),</span>
<span id="cb2-11"><a href="anova2.html#cb2-11" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb2-12"><a href="anova2.html#cb2-12" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;performance&quot;</span>)</span>
<span id="cb2-13"><a href="anova2.html#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="anova2.html#cb2-14" tabindex="-1"></a><span class="co"># look at the first 6 rows</span></span>
<span id="cb2-15"><a href="anova2.html#cb2-15" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">ppt</th>
<th align="left">time</th>
<th align="right">performance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">pre</td>
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">day3</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">month2</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">pre</td>
<td align="right">0.71</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">day3</td>
<td align="right">0.79</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">month2</td>
<td align="right">0.76</td>
</tr>
</tbody>
</table>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-4" class="exercise"><strong>Exercise 6.4  </strong></span>Data check - long</p>
<ul>
<li><p>How many participants are there in <code>discriminate_long</code>? <select class='webex-select'><option value='blank'></option><option value=''>2</option><option value=''>4</option><option value='answer'>6</option><option value=''>18</option></select></p></li>
<li><p>Are the data in <code>discriminate_long</code> in long format or wide format? <select class='webex-select'><option value='blank'></option><option value='answer'>long</option><option value=''>wide</option></select></p></li>
<li><p>How many rows or observations are there in <code>discriminate_long</code>? <select class='webex-select'><option value='blank'></option><option value=''>3</option><option value=''>4</option><option value=''>6</option><option value='answer'>18</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>Each score is now on a separate row. There is a column to code the participant and condition. The data are therefore in <strong>long format</strong>. Each participant contributes 3 scores (one for <code>pre</code>, <code>day3</code> and <code>month2</code>).</p>
</div>
<ul>
<li><p>In <code>discriminate_long</code>, what type of variable is <code>ppt</code> currently? <select class='webex-select'><option value='blank'></option><option value=''><fct> factor</option><option value=''><chr> character</option><option value='answer'><dbl> double (numeric)</option></select> <em>Hint. Look at the label at the top of each column, e.g., <code>&lt;dbl&gt;</code></em></p></li>
<li><p>In <code>discriminate_long</code>, what type of variable is <code>time</code> currently? <select class='webex-select'><option value='blank'></option><option value=''><fct> factor</option><option value='answer'><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
</ul>
</div>
<p><br />
</p>
</div>
<div id="convert-the-participant-and-the-categorical-variable-to-factors" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Convert the participant and the categorical variable to factors<a href="anova2.html#convert-the-participant-and-the-categorical-variable-to-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with the analysis of categorical variables in regression and ANOVA, each categorical variable must be converted to a factor before the analysis.</p>
<p>Importantly, in repeated measures designs, <strong>the column of participant labels <code>ppt</code> must also be converted to a factor</strong>.</p>
<p>Because the levels of <code>time</code> are ordered, we can additionally specify the way the levels should be ordered by using <code>levels = c("level_1_name", "level_2_name", "level_3_name")</code> when using <code>factor()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="anova2.html#cb3-1" tabindex="-1"></a><span class="co"># use mutate() to transform </span></span>
<span id="cb3-2"><a href="anova2.html#cb3-2" tabindex="-1"></a><span class="co"># both ppt and time to factor</span></span>
<span id="cb3-3"><a href="anova2.html#cb3-3" tabindex="-1"></a><span class="co"># and overwrite existing variables</span></span>
<span id="cb3-4"><a href="anova2.html#cb3-4" tabindex="-1"></a>discriminate_long <span class="ot">&lt;-</span></span>
<span id="cb3-5"><a href="anova2.html#cb3-5" tabindex="-1"></a>  discriminate_long <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="anova2.html#cb3-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ppt  =</span> <span class="fu">factor</span>(ppt),</span>
<span id="cb3-7"><a href="anova2.html#cb3-7" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;day3&quot;</span>, <span class="st">&quot;month2&quot;</span>) ) )</span>
<span id="cb3-8"><a href="anova2.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="anova2.html#cb3-9" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb3-10"><a href="anova2.html#cb3-10" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">ppt</th>
<th align="left">time</th>
<th align="right">performance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">pre</td>
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">day3</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">month2</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">pre</td>
<td align="right">0.71</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">day3</td>
<td align="right">0.79</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">month2</td>
<td align="right">0.76</td>
</tr>
</tbody>
</table>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-5" class="exercise"><strong>Exercise 6.5  </strong></span>Data check - factors</p>
<p>After using <code>mutate()</code> and <code>factor()</code> above:</p>
<ul>
<li><p>In <code>discriminate_long</code>, what type of variable is <code>ppt</code>? <select class='webex-select'><option value='blank'></option><option value='answer'><fct> factor</option><option value=''><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
<li><p>In <code>discriminate_long</code>, what type of variable is <code>time</code>? <select class='webex-select'><option value='blank'></option><option value='answer'><fct> factor</option><option value=''><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
</ul>
</div>
</div>
<p><br />
</p>
</div>
<div id="visualise-the-data-3" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Visualise the data<a href="anova2.html#visualise-the-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look at the distribution of the dependent variable in each condition.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="anova2.html#cb4-1" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="anova2.html#cb4-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> performance)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="anova2.html#cb4-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> time) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="anova2.html#cb4-4" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-5-1.png" alt="Density plots of performance at each time point" width="75%" />
<p class="caption">
Figure 6.1: Density plots of performance at each time point
</p>
</div>
<p>The density plots look a little 'lumpy'. Remember that in our sample, there are only six data points per condition, so the plots are unlikely to be representative of the true (population) distribution of scores!</p>
<p><br />
</p>
</div>
<div id="plot-the-means-2" class="section level3 hasAnchor" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> Plot the means<a href="anova2.html#plot-the-means-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="anova2.html#cb5-1" tabindex="-1"></a><span class="co"># load the ggpubr package</span></span>
<span id="cb5-2"><a href="anova2.html#cb5-2" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb5-3"><a href="anova2.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="anova2.html#cb5-4" tabindex="-1"></a><span class="co"># use ggline() to plot the means</span></span>
<span id="cb5-5"><a href="anova2.html#cb5-5" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="anova2.html#cb5-6" tabindex="-1"></a>  <span class="fu">ggline</span>(<span class="at">x =</span> <span class="st">&quot;time&quot;</span> , <span class="at">y =</span> <span class="st">&quot;performance&quot;</span>, <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="anova2.html#cb5-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Performance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="anova2.html#cb5-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-6-1.png" alt="Mean proportion correct at each time point" width="75%" />
<p class="caption">
Figure 6.2: Mean proportion correct at each time point
</p>
</div>
<div class="webex-solution">
<button>
Error bars
</button>
<p>Previously, we used <code>desc_stat = "mean_se"</code> to add errorbars to the plot. Doing so here would add error bars representing the standard error of the mean to each of the points in the plot. These are appropriate for between-subjects designs, but for within-subjects designs, these are not as appropriate. Refer to the Further Knowledge section at the end of the worksheet to see how to add within-subject error bars (and see Morey, 2008, for more detail).</p>
</div>
<div class="webex-solution">
<button>
the same plot with ggplot
</button>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="anova2.html#cb6-1" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="anova2.html#cb6-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time , <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="anova2.html#cb6-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="anova2.html#cb6-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="anova2.html#cb6-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Performance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="anova2.html#cb6-6" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="anova2.html#cb6-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-7-1.png" alt="Mean proportion correct at each time point" width="75%" />
<p class="caption">
Figure 6.3: Mean proportion correct at each time point
</p>
</div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-6" class="exercise"><strong>Exercise 6.6  </strong></span>Describe the trend shown in the line plot:</p>
<ul>
<li>Between <code>pre</code> and <code>day3</code>, performance appeared to <select class='webex-select'><option value='blank'></option><option value='answer'>improve</option><option value=''>show no change</option><option value=''>decline</option></select></li>
<li>Between <code>pre</code> and <code>month2</code>, performance appeared to <select class='webex-select'><option value='blank'></option><option value='answer'>improve</option><option value=''>show no change</option><option value=''>decline</option></select></li>
<li>Between <code>day3</code> and <code>month2</code>, performance appeared to <select class='webex-select'><option value='blank'></option><option value=''>improve</option><option value='answer'>show no change</option><option value=''>decline</option></select></li>
</ul>
</div>
<p><br />
</p>
</div>
<div id="descriptives-mean-of-each-condition" class="section level3 hasAnchor" number="6.4.6">
<h3><span class="header-section-number">6.4.6</span> Descriptives: Mean of each condition<a href="anova2.html#descriptives-mean-of-each-condition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Obtain the mean proportion correct at each time point using <code>summarise()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="anova2.html#cb7-1" tabindex="-1"></a>discriminate_long <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="anova2.html#cb7-2" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="anova2.html#cb7-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">mean</span>(performance))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">time</th>
<th align="right">M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pre</td>
<td align="right">0.5666667</td>
</tr>
<tr class="even">
<td align="left">day3</td>
<td align="right">0.7966667</td>
</tr>
<tr class="odd">
<td align="left">month2</td>
<td align="right">0.7966667</td>
</tr>
</tbody>
</table>
</div>
<p><br />
</p>
</div>
<div id="bayes-factor-2" class="section level3 hasAnchor" number="6.4.7">
<h3><span class="header-section-number">6.4.7</span> Bayes factor<a href="anova2.html#bayes-factor-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The crucial difference in repeated measures designs compared to between-subjects ones concerns the column labeling the participant, <code>ppt</code>.</p>
<ul>
<li><code>ppt</code> is entered into the model as another predictor variable, i.e., using <code>...+ ppt</code>.</li>
<li><code>ppt</code> is specified as a <em>random factor</em> using <code>whichRandom =</code>. This means that the model comprising the other predictors in the model will be evaluated relative to the null model containing <code>ppt</code> alone. <code>ppt</code> is not individually evaluated.</li>
</ul>
<p>The Bayes factors can be obtained with <code>anovaBF()</code> but can also be obtained (less conveniently) using <code>lmBF()</code>.</p>
<p><br />
</p>
<p>Using <code>anovaBF()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="anova2.html#cb8-1" tabindex="-1"></a><span class="co"># library(BayesFactor)</span></span>
<span id="cb8-2"><a href="anova2.html#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="anova2.html#cb8-3" tabindex="-1"></a><span class="fu">anovaBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(discriminate_long))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 328.3671 0.5%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>In the output, the Bayes factor provided is for the model of <code>performance ~ time + ppt</code> vs. the model of <code>performance ~ ppt</code>. The latter is the null model containing only <code>ppt</code> as a predictor variable. The Bayes factor therefore represents evidence for the (unique) effect of <code>time</code> on performance, over and above a model containing <code>ppt</code> only. This differs to between-subject designs, where the null model (in the denominator) is the intercept-only model (representing the grand mean).</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-7" class="exercise"><strong>Exercise 6.7  </strong></span>The Bayes factor for the effect of time on performance is <input class='webex-solveme nospaces' data-tol='15' size='3' data-answer='["331"]'/></p>
<p><br />
</p>
<p>This indicates that (select one):</p>
<div id="radio_EVRZEIAGHR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EVRZEIAGHR" value="answer"></input> <span>it is approximately 300 times more likely that there is difference between the means of the three time conditions, compared to there being no difference.</span></label><label><input type="radio" autocomplete="off" name="radio_EVRZEIAGHR" value=""></input> <span>it is approximately 300 times more likely that there is no difference between the means of the three time conditions, compared to there being a difference.</span></label>
</div>
<p><br />
</p>
<p>On the basis of the Bayes factor analysis, does neuro-feedback training affect performance in the language learning task? <select class='webex-select'><option value='blank'></option><option value='answer'>yes</option><option value=''>no</option></select></p>
</div>
<div class="webex-solution">
<button>
Equivalent BFs using lmBF()
</button>
<p>It is possible to obtain the same result as <code>anovaBF()</code> using <code>lmBF()</code>. Doing so can help us to understand what <code>anovaBF()</code> is doing. Again, we must tell <code>lmBF()</code> that <code>ppt</code> is a random factor, using <code>whichRandom =</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="anova2.html#cb10-1" tabindex="-1"></a><span class="co"># Equivalent results with lmBF()</span></span>
<span id="cb10-2"><a href="anova2.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="anova2.html#cb10-3" tabindex="-1"></a><span class="co"># model with time and ppt only</span></span>
<span id="cb10-4"><a href="anova2.html#cb10-4" tabindex="-1"></a>BF_time_ppt <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(discriminate_long))</span>
<span id="cb10-5"><a href="anova2.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="anova2.html#cb10-6" tabindex="-1"></a><span class="co"># model with ppt only</span></span>
<span id="cb10-7"><a href="anova2.html#cb10-7" tabindex="-1"></a>BF_ppt_only <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(performance <span class="sc">~</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(discriminate_long))</span>
<span id="cb10-8"><a href="anova2.html#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="anova2.html#cb10-9" tabindex="-1"></a><span class="co"># compare model with vs. without time</span></span>
<span id="cb10-10"><a href="anova2.html#cb10-10" tabindex="-1"></a>BF_time_ppt <span class="sc">/</span> BF_ppt_only</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 330.4091 0.52%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>This produces a Bayes factor of approximately 330. This is equivalent to the BF obtained with <code>anovaBF()</code>, though note that because of the random data sampling methods used to generate the Bayes factors, the value may differ by a small amount.</p>
</div>
<p><br />
</p>
</div>
<div id="follow-up-tests-1" class="section level3 hasAnchor" number="6.4.8">
<h3><span class="header-section-number">6.4.8</span> Follow-up tests<a href="anova2.html#follow-up-tests-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Bayes factor obtained with <code>anovaBF()</code> above tells us that there's a difference between the means of the conditions, but not which conditions differ from which.</p>
<p>To determine which conditions differ from which, filter the data for the conditions of interest, then use <code>anovaBF()</code> in exactly the same way as before, but this time with relevant filtered data.</p>
<p><br />
</p>
<div id="pre-vs.-day3-conditions" class="section level4 hasAnchor" number="6.4.8.1">
<h4><span class="header-section-number">6.4.8.1</span> Pre vs. day3 conditions<a href="anova2.html#pre-vs.-day3-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="anova2.html#cb12-1" tabindex="-1"></a><span class="co"># pre vs. day3 </span></span>
<span id="cb12-2"><a href="anova2.html#cb12-2" tabindex="-1"></a><span class="co"># filter the data for the relevant conditions</span></span>
<span id="cb12-3"><a href="anova2.html#cb12-3" tabindex="-1"></a>pre_v_day3 <span class="ot">&lt;-</span> discriminate_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="st">&quot;pre&quot;</span> <span class="sc">|</span> time <span class="sc">==</span> <span class="st">&quot;day3&quot;</span>)</span>
<span id="cb12-4"><a href="anova2.html#cb12-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-5"><a href="anova2.html#cb12-5" tabindex="-1"></a><span class="co"># compare the means of the conditions, using anovaBF()</span></span>
<span id="cb12-6"><a href="anova2.html#cb12-6" tabindex="-1"></a><span class="fu">anovaBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_day3))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 84.54642 3.41%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The Bayes factor for the comparison of mean performance in the <code>pre</code> and <code>day3</code> conditions is <input class='webex-solveme nospaces' data-tol='6' size='5' data-answer='["79.15"]'/>. <em>Note. Your BF may differ slightly from the one above due to the random sampling methods anovaBF() uses.</em></li>
<li>This indicates that there is <select class='webex-select'><option value='blank'></option><option value='answer'>substantial</option><option value=''>inconclusive</option></select> evidence for <select class='webex-select'><option value='blank'></option><option value=''>no difference</option><option value='answer'>a difference</option></select> between the performance in the <code>pre</code> and <code>day3</code> conditions.</li>
<li>Performance at <code>day3</code> was <select class='webex-select'><option value='blank'></option><option value='answer'>higher</option><option value=''>lower</option></select> than performance <code>pre</code> training.</li>
</ul>
<p><br />
</p>
</div>
<div id="pre-vs.-month2-conditions" class="section level4 hasAnchor" number="6.4.8.2">
<h4><span class="header-section-number">6.4.8.2</span> Pre vs. month2 conditions<a href="anova2.html#pre-vs.-month2-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="anova2.html#cb14-1" tabindex="-1"></a><span class="co"># pre vs. month2</span></span>
<span id="cb14-2"><a href="anova2.html#cb14-2" tabindex="-1"></a><span class="co"># filter the data for these conditions</span></span>
<span id="cb14-3"><a href="anova2.html#cb14-3" tabindex="-1"></a>pre_v_month2 <span class="ot">&lt;-</span> discriminate_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="st">&quot;pre&quot;</span> <span class="sc">|</span> time <span class="sc">==</span> <span class="st">&quot;month2&quot;</span>) </span>
<span id="cb14-4"><a href="anova2.html#cb14-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-5"><a href="anova2.html#cb14-5" tabindex="-1"></a><span class="co"># compare the means of the conditions, using anovaBF() </span></span>
<span id="cb14-6"><a href="anova2.html#cb14-6" tabindex="-1"></a><span class="fu">anovaBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_month2))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 54.08763 0.8%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The Bayes factor for the comparison of mean performance in the <code>pre</code> and <code>month2</code> conditions is <input class='webex-solveme nospaces' data-tol='6' size='5' data-answer='["54.14"]'/></li>
<li>This indicates that there is <select class='webex-select'><option value='blank'></option><option value='answer'>substantial</option><option value=''>inconclusive</option></select> evidence for <select class='webex-select'><option value='blank'></option><option value=''>no difference</option><option value='answer'>a difference</option></select> between the mean performance in the <code>pre</code> and <code>month2</code> conditions.</li>
<li>Performance at <code>month2</code> was <select class='webex-select'><option value='blank'></option><option value='answer'>higher</option><option value=''>lower</option></select> than performance <code>pre</code> training.</li>
</ul>
<p><br />
</p>
</div>
<div id="day3-vs.-month2-conditions" class="section level4 hasAnchor" number="6.4.8.3">
<h4><span class="header-section-number">6.4.8.3</span> day3 vs. month2 conditions<a href="anova2.html#day3-vs.-month2-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="anova2.html#cb16-1" tabindex="-1"></a><span class="co"># day3 vs. month2</span></span>
<span id="cb16-2"><a href="anova2.html#cb16-2" tabindex="-1"></a><span class="co"># filter the data for these conditions</span></span>
<span id="cb16-3"><a href="anova2.html#cb16-3" tabindex="-1"></a>day3_v_month2 <span class="ot">&lt;-</span> discriminate_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">==</span> <span class="st">&quot;day3&quot;</span> <span class="sc">|</span> time <span class="sc">==</span> <span class="st">&quot;month2&quot;</span>) </span>
<span id="cb16-4"><a href="anova2.html#cb16-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb16-5"><a href="anova2.html#cb16-5" tabindex="-1"></a><span class="co"># compare the means of the conditions, using anovaBF()</span></span>
<span id="cb16-6"><a href="anova2.html#cb16-6" tabindex="-1"></a><span class="fu">anovaBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(day3_v_month2))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 0.4599532 1.06%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>The Bayes factor for the comparison of mean performance in the <code>day3</code> and <code>month2</code> conditions is <input class='webex-solveme nospaces' data-tol='0.1' size='4' data-answer='["0.46",".46"]'/></li>
<li>This indicates that there is <select class='webex-select'><option value='blank'></option><option value=''>substantial</option><option value='answer'>inconclusive</option></select> evidence for <select class='webex-select'><option value='blank'></option><option value='answer'>an absence of a difference</option><option value=''>a difference</option></select> between the mean performance in the <code>day3</code> and <code>month2</code> conditions.</li>
<li>Thus, there's no evidence of a difference in performance between the <code>day3</code> and <code>month2</code> conditions.</li>
</ul>
<div class="webex-solution">
<button>
Equivalent results with lmBF()
</button>
<p>As before, it's possible to conduct the same comparisons and obtain the same BFs using <code>lmBF()</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="anova2.html#cb18-1" tabindex="-1"></a><span class="co"># pre vs. day3</span></span>
<span id="cb18-2"><a href="anova2.html#cb18-2" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_day3)) <span class="sc">/</span></span>
<span id="cb18-3"><a href="anova2.html#cb18-3" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_day3))</span>
<span id="cb18-4"><a href="anova2.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="anova2.html#cb18-5" tabindex="-1"></a><span class="co"># pre vs. month2</span></span>
<span id="cb18-6"><a href="anova2.html#cb18-6" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_month2)) <span class="sc">/</span></span>
<span id="cb18-7"><a href="anova2.html#cb18-7" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(pre_v_month2))</span>
<span id="cb18-8"><a href="anova2.html#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="anova2.html#cb18-9" tabindex="-1"></a><span class="co"># day3 vs. month2</span></span>
<span id="cb18-10"><a href="anova2.html#cb18-10" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> time <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(day3_v_month2)) <span class="sc">/</span></span>
<span id="cb18-11"><a href="anova2.html#cb18-11" tabindex="-1"></a><span class="fu">lmBF</span>(performance <span class="sc">~</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(day3_v_month2))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] time + ppt : 80.80403 0.81%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS
## 
## Bayes factor analysis
## --------------
## [1] time + ppt : 53.96774 0.89%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS
## 
## Bayes factor analysis
## --------------
## [1] time + ppt : 0.4779222 1.78%
## 
## Against denominator:
##   performance ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
</div>
<p><br />
</p>
</div>
</div>
</div>
<div id="two-way-within-subjects-anova" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Two-way within subjects ANOVA<a href="anova2.html#two-way-within-subjects-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="tip">
<p>In a <strong>two-way repeated measures or within-subjects ANOVA</strong>, there are <em>two</em> categorical independent variables or factors.</p>
<p>When there are multiple factors, the ANOVA is referred to as <em>factorial</em> ANOVA.</p>
<p>For example, if the design has two factors, and each factor has two levels, then we refer to the design as a 2 x 2 factorial design. The first number (2) denotes the number of levels of the first factor. The second number (2) denotes the number of levels of the second factor. If, instead, the second factor had three levels, we'd say we have a 2 x 3 factorial design.</p>
<p>The <strong>cells</strong> of the design are produced by crossing the levels of one factor with each level of the other factor. If both factors are manipulated within-subjects, then the scores from each cell of the design come from the same group of participants. For example, in a 2 x 2 factorial design, there will be four cells of the design.</p>
</div>
<p><br />
</p>
<div id="worked-example-6" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Worked Example<a href="anova2.html#worked-example-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kreysa et al. (2016) analysed RTs to statements made by faces that had different gaze directions - the eyes of the face were either averted to the left, averted to the right, or were looking directly at the participant when the statement was made. RTs were further broken down according to whether the participant had agreed with the statement or not (they responded 'yes' or 'no').</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-8" class="exercise"><strong>Exercise 6.8  </strong></span>Design check.</p>
<ul>
<li><p>What is the first independent variable (or <em>factor</em>) that is mentioned in this design? <select class='webex-select'><option value='blank'></option><option value=''>RT</option><option value='answer'>gaze direction</option><option value=''>agreement with statement</option></select></p></li>
<li><p>How many levels does the first factor have? <select class='webex-select'><option value='blank'></option><option value=''>1</option><option value=''>2</option><option value='answer'>3</option><option value=''>4</option></select></p></li>
<li><p>What is the second independent variable (or <em>factor</em>) that was mentioned? <select class='webex-select'><option value='blank'></option><option value=''>RT</option><option value=''>gaze direction</option><option value='answer'>agreement with statement</option></select></p></li>
<li><p>How many levels does the second factor have? <select class='webex-select'><option value='blank'></option><option value=''>1</option><option value='answer'>2</option><option value=''>3</option><option value=''>4</option></select></p></li>
<li><p>What is the dependent variable? <select class='webex-select'><option value='blank'></option><option value='answer'>RT</option><option value=''>gaze direction</option><option value=''>agreement with statement</option></select></p></li>
<li><p>What is the nature of the independent variables? <select class='webex-select'><option value='blank'></option><option value='answer'>categorical</option><option value=''>continuous</option></select></p></li>
<li><p>What type of design is this? <select class='webex-select'><option value='blank'></option><option value=''>2 x 2 x 2 repeated measures factorial design</option><option value='answer'>3 x 2 repeated measures factorial design</option><option value=''>2 x 2 repeated measures design</option></select></p></li>
</ul>
</div>
<p><br />
</p>
</div>
<div id="read-in-the-data-5" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Read in the data<a href="anova2.html#read-in-the-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Read in the data from the link below:</p>
<p><a href="https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_gaze_data.csv" class="uri">https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_gaze_data.csv</a></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="anova2.html#cb20-1" tabindex="-1"></a>gaze <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_gaze_data.csv&#39;</span>)</span>
<span id="cb20-2"><a href="anova2.html#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="anova2.html#cb20-3" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">ppt</th>
<th align="left">gaze_direction</th>
<th align="left">agreement</th>
<th align="right">RT</th>
<th align="right">logRT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">averted_left</td>
<td align="left">no</td>
<td align="right">725.6667</td>
<td align="right">6.553344</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">averted_left</td>
<td align="left">yes</td>
<td align="right">787.6667</td>
<td align="right">6.615148</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">averted_right</td>
<td align="left">no</td>
<td align="right">621.6667</td>
<td align="right">6.389811</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">averted_right</td>
<td align="left">yes</td>
<td align="right">752.6667</td>
<td align="right">6.568404</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">direct</td>
<td align="left">no</td>
<td align="right">1001.3333</td>
<td align="right">6.829217</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">direct</td>
<td align="left">yes</td>
<td align="right">688.8333</td>
<td align="right">6.477116</td>
</tr>
</tbody>
</table>
</div>
<p>Columns:</p>
<ul>
<li><p><code>ppt</code>: the participant number</p></li>
<li><p><code>gaze_direction</code>: the gaze-direction of the face.</p></li>
<li><p><code>agreement</code>: whether the responses made to the statements were 'yes' or 'no'</p></li>
<li><p><code>RT</code>: mean response times</p></li>
<li><p><code>logRT</code>: the log transform of the RT column, i.e., <code>log(RT)</code></p></li>
<li><p>Are the data in long format or wide format? <select class='webex-select'><option value='blank'></option><option value=''>wide format</option><option value='answer'>long format</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain
</button>
<p>You can tell this is a repeated measures design and that the data are in long format because a given participant's scores are on multiple rows, and there are multiple scores on the dependent variable (RT) for each participant.</p>
</div>
<p><br />
</p>
</div>
<div id="visualise-the-data-4" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Visualise the data<a href="anova2.html#visualise-the-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Reaction time data tend to be positively skewed. As result, Kreysa et al. (2016) analysed the RT data after it had been log transformed.</p>
<p>The log transformed data are in the column <code>logRT</code>.</p>
<p><br />
</p>
<p>To see the positive skew, inspect the (untransformed) RTs in <code>RT</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="anova2.html#cb21-1" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="anova2.html#cb21-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>RT)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="anova2.html#cb21-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gaze_direction <span class="sc">*</span> agreement) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="anova2.html#cb21-4" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-16-1.png" alt="Mean RT according to gaze direction and agreement" width="75%" />
<p class="caption">
Figure 6.4: Mean RT according to gaze direction and agreement
</p>
</div>
<p><br />
</p>
<p>Now inspect the log transformed RTs in <code>logRT</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="anova2.html#cb22-1" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="anova2.html#cb22-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logRT)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="anova2.html#cb22-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gaze_direction <span class="sc">*</span> agreement) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="anova2.html#cb22-4" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-17-1.png" alt="Mean logRT according to gaze direction and agreement" width="75%" />
<p class="caption">
Figure 6.5: Mean logRT according to gaze direction and agreement
</p>
</div>
<ul>
<li>Does the positive skew in the distributions appear to be reduced by the log transformation? <select class='webex-select'><option value='blank'></option><option value=''>no</option><option value='answer'>yes</option></select></li>
</ul>
<p><br />
</p>
</div>
<div id="plot-the-means-3" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Plot the means<a href="anova2.html#plot-the-means-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggline()</code> in the <code>ggpubr</code> package can be used to plot the mean of each condition.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="anova2.html#cb23-1" tabindex="-1"></a><span class="co"># load the ggpubr package</span></span>
<span id="cb23-2"><a href="anova2.html#cb23-2" tabindex="-1"></a><span class="co">#library(ggpubr)</span></span>
<span id="cb23-3"><a href="anova2.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="anova2.html#cb23-4" tabindex="-1"></a><span class="co"># use ggline to plot the means</span></span>
<span id="cb23-5"><a href="anova2.html#cb23-5" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="anova2.html#cb23-6" tabindex="-1"></a>  <span class="fu">ggline</span>(<span class="at">x =</span> <span class="st">&quot;gaze_direction&quot;</span> , <span class="at">y =</span> <span class="st">&quot;logRT&quot;</span>, <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">color=</span> <span class="st">&quot;agreement&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="anova2.html#cb23-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean log RT&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-18-1.png" alt="Mean logRT according to gaze direction and agreement" width="75%" />
<p class="caption">
Figure 6.6: Mean logRT according to gaze direction and agreement
</p>
</div>
<p>It appears as if people took longer to respond when the gaze was direct and they said 'no' to the statement that was made.</p>
<div class="webex-solution">
<button>
The same plot in ggplot
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="anova2.html#cb24-1" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="anova2.html#cb24-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gaze_direction, <span class="at">y =</span> logRT, <span class="at">color =</span> agreement)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="anova2.html#cb24-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-4"><a href="anova2.html#cb24-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> agreement), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="anova2.html#cb24-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-19-1.png" alt="Mean logRT according to gaze direction and agreement" width="75%" />
<p class="caption">
Figure 6.7: Mean logRT according to gaze direction and agreement
</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="descriptive-statistics---mean" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Descriptive statistics - mean<a href="anova2.html#descriptive-statistics---mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To obtain the mean of each condition, use <code>group_by()</code> to group the results of <code>summarise()</code> by the two factors in the design.</p>
<p>Since the log RT values are analysed, we'll obtain the mean of these.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="anova2.html#cb25-1" tabindex="-1"></a><span class="co"># take the data in gaze</span></span>
<span id="cb25-2"><a href="anova2.html#cb25-2" tabindex="-1"></a><span class="co"># pipe to group_by()</span></span>
<span id="cb25-3"><a href="anova2.html#cb25-3" tabindex="-1"></a><span class="co"># group by the gaze_direction and agreement factors</span></span>
<span id="cb25-4"><a href="anova2.html#cb25-4" tabindex="-1"></a><span class="co"># create a table of the mean of each condition</span></span>
<span id="cb25-5"><a href="anova2.html#cb25-5" tabindex="-1"></a><span class="co"># and label the column &#39;M&#39;</span></span>
<span id="cb25-6"><a href="anova2.html#cb25-6" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="anova2.html#cb25-7" tabindex="-1"></a>  <span class="fu">group_by</span>(gaze_direction, agreement) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="anova2.html#cb25-8" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">M =</span> <span class="fu">mean</span>(logRT))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">gaze_direction</th>
<th align="left">agreement</th>
<th align="right">M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">averted_left</td>
<td align="left">no</td>
<td align="right">6.461225</td>
</tr>
<tr class="even">
<td align="left">averted_left</td>
<td align="left">yes</td>
<td align="right">6.476511</td>
</tr>
<tr class="odd">
<td align="left">averted_right</td>
<td align="left">no</td>
<td align="right">6.364156</td>
</tr>
<tr class="even">
<td align="left">averted_right</td>
<td align="left">yes</td>
<td align="right">6.420004</td>
</tr>
<tr class="odd">
<td align="left">direct</td>
<td align="left">no</td>
<td align="right">6.645607</td>
</tr>
<tr class="even">
<td align="left">direct</td>
<td align="left">yes</td>
<td align="right">6.456804</td>
</tr>
</tbody>
</table>
</div>
<p><br />
</p>
<p>The mean log RT when participants disagreed with a statement made by a face looking directly at them was (to 2 decimal places) <input class='webex-solveme nospaces' data-tol='0' size='4' data-answer='["6.65"]'/>.</p>
<p><br />
</p>
</div>
<div id="convert-participant-and-categorical-variables-to-factors" class="section level3 hasAnchor" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Convert participant and categorical variables to factors<a href="anova2.html#convert-participant-and-categorical-variables-to-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convert the <code>ppt</code>, <code>gaze_direction</code>, and <code>agreement</code> variables to factors so that R will treat them as such in the ANOVA.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="anova2.html#cb26-1" tabindex="-1"></a><span class="co"># use mutate() to transform </span></span>
<span id="cb26-2"><a href="anova2.html#cb26-2" tabindex="-1"></a><span class="co"># ppt, gaze_direction and agreement to factors</span></span>
<span id="cb26-3"><a href="anova2.html#cb26-3" tabindex="-1"></a><span class="co"># and overwrite existing variables</span></span>
<span id="cb26-4"><a href="anova2.html#cb26-4" tabindex="-1"></a>gaze <span class="ot">&lt;-</span> </span>
<span id="cb26-5"><a href="anova2.html#cb26-5" tabindex="-1"></a>  gaze <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="anova2.html#cb26-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ppt =</span> <span class="fu">factor</span>(ppt),</span>
<span id="cb26-7"><a href="anova2.html#cb26-7" tabindex="-1"></a>         <span class="at">gaze_direction =</span> <span class="fu">factor</span>(gaze_direction),</span>
<span id="cb26-8"><a href="anova2.html#cb26-8" tabindex="-1"></a>         <span class="at">agreement =</span> <span class="fu">factor</span>(agreement))</span>
<span id="cb26-9"><a href="anova2.html#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="anova2.html#cb26-10" tabindex="-1"></a><span class="co"># check changes</span></span>
<span id="cb26-11"><a href="anova2.html#cb26-11" tabindex="-1"></a>gaze <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">ppt</th>
<th align="left">gaze_direction</th>
<th align="left">agreement</th>
<th align="right">RT</th>
<th align="right">logRT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">averted_left</td>
<td align="left">no</td>
<td align="right">725.6667</td>
<td align="right">6.553344</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">averted_left</td>
<td align="left">yes</td>
<td align="right">787.6667</td>
<td align="right">6.615148</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">averted_right</td>
<td align="left">no</td>
<td align="right">621.6667</td>
<td align="right">6.389811</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">averted_right</td>
<td align="left">yes</td>
<td align="right">752.6667</td>
<td align="right">6.568404</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">direct</td>
<td align="left">no</td>
<td align="right">1001.3333</td>
<td align="right">6.829217</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">direct</td>
<td align="left">yes</td>
<td align="right">688.8333</td>
<td align="right">6.477116</td>
</tr>
</tbody>
</table>
</div>
<p>As before, you could double check that the relevant variable labels in <code>gaze</code> have changed to <code>&lt;fct&gt;</code>.</p>
<p>After using <code>mutate()</code> and <code>factor()</code> above:</p>
<ul>
<li><p>In <code>gaze</code>, what type of variable is <code>ppt</code>? <select class='webex-select'><option value='blank'></option><option value='answer'><fct> factor</option><option value=''><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
<li><p>In <code>gaze</code>, what type of variable is <code>gaze_direction</code>? <select class='webex-select'><option value='blank'></option><option value='answer'><fct> factor</option><option value=''><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
<li><p>In <code>gaze</code>, what type of variable is <code>agreement</code>? <select class='webex-select'><option value='blank'></option><option value='answer'><fct> factor</option><option value=''><chr> character</option><option value=''><dbl> double (numeric)</option></select></p></li>
</ul>
<p><br />
</p>
</div>
<div id="bayes-factor-3" class="section level3 hasAnchor" number="6.5.7">
<h3><span class="header-section-number">6.5.7</span> Bayes factor<a href="anova2.html#bayes-factor-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with between-subjects two-way designs, researchers are typically interested in obtaining three things in a two-way repeated measures ANOVA:</p>
<ul>
<li>the main effect of <code>factor1</code></li>
<li>the main effect of <code>factor2</code></li>
<li>the interaction between <code>factor1</code> and <code>factor2</code>, i.e., the <code>factor1*factor2</code> interaction term.</li>
</ul>
<p>Obtain the Bayes factors for each of the above using <code>anovaBF()</code>. To specify the full model with the interaction, use <code>factor1 * factor2</code>. This will automatically specify a model with the main effects of <code>factor1</code> and <code>factor2</code>, in addition to the interaction term:</p>
<p>As before, add <code>ppt</code> to the model using <code>...+ ppt</code>, and tell R it is a random factor using <code>whichRandom = ppt</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="anova2.html#cb27-1" tabindex="-1"></a><span class="co"># obtain BFs for the anova</span></span>
<span id="cb27-2"><a href="anova2.html#cb27-2" tabindex="-1"></a>BFs_gaze <span class="ot">&lt;-</span> </span>
<span id="cb27-3"><a href="anova2.html#cb27-3" tabindex="-1"></a>  <span class="fu">anovaBF</span>(logRT <span class="sc">~</span> gaze_direction<span class="sc">*</span>agreement <span class="sc">+</span> ppt, </span>
<span id="cb27-4"><a href="anova2.html#cb27-4" tabindex="-1"></a>          <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, </span>
<span id="cb27-5"><a href="anova2.html#cb27-5" tabindex="-1"></a>          <span class="at">data =</span> <span class="fu">data.frame</span>(gaze) )</span>
<span id="cb27-6"><a href="anova2.html#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="anova2.html#cb27-7" tabindex="-1"></a><span class="co"># look at BFs</span></span>
<span id="cb27-8"><a href="anova2.html#cb27-8" tabindex="-1"></a>BFs_gaze</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] gaze_direction + ppt                                        : 40.70293  35.99%
## [2] agreement + ppt                                             : 0.2724039 1.4%
## [3] gaze_direction + agreement + ppt                            : 7.097205  0.95%
## [4] gaze_direction + agreement + gaze_direction:agreement + ppt : 44.34886  1.81%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>Interpretation of the output is similar as with two-way between-subjects ANOVA (Session 3). Notice, however, that <code>ppt</code> is included in each of models, and the comparison of each model is not against the intercept-only model as it was with between-subjects factorial ANOVA. Because this is a repeated measures design, each model is compared against a null model containing only <code>ppt</code> as a predictor.</p>
<p><br />
</p>
<div id="main-effect-of-gaze_direction" class="section level4 hasAnchor" number="6.5.7.1">
<h4><span class="header-section-number">6.5.7.1</span> Main effect of gaze_direction<a href="anova2.html#main-effect-of-gaze_direction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The main effect of gaze direction:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="anova2.html#cb29-1" tabindex="-1"></a>BFs_gaze[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] gaze_direction + ppt : 40.70293 35.99%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>RTs tended <select class='webex-select'><option value='blank'></option><option value=''>not to differ</option><option value='answer'>to differ</option></select> between <code>gaze_direction</code> conditions, BF = <input class='webex-solveme nospaces' data-tol='3' size='5' data-answer='["25.97"]'/>.</li>
</ul>
<p><br />
</p>
</div>
<div id="the-main-effect-of-agreement" class="section level4 hasAnchor" number="6.5.7.2">
<h4><span class="header-section-number">6.5.7.2</span> The main effect of agreement<a href="anova2.html#the-main-effect-of-agreement" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="anova2.html#cb31-1" tabindex="-1"></a>BFs_gaze[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] agreement + ppt : 0.2724039 1.4%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>RTs tended <select class='webex-select'><option value='blank'></option><option value='answer'>not to differ</option><option value=''>to differ</option></select> between <code>agreement</code> conditions, BF = <input class='webex-solveme nospaces' data-tol='0.2' size='4' data-answer='["0.27",".27"]'/>.</li>
</ul>
<p><br />
</p>
</div>
<div id="the-gaze_direction-x-agreement-interaction" class="section level4 hasAnchor" number="6.5.7.3">
<h4><span class="header-section-number">6.5.7.3</span> The gaze_direction x agreement interaction<a href="anova2.html#the-gaze_direction-x-agreement-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="anova2.html#cb33-1" tabindex="-1"></a>BFs_gaze[<span class="dv">4</span>] <span class="sc">/</span> BFs_gaze[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] gaze_direction + agreement + gaze_direction:agreement + ppt : 6.248778 2.05%
## 
## Against denominator:
##   logRT ~ gaze_direction + agreement + ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>There <select class='webex-select'><option value='blank'></option><option value='answer'>was substantial evidence for</option><option value=''>was insufficient evidence for</option><option value=''>was evidence of an absence of</option></select> an interaction between <code>gaze_direction</code> and <code>agreement</code>, BF = <input class='webex-solveme nospaces' data-tol='15' size='4' data-answer='["6.37"]'/>.</li>
</ul>
<p><br />
</p>
</div>
</div>
<div id="follow-up-comparisons-1" class="section level3 hasAnchor" number="6.5.8">
<h3><span class="header-section-number">6.5.8</span> Follow up comparisons<a href="anova2.html#follow-up-comparisons-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given the evidence for an interaction, Kreysa et al. (2016) conducted pairwise comparisons to compare "yes" and "no" responses in each gaze direction condition.</p>
<p>This can be achieved by filtering the data for each gaze direction condition, and then using <code>anovaBF()</code> to compare scores in each <code>agreement</code> condition.</p>
<p>If there were no evidence for the interaction, we wouldn't conduct further comparisons.</p>
<p><br />
</p>
<div id="averted_left" class="section level4 hasAnchor" number="6.5.8.1">
<h4><span class="header-section-number">6.5.8.1</span> averted_left<a href="anova2.html#averted_left" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="anova2.html#cb35-1" tabindex="-1"></a><span class="co"># filter data for averted_left condition</span></span>
<span id="cb35-2"><a href="anova2.html#cb35-2" tabindex="-1"></a>averted_left <span class="ot">&lt;-</span> </span>
<span id="cb35-3"><a href="anova2.html#cb35-3" tabindex="-1"></a>  gaze <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="anova2.html#cb35-4" tabindex="-1"></a>  <span class="fu">filter</span>(gaze_direction <span class="sc">==</span> <span class="st">&quot;averted_left&quot;</span>)</span>
<span id="cb35-5"><a href="anova2.html#cb35-5" tabindex="-1"></a></span>
<span id="cb35-6"><a href="anova2.html#cb35-6" tabindex="-1"></a><span class="co"># use anovaBF() to compare the agreement conditions</span></span>
<span id="cb35-7"><a href="anova2.html#cb35-7" tabindex="-1"></a><span class="fu">anovaBF</span>(logRT <span class="sc">~</span> agreement <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(averted_left))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] agreement + ppt : 0.2516796 1.28%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>There was substantial evidence for <select class='webex-select'><option value='blank'></option><option value=''>a difference</option><option value='answer'>an absence of a difference</option></select> between the mean log RTs made to "yes" and "no" responses in the <code>averted_left</code> condition, BF = <input class='webex-solveme nospaces' data-tol='0.3' size='4' data-answer='["0.25",".25"]'/>.</p>
<p><br />
</p>
</div>
<div id="averted_right" class="section level4 hasAnchor" number="6.5.8.2">
<h4><span class="header-section-number">6.5.8.2</span> averted_right<a href="anova2.html#averted_right" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="anova2.html#cb37-1" tabindex="-1"></a><span class="co"># filter data for averted right condition</span></span>
<span id="cb37-2"><a href="anova2.html#cb37-2" tabindex="-1"></a>averted_right <span class="ot">&lt;-</span> </span>
<span id="cb37-3"><a href="anova2.html#cb37-3" tabindex="-1"></a>  gaze <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="anova2.html#cb37-4" tabindex="-1"></a>  <span class="fu">filter</span>(gaze_direction <span class="sc">==</span> <span class="st">&quot;averted_right&quot;</span>)</span>
<span id="cb37-5"><a href="anova2.html#cb37-5" tabindex="-1"></a></span>
<span id="cb37-6"><a href="anova2.html#cb37-6" tabindex="-1"></a><span class="co"># use anovaBF() to compare the agreement conditions</span></span>
<span id="cb37-7"><a href="anova2.html#cb37-7" tabindex="-1"></a><span class="fu">anovaBF</span>(logRT <span class="sc">~</span> agreement <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(averted_right))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] agreement + ppt : 0.3588487 1.3%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>The Bayes factor comparing the mean log RTs to "yes" and "no" responses in the <code>averted_right</code> condition was inconclusive, BF = <input class='webex-solveme nospaces' data-tol='0.3' size='4' data-answer='["0.36",".36"]'/>, although there was more evidence for the null hypothesis of there being no difference between conditions.</p>
<p><br />
</p>
</div>
<div id="direct" class="section level4 hasAnchor" number="6.5.8.3">
<h4><span class="header-section-number">6.5.8.3</span> direct<a href="anova2.html#direct" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="anova2.html#cb39-1" tabindex="-1"></a><span class="co"># filter data for direct condition</span></span>
<span id="cb39-2"><a href="anova2.html#cb39-2" tabindex="-1"></a>direct <span class="ot">&lt;-</span> </span>
<span id="cb39-3"><a href="anova2.html#cb39-3" tabindex="-1"></a>  gaze <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="anova2.html#cb39-4" tabindex="-1"></a>  <span class="fu">filter</span>(gaze_direction <span class="sc">==</span> <span class="st">&quot;direct&quot;</span>)</span>
<span id="cb39-5"><a href="anova2.html#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="anova2.html#cb39-6" tabindex="-1"></a><span class="co"># use anovaBF() to compare the agreement conditions</span></span>
<span id="cb39-7"><a href="anova2.html#cb39-7" tabindex="-1"></a><span class="fu">anovaBF</span>(logRT <span class="sc">~</span> agreement <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(direct))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] agreement + ppt : 33.88301 1.13%
## 
## Against denominator:
##   logRT ~ ppt 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<ul>
<li>There was substantial evidence for <select class='webex-select'><option value='blank'></option><option value='answer'>a difference</option><option value=''>an absence of a difference</option></select> between the mean log RTs made to "yes" and "no" responses in the <code>direct</code> condition, BF = <input class='webex-solveme nospaces' data-tol='5' size='5' data-answer='["33.68"]'/>.</li>
<li>RTs tended to be longer in the direct condition when participants made a <select class='webex-select'><option value='blank'></option><option value='answer'>no</option><option value=''>yes</option></select> response.</li>
</ul>
<p><br />
</p>
</div>
</div>
</div>
<div id="exercise-two-way-mixed-anova" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Exercise: two-way mixed ANOVA<a href="anova2.html#exercise-two-way-mixed-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-9" class="exercise"><strong>Exercise 6.9  </strong></span>Mixed ANOVA</p>
<p>When one of the factors is manipulated within-subjects and the other is manipulated between-subjects, the design is said to be a <strong>mixed design</strong>. It is also sometimes called a <em>split-plot</em> design.</p>
<p>Hammel and Chan (2016) looked at the <code>duration</code> (in seconds) that participants were able to balance on a balance-board on three successive occasions (<code>trials</code>). There were three <code>groups</code> of participants: one group (<code>counterfactual</code>) engaged in counterfactual thinking, another group (<code>prefactual</code>) engaged in prefactual thinking, and another group (<code>control</code>) engaged in an unrelated thinking task.</p>
<p>The data (already in long format) are located at the link below:</p>
<p><a href="https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_improve_long.csv" class="uri">https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_improve_long.csv</a></p>
<p><br />
</p>
<p><strong>1. Create a line plot of <code>trial</code> vs. <code>duration</code>. Represent each group as a separate line.</strong></p>
<ul>
<li>Balance duration seems highest in the <select class='webex-select'><option value='blank'></option><option value='answer'>counterfactual</option><option value=''>prefactual</option><option value=''>control</option></select> group.</li>
<li>Balance duration seems lowest in the <select class='webex-select'><option value='blank'></option><option value=''>counterfactual</option><option value=''>prefactual</option><option value='answer'>control</option></select> group.</li>
<li>Balance duration generally appears to <select class='webex-select'><option value='blank'></option><option value='answer'>become shorter</option><option value=''>remain constant</option><option value='answer'>become longer</option></select> across trials.</li>
</ul>
<div class="webex-solution">
<button>
Hints
</button>
<ul>
<li>convert <code>ppt</code> and the columns labeling the levels of the independent variables to factors.</li>
<li>use <code>ggline()</code> in the <code>ggpubr</code> package to create the line plot.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="anova2.html#cb41-1" tabindex="-1"></a><span class="co"># read in the data</span></span>
<span id="cb41-2"><a href="anova2.html#cb41-2" tabindex="-1"></a>balance <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/6_improve_long.csv&#39;</span>)</span>
<span id="cb41-3"><a href="anova2.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="anova2.html#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="anova2.html#cb41-5" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb41-6"><a href="anova2.html#cb41-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb41-7"><a href="anova2.html#cb41-7" tabindex="-1"></a><span class="co"># library(ggpubr)</span></span>
<span id="cb41-8"><a href="anova2.html#cb41-8" tabindex="-1"></a>balance <span class="sc">%&gt;%</span> </span>
<span id="cb41-9"><a href="anova2.html#cb41-9" tabindex="-1"></a>  <span class="fu">ggline</span>(<span class="at">x =</span> <span class="st">&quot;trial&quot;</span>, <span class="at">y =</span> <span class="st">&quot;duration&quot;</span>, <span class="at">color =</span> <span class="st">&quot;group&quot;</span>, <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>2. Bayes factors</strong></p>
<ul>
<li>The main effect of group: BF = <input class='webex-solveme nospaces' data-tol='0.2' size='4' data-answer='["0.57",".57"]'/></li>
<li>The main effect of trial: BF = <input class='webex-solveme nospaces' data-tol='50000' size='7' data-answer='["2019789"]'/></li>
<li>The <code>group</code> x <code>trial</code> interaction: <input class='webex-solveme nospaces' data-tol='0.5' size='3' data-answer='["0.6",".6"]'/></li>
</ul>
<p>Note. It may take a short while for <code>anovaBF()</code> to determine the BFs. The processing time increases for more complex designs, especially those with repeated measures.</p>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="anova2.html#cb42-1" tabindex="-1"></a><span class="co"># convert ppt and independent variables to factors</span></span>
<span id="cb42-2"><a href="anova2.html#cb42-2" tabindex="-1"></a>balance <span class="ot">&lt;-</span> </span>
<span id="cb42-3"><a href="anova2.html#cb42-3" tabindex="-1"></a>  balance <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="anova2.html#cb42-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ppt =</span> <span class="fu">factor</span>(ppt),</span>
<span id="cb42-5"><a href="anova2.html#cb42-5" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">factor</span>(group),</span>
<span id="cb42-6"><a href="anova2.html#cb42-6" tabindex="-1"></a>         <span class="at">trial =</span> <span class="fu">factor</span>(trial))</span>
<span id="cb42-7"><a href="anova2.html#cb42-7" tabindex="-1"></a></span>
<span id="cb42-8"><a href="anova2.html#cb42-8" tabindex="-1"></a><span class="co"># anovaBF</span></span>
<span id="cb42-9"><a href="anova2.html#cb42-9" tabindex="-1"></a><span class="co">#library(BayesFactor)</span></span>
<span id="cb42-10"><a href="anova2.html#cb42-10" tabindex="-1"></a>bfs <span class="ot">&lt;-</span> <span class="fu">anovaBF</span>(duration <span class="sc">~</span> ppt <span class="sc">+</span> group <span class="sc">+</span> trial, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(balance))</span>
<span id="cb42-11"><a href="anova2.html#cb42-11" tabindex="-1"></a></span>
<span id="cb42-12"><a href="anova2.html#cb42-12" tabindex="-1"></a><span class="co"># main effect of group</span></span>
<span id="cb42-13"><a href="anova2.html#cb42-13" tabindex="-1"></a>bfs[<span class="dv">1</span>]</span>
<span id="cb42-14"><a href="anova2.html#cb42-14" tabindex="-1"></a></span>
<span id="cb42-15"><a href="anova2.html#cb42-15" tabindex="-1"></a><span class="co"># main effect of trial</span></span>
<span id="cb42-16"><a href="anova2.html#cb42-16" tabindex="-1"></a>bfs[<span class="dv">2</span>]</span>
<span id="cb42-17"><a href="anova2.html#cb42-17" tabindex="-1"></a></span>
<span id="cb42-18"><a href="anova2.html#cb42-18" tabindex="-1"></a><span class="co"># group*trial interaction</span></span>
<span id="cb42-19"><a href="anova2.html#cb42-19" tabindex="-1"></a>bfs[<span class="dv">4</span>] <span class="sc">/</span> bfs[<span class="dv">3</span>]</span>
<span id="cb42-20"><a href="anova2.html#cb42-20" tabindex="-1"></a></span>
<span id="cb42-21"><a href="anova2.html#cb42-21" tabindex="-1"></a><span class="co"># You&#39;ll notice there is a large amount of error on the interaction term</span></span>
<span id="cb42-22"><a href="anova2.html#cb42-22" tabindex="-1"></a><span class="co"># If you have time to wait, then we can recompute the BF with a larger number of iterations,</span></span>
<span id="cb42-23"><a href="anova2.html#cb42-23" tabindex="-1"></a><span class="co"># which should reduce the error. The BFs come out very similarly, but with smaller error.</span></span>
<span id="cb42-24"><a href="anova2.html#cb42-24" tabindex="-1"></a><span class="co"># Try this:</span></span>
<span id="cb42-25"><a href="anova2.html#cb42-25" tabindex="-1"></a><span class="co"># bfs2 &lt;- recompute(bfs, iterations = 100000)</span></span>
<span id="cb42-26"><a href="anova2.html#cb42-26" tabindex="-1"></a><span class="co"># bfs2[1]</span></span>
<span id="cb42-27"><a href="anova2.html#cb42-27" tabindex="-1"></a><span class="co"># bfs2[2]</span></span>
<span id="cb42-28"><a href="anova2.html#cb42-28" tabindex="-1"></a><span class="co"># bfs2[4]/bfs2[3]</span></span></code></pre></div>
</div>
<p><br />
</p>
<p><strong>4. Follow up comparisons.</strong></p>
<p>Conduct follow-up comparisons to investigate the interaction further. Note, we wouldn't usually do this because there was evidence <em>against</em> there being an interaction between <code>trial</code> and <code>group</code>. In statistical terms, this means that the effect of <code>trial</code> is the same in each <code>group</code>, so there's no need to dig deeper into the data. Instead, the following is a pedagogical exercise only.</p>
<p>Assuming there were an interaction, one approach to investigating it is, for each group, to conduct a one-way ANOVA to determine the effect of <code>trial</code> on <code>duration</code>. This is called a <strong>simple effects</strong> analysis. This is where we assess the effect of <code>trial</code> at each level of the second factor, in this case <code>group</code>.</p>
<p><br />
</p>
<p>Conduct three one-way repeated measures ANOVAs, comparing <code>duration</code> across the three types of <code>trial</code> in each <code>group</code>.</p>
<ul>
<li><p>Prefactual group: There's substantial evidence for the effect of <code>trial</code> on <code>duration</code>, BF = <input class='webex-solveme nospaces' data-tol='10' size='6' data-answer='["126.77"]'/>.</p></li>
<li><p>Counterfactual group: There's substantial evidence for the effect of <code>trial</code> on <code>duration</code>, BF = <input class='webex-solveme nospaces' data-tol='10' size='6' data-answer='["139.76"]'/>.</p></li>
<li><p>Control group: There's insufficient evidence for the effect of <code>trial</code> on <code>duration</code>, BF = <input class='webex-solveme nospaces' data-tol='0.3' size='4' data-answer='["1.43"]'/>.</p></li>
</ul>
<div class="webex-solution">
<button>
Hint
</button>
<ul>
<li>Use <code>filter()</code> to subset the data for each group.</li>
<li>Use <code>anovaBF()</code> to conduct a one-way repeated measures ANOVA for each group.</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution - code
</button>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="anova2.html#cb43-1" tabindex="-1"></a><span class="co"># filter rows corresponding to prefactual group</span></span>
<span id="cb43-2"><a href="anova2.html#cb43-2" tabindex="-1"></a>prefactual <span class="ot">&lt;-</span> balance <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;prefactual&quot;</span>)</span>
<span id="cb43-3"><a href="anova2.html#cb43-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-4"><a href="anova2.html#cb43-4" tabindex="-1"></a><span class="co"># one-way ANOVA, comparing trial_1, trial_2, trial_3</span></span>
<span id="cb43-5"><a href="anova2.html#cb43-5" tabindex="-1"></a><span class="fu">anovaBF</span>(duration <span class="sc">~</span> trial <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(prefactual))</span>
<span id="cb43-6"><a href="anova2.html#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="anova2.html#cb43-7" tabindex="-1"></a></span>
<span id="cb43-8"><a href="anova2.html#cb43-8" tabindex="-1"></a></span>
<span id="cb43-9"><a href="anova2.html#cb43-9" tabindex="-1"></a><span class="co"># filter rows corresponding to counterfactual group</span></span>
<span id="cb43-10"><a href="anova2.html#cb43-10" tabindex="-1"></a>counterfactual <span class="ot">&lt;-</span> balance <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;counterfactual&quot;</span>)</span>
<span id="cb43-11"><a href="anova2.html#cb43-11" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-12"><a href="anova2.html#cb43-12" tabindex="-1"></a><span class="co"># one-way ANOVA, comparing trial_1, trial_2, trial_3</span></span>
<span id="cb43-13"><a href="anova2.html#cb43-13" tabindex="-1"></a><span class="fu">anovaBF</span>(duration <span class="sc">~</span> trial <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(counterfactual))</span>
<span id="cb43-14"><a href="anova2.html#cb43-14" tabindex="-1"></a></span>
<span id="cb43-15"><a href="anova2.html#cb43-15" tabindex="-1"></a></span>
<span id="cb43-16"><a href="anova2.html#cb43-16" tabindex="-1"></a></span>
<span id="cb43-17"><a href="anova2.html#cb43-17" tabindex="-1"></a><span class="co"># filter rows corresponding to control group</span></span>
<span id="cb43-18"><a href="anova2.html#cb43-18" tabindex="-1"></a>control <span class="ot">&lt;-</span> balance <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;control&quot;</span>)</span>
<span id="cb43-19"><a href="anova2.html#cb43-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-20"><a href="anova2.html#cb43-20" tabindex="-1"></a><span class="co"># one-way ANOVA, comparing trial_1, trial_2, trial_3</span></span>
<span id="cb43-21"><a href="anova2.html#cb43-21" tabindex="-1"></a><span class="fu">anovaBF</span>(duration <span class="sc">~</span> trial <span class="sc">+</span> ppt, <span class="at">whichRandom =</span> <span class="st">&quot;ppt&quot;</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(control))</span></code></pre></div>
</div>
</div>
<p><br />
</p>
</div>
<div id="further-knowledge---within-subject-errorbars" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Further knowledge - within-subject errorbars<a href="anova2.html#further-knowledge---within-subject-errorbars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="webex-solution">
<button>
Within-subject errorbars
</button>
<p>Here I show you how to plot the means with within-subject error bars (following Morey, 2008) for the first dataset in the worksheet <code>discriminate_long</code>.</p>
<p>I use <code>summarySEwithin()</code> from the <code>Rmisc</code> package for this. The functions from this package have similar names to other <code>tidyverse</code> functions, which can lead to problems/conflicts later. For that reason, I unload <code>Rmisc</code> after using the functions from it, then reload the <code>tidyverse.</code></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="anova2.html#cb44-1" tabindex="-1"></a><span class="co"># within-subjects error bars</span></span>
<span id="cb44-2"><a href="anova2.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="anova2.html#cb44-3" tabindex="-1"></a><span class="co"># load Rmisc package for the summarySEwithin() function</span></span>
<span id="cb44-4"><a href="anova2.html#cb44-4" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb44-5"><a href="anova2.html#cb44-5" tabindex="-1"></a>  </span>
<span id="cb44-6"><a href="anova2.html#cb44-6" tabindex="-1"></a><span class="co"># get within-subject intervals</span></span>
<span id="cb44-7"><a href="anova2.html#cb44-7" tabindex="-1"></a><span class="co"># can also specify between-subjects vars with &#39;betweenvars = &#39;</span></span>
<span id="cb44-8"><a href="anova2.html#cb44-8" tabindex="-1"></a>intervals_RM <span class="ot">&lt;-</span> </span>
<span id="cb44-9"><a href="anova2.html#cb44-9" tabindex="-1"></a>  <span class="fu">summarySEwithin</span>(discriminate_long, </span>
<span id="cb44-10"><a href="anova2.html#cb44-10" tabindex="-1"></a>                  <span class="at">measurevar =</span> <span class="st">&quot;performance&quot;</span>, </span>
<span id="cb44-11"><a href="anova2.html#cb44-11" tabindex="-1"></a>                  <span class="at">withinvars =</span> <span class="st">&quot;time&quot;</span>, </span>
<span id="cb44-12"><a href="anova2.html#cb44-12" tabindex="-1"></a>                  <span class="at">idvar =</span> <span class="st">&quot;ppt&quot;</span>)</span>
<span id="cb44-13"><a href="anova2.html#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="anova2.html#cb44-14" tabindex="-1"></a><span class="co"># look at what&#39;s produced</span></span>
<span id="cb44-15"><a href="anova2.html#cb44-15" tabindex="-1"></a><span class="co"># intervals_RM</span></span>
<span id="cb44-16"><a href="anova2.html#cb44-16" tabindex="-1"></a></span>
<span id="cb44-17"><a href="anova2.html#cb44-17" tabindex="-1"></a><span class="co"># select time, performance and se columns</span></span>
<span id="cb44-18"><a href="anova2.html#cb44-18" tabindex="-1"></a><span class="co"># rename &#39;performance&#39; to M</span></span>
<span id="cb44-19"><a href="anova2.html#cb44-19" tabindex="-1"></a>intervals_RM <span class="ot">&lt;-</span> </span>
<span id="cb44-20"><a href="anova2.html#cb44-20" tabindex="-1"></a>  intervals_RM <span class="sc">%&gt;%</span> </span>
<span id="cb44-21"><a href="anova2.html#cb44-21" tabindex="-1"></a>  <span class="fu">select</span>(time, performance, se) <span class="sc">%&gt;%</span> </span>
<span id="cb44-22"><a href="anova2.html#cb44-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">M =</span> performance,</span>
<span id="cb44-23"><a href="anova2.html#cb44-23" tabindex="-1"></a>                <span class="at">SE =</span> se) </span>
<span id="cb44-24"><a href="anova2.html#cb44-24" tabindex="-1"></a></span>
<span id="cb44-25"><a href="anova2.html#cb44-25" tabindex="-1"></a><span class="co"># compare with between subject intervals (they should be larger)</span></span>
<span id="cb44-26"><a href="anova2.html#cb44-26" tabindex="-1"></a><span class="co"># summarySE(discriminate_long, measurevar = &quot;performance&quot;, groupvars = &quot;time&quot;)</span></span>
<span id="cb44-27"><a href="anova2.html#cb44-27" tabindex="-1"></a></span>
<span id="cb44-28"><a href="anova2.html#cb44-28" tabindex="-1"></a><span class="co"># unload the Rmisc package due to conflicts with other packages</span></span>
<span id="cb44-29"><a href="anova2.html#cb44-29" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:Rmisc&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-30"><a href="anova2.html#cb44-30" tabindex="-1"></a></span>
<span id="cb44-31"><a href="anova2.html#cb44-31" tabindex="-1"></a><span class="co"># now use the M and within-subjects SE to create a plot of means</span></span>
<span id="cb44-32"><a href="anova2.html#cb44-32" tabindex="-1"></a>intervals_RM <span class="sc">%&gt;%</span> </span>
<span id="cb44-33"><a href="anova2.html#cb44-33" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> M)) <span class="sc">+</span> </span>
<span id="cb44-34"><a href="anova2.html#cb44-34" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-35"><a href="anova2.html#cb44-35" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> M <span class="sc">-</span> SE, <span class="at">ymax =</span> M <span class="sc">+</span> SE), <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb44-36"><a href="anova2.html#cb44-36" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb44-37"><a href="anova2.html#cb44-37" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-32"></span>
<img src="06_anova_repeated_measures_files/figure-html/unnamed-chunk-32-1.png" alt="Mean proportion correct at each time point. Error bars represent within-subjects standard error of the mean" width="75%" />
<p class="caption">
Figure 6.8: Mean proportion correct at each time point. Error bars represent within-subjects standard error of the mean
</p>
</div>
</div>
<p><br />
</p>
</div>
<div id="further-knowledge---r-squared" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Further knowledge - R-squared<a href="anova2.html#further-knowledge---r-squared" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="webex-solution">
<button>
One-way within-subjects ANOVA
</button>
<p>It's possible to obtain R<sup>2</sup> for the ANOVA model as we have done previously, by specifying the model with <code>lm()</code>, and then using <code>glance()</code>:</p>
<p>For the one-way repeated measures ANOVA:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="anova2.html#cb45-1" tabindex="-1"></a><span class="co"># specify full model with ppt and time using lm()</span></span>
<span id="cb45-2"><a href="anova2.html#cb45-2" tabindex="-1"></a>ppt_and_time <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> ppt <span class="sc">+</span> time, <span class="at">data =</span> discriminate_long)</span>
<span id="cb45-3"><a href="anova2.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="anova2.html#cb45-4" tabindex="-1"></a><span class="co"># look at R-squared</span></span>
<span id="cb45-5"><a href="anova2.html#cb45-5" tabindex="-1"></a><span class="fu">glance</span>(ppt_and_time)</span></code></pre></div>
<ul>
<li>This produces an R<sup>2</sup> value, which is relatively high, R<sup>2</sup> = <input class='webex-solveme nospaces' size='4' data-answer='["0.81"]'/> (non-corrected, as a proportion, to two decimal places).</li>
</ul>
<p><br />
</p>
<p>This value of R<sup>2</sup> is, however, for the <em>full</em> ANOVA model, which includes the random factor <code>ppt</code> too. Given that we are interested in the R<sup>2</sup> associated with <code>time</code> only, we need to work out the <em>change</em> in R<sup>2</sup> as a result of adding <code>time</code> to the model containing <code>ppt</code>.</p>
<p>To do this, obtain R<sup>2</sup> for the model with <code>ppt</code> alone:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="anova2.html#cb46-1" tabindex="-1"></a><span class="co"># specify model with ppt only using lm()</span></span>
<span id="cb46-2"><a href="anova2.html#cb46-2" tabindex="-1"></a>ppt_alone <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> ppt, <span class="at">data =</span> discriminate_long)</span>
<span id="cb46-3"><a href="anova2.html#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="anova2.html#cb46-4" tabindex="-1"></a><span class="co"># make sure the broom package is loaded</span></span>
<span id="cb46-5"><a href="anova2.html#cb46-5" tabindex="-1"></a><span class="co">#library(broom)</span></span>
<span id="cb46-6"><a href="anova2.html#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="anova2.html#cb46-7" tabindex="-1"></a><span class="co"># look at R-squared</span></span>
<span id="cb46-8"><a href="anova2.html#cb46-8" tabindex="-1"></a><span class="fu">glance</span>(ppt_alone)</span></code></pre></div>
<ul>
<li>R<sup>2</sup> for the model with <code>ppt</code> alone = <input class='webex-solveme nospaces' size='4' data-answer='["0.15"]'/></li>
</ul>
<p><br />
</p>
<p>The R<sup>2</sup> associated with the <code>time</code> factor can be calculated as the difference in R<sup>2</sup> values for the models:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="anova2.html#cb47-1" tabindex="-1"></a><span class="fu">glance</span>(ppt_and_time)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">glance</span>(ppt_alone)<span class="sc">$</span>r.squared</span></code></pre></div>
<ul>
<li>Thus, R<sup>2</sup> for the <code>time</code> factor = <input class='webex-solveme nospaces' size='4' data-answer='["0.66"]'/></li>
</ul>
<p><br />
</p>
<p>The value of R<sup>2</sup> that we have calculated for <code>time</code> is the one that we would provide in a journal article, and could be reported as a measure of effect size.</p>
<p>In the literature, this R<sup>2</sup> value actually goes by the name <em>generalised eta-squared</em>, and is the recommended measure of effect size for repeated measures designs (see Bakeman, 2005, for more details).</p>
</div>
<div class="webex-solution">
<button>
Two-way repeated measures ANOVA
</button>
<p>To calculate generalised eta-squared for each factor and the interaction term in a repeated measures ANOVA, each model in the design must be separately specified with <code>lm()</code>. The change in R<sup>2</sup> value for each factor and the interaction must then be separately determined, by subtracting the relevant R<sup>2</sup> value:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="anova2.html#cb48-1" tabindex="-1"></a><span class="co"># specify each model in the design</span></span>
<span id="cb48-2"><a href="anova2.html#cb48-2" tabindex="-1"></a>gaze_ppt_only <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRT <span class="sc">~</span> ppt, <span class="at">data =</span> gaze)</span>
<span id="cb48-3"><a href="anova2.html#cb48-3" tabindex="-1"></a>gaze_ppt_agreement <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRT <span class="sc">~</span> ppt <span class="sc">+</span> agreement, <span class="at">data =</span> gaze)</span>
<span id="cb48-4"><a href="anova2.html#cb48-4" tabindex="-1"></a>gaze_ppt_gaze <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRT <span class="sc">~</span> ppt <span class="sc">+</span> gaze_direction, <span class="at">data =</span> gaze)</span>
<span id="cb48-5"><a href="anova2.html#cb48-5" tabindex="-1"></a>gaze_ppt_agreement_gaze <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRT <span class="sc">~</span> ppt <span class="sc">+</span> agreement <span class="sc">+</span> gaze_direction, <span class="at">data =</span> gaze)</span>
<span id="cb48-6"><a href="anova2.html#cb48-6" tabindex="-1"></a>gaze_ppt_agreement_gaze_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRT <span class="sc">~</span> ppt <span class="sc">+</span> agreement <span class="sc">+</span> gaze_direction <span class="sc">+</span> agreement<span class="sc">*</span>gaze_direction, <span class="at">data =</span> gaze)</span>
<span id="cb48-7"><a href="anova2.html#cb48-7" tabindex="-1"></a></span>
<span id="cb48-8"><a href="anova2.html#cb48-8" tabindex="-1"></a><span class="co"># work out change in R-squared (equivalent to Generalised Eta Squared or ges)</span></span>
<span id="cb48-9"><a href="anova2.html#cb48-9" tabindex="-1"></a><span class="fu">glance</span>(gaze_ppt_agreement)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">glance</span>(gaze_ppt_only)<span class="sc">$</span>r.squared <span class="co"># ges for agreement</span></span>
<span id="cb48-10"><a href="anova2.html#cb48-10" tabindex="-1"></a><span class="fu">glance</span>(gaze_ppt_gaze)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">glance</span>(gaze_ppt_only)<span class="sc">$</span>r.squared <span class="co"># ges for gaze_direction</span></span>
<span id="cb48-11"><a href="anova2.html#cb48-11" tabindex="-1"></a><span class="fu">glance</span>(gaze_ppt_agreement_gaze_interaction)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">glance</span>(gaze_ppt_agreement_gaze)<span class="sc">$</span>r.squared <span class="co"># ges for interaction</span></span></code></pre></div>
<p>This is clearly quite cumbersome, and potentially error prone. For this reason, you may wish to use a package that will determine generalised eta-squared automatically, such as the <code>afex</code> package, which stands for Analysis of Factorial EXperiments. The package performs an ANOVA using frequentist methods, but provides generalised eta squared by default in the output.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="anova2.html#cb49-1" tabindex="-1"></a><span class="fu">library</span>(afex)</span>
<span id="cb49-2"><a href="anova2.html#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="anova2.html#cb49-3" tabindex="-1"></a><span class="co"># use the afex package to run a 2 x 2 ANOVA</span></span>
<span id="cb49-4"><a href="anova2.html#cb49-4" tabindex="-1"></a><span class="co"># id is the column of participant identifiers (&quot;ppt&quot;)</span></span>
<span id="cb49-5"><a href="anova2.html#cb49-5" tabindex="-1"></a><span class="co"># dv is the dependent variable (&quot;logRT&quot;)</span></span>
<span id="cb49-6"><a href="anova2.html#cb49-6" tabindex="-1"></a><span class="co"># within specifies the within-subjects factors</span></span>
<span id="cb49-7"><a href="anova2.html#cb49-7" tabindex="-1"></a>anova2way <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;ppt&quot;</span>),</span>
<span id="cb49-8"><a href="anova2.html#cb49-8" tabindex="-1"></a>                          <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;logRT&quot;</span>),</span>
<span id="cb49-9"><a href="anova2.html#cb49-9" tabindex="-1"></a>                          <span class="at">within =</span> <span class="fu">c</span>(<span class="st">&quot;agreement&quot;</span>,<span class="st">&quot;gaze_direction&quot;</span>), <span class="co"># two factors</span></span>
<span id="cb49-10"><a href="anova2.html#cb49-10" tabindex="-1"></a>                          <span class="at">data =</span> gaze)</span></code></pre></div>
<p>The <code>ges</code> column provides the generalised eta squared values for each effect.</p>
</div>
<div class="webex-solution">
<button>
One-way between-subjects ANOVA
</button>
<p>The <code>afex</code> package can also be used to obtain generalised eta squared for one-way between-subjects ANOVA designs.</p>
<p>For the one-way between-subjects ANOVA performed on the <code>affect_data</code> in <a href="https://chrisjberry.github.io/datafluencyCB/anova1.html">Session 3</a>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="anova2.html#cb50-1" tabindex="-1"></a><span class="co"># Read in the data</span></span>
<span id="cb50-2"><a href="anova2.html#cb50-2" tabindex="-1"></a>affect_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/3_affect.csv&#39;</span>)</span>
<span id="cb50-3"><a href="anova2.html#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="anova2.html#cb50-4" tabindex="-1"></a><span class="co"># use mutate() to convert the group variable to a factor</span></span>
<span id="cb50-5"><a href="anova2.html#cb50-5" tabindex="-1"></a><span class="co"># store the changes back in affect_data </span></span>
<span id="cb50-6"><a href="anova2.html#cb50-6" tabindex="-1"></a><span class="co"># (i.e., overwrite what&#39;s already in affect_data)</span></span>
<span id="cb50-7"><a href="anova2.html#cb50-7" tabindex="-1"></a>affect_data <span class="ot">&lt;-</span></span>
<span id="cb50-8"><a href="anova2.html#cb50-8" tabindex="-1"></a>  affect_data <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="anova2.html#cb50-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb50-10"><a href="anova2.html#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="anova2.html#cb50-11" tabindex="-1"></a><span class="co"># use the afex package to a one-way ANOVA</span></span>
<span id="cb50-12"><a href="anova2.html#cb50-12" tabindex="-1"></a><span class="co"># id is the column of participant identifiers (&quot;ppt&quot;)</span></span>
<span id="cb50-13"><a href="anova2.html#cb50-13" tabindex="-1"></a><span class="co"># dv is the dependent variable (&quot;logRT&quot;)</span></span>
<span id="cb50-14"><a href="anova2.html#cb50-14" tabindex="-1"></a><span class="co"># between specifies the between-subjects factor</span></span>
<span id="cb50-15"><a href="anova2.html#cb50-15" tabindex="-1"></a>anova1way <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;ppt&quot;</span>),</span>
<span id="cb50-16"><a href="anova2.html#cb50-16" tabindex="-1"></a>                          <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;score&quot;</span>),</span>
<span id="cb50-17"><a href="anova2.html#cb50-17" tabindex="-1"></a>                          <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;group&quot;</span>), <span class="co"># one factor</span></span>
<span id="cb50-18"><a href="anova2.html#cb50-18" tabindex="-1"></a>                          <span class="at">data =</span> affect_data)</span>
<span id="cb50-19"><a href="anova2.html#cb50-19" tabindex="-1"></a></span>
<span id="cb50-20"><a href="anova2.html#cb50-20" tabindex="-1"></a><span class="co"># look at output</span></span>
<span id="cb50-21"><a href="anova2.html#cb50-21" tabindex="-1"></a>anova1way</span></code></pre></div>
<p>The <code>ges</code> column provides the generalised eta squared value for the effect of <code>group</code> on <code>score</code>. The value (0.052) matches the value of R<sup>2</sup> we found using <code>lm()</code> and <code>glance()</code>. Generalised eta squared is the same as R<sup>2</sup> in this design.</p>
</div>
<div class="webex-solution">
<button>
Two-way between-subjects ANOVA
</button>
<p>The <code>afex</code> package can also be used to obtain generalised eta squared for two-way between-subjects ANOVA designs.</p>
<p>For the two-way between-subjects ANOVA performed on the <code>resilience_data</code> in <a href="https://chrisjberry.github.io/datafluencyCB/anova1.html">Session 3</a>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="anova2.html#cb51-1" tabindex="-1"></a><span class="co"># read in the data</span></span>
<span id="cb51-2"><a href="anova2.html#cb51-2" tabindex="-1"></a>resilience_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/chrisjberry/Teaching/master/3_resilience_data.csv&#39;</span>)</span>
<span id="cb51-3"><a href="anova2.html#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="anova2.html#cb51-4" tabindex="-1"></a><span class="co"># use mutate() and factor() to convert </span></span>
<span id="cb51-5"><a href="anova2.html#cb51-5" tabindex="-1"></a><span class="co"># resilience and adversity to factors</span></span>
<span id="cb51-6"><a href="anova2.html#cb51-6" tabindex="-1"></a><span class="co"># add a ppt column</span></span>
<span id="cb51-7"><a href="anova2.html#cb51-7" tabindex="-1"></a>resilience_data <span class="ot">&lt;-</span> </span>
<span id="cb51-8"><a href="anova2.html#cb51-8" tabindex="-1"></a>  resilience_data <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="anova2.html#cb51-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resilience =</span> <span class="fu">factor</span>(resilience),</span>
<span id="cb51-10"><a href="anova2.html#cb51-10" tabindex="-1"></a>         <span class="at">adversity  =</span> <span class="fu">factor</span>(adversity),</span>
<span id="cb51-11"><a href="anova2.html#cb51-11" tabindex="-1"></a>         <span class="at">ppt =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb51-12"><a href="anova2.html#cb51-12" tabindex="-1"></a></span>
<span id="cb51-13"><a href="anova2.html#cb51-13" tabindex="-1"></a><span class="co"># use the afex package to a two-way ANOVA</span></span>
<span id="cb51-14"><a href="anova2.html#cb51-14" tabindex="-1"></a><span class="co"># id is the column of participant identifiers (&quot;ppt&quot;)</span></span>
<span id="cb51-15"><a href="anova2.html#cb51-15" tabindex="-1"></a><span class="co"># dv is the dependent variable (&quot;logRT&quot;)</span></span>
<span id="cb51-16"><a href="anova2.html#cb51-16" tabindex="-1"></a><span class="co"># between specifies the between-subjects factor</span></span>
<span id="cb51-17"><a href="anova2.html#cb51-17" tabindex="-1"></a>anova2bet <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;ppt&quot;</span>),</span>
<span id="cb51-18"><a href="anova2.html#cb51-18" tabindex="-1"></a>                          <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;distress&quot;</span>),</span>
<span id="cb51-19"><a href="anova2.html#cb51-19" tabindex="-1"></a>                          <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;resilience&quot;</span>,<span class="st">&quot;adversity&quot;</span>), <span class="co"># two factors</span></span>
<span id="cb51-20"><a href="anova2.html#cb51-20" tabindex="-1"></a>                          <span class="at">data =</span> resilience_data)</span>
<span id="cb51-21"><a href="anova2.html#cb51-21" tabindex="-1"></a></span>
<span id="cb51-22"><a href="anova2.html#cb51-22" tabindex="-1"></a>anova2bet</span></code></pre></div>
<p>The generalised eta squared values are in the column <code>ges</code>.</p>
</div>
<p><br />
</p>
</div>
<div id="summary-4" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Summary<a href="anova2.html#summary-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>To analyse repeated measures data with ANOVA, the data must be in long format.</li>
<li>Convert from wide to long format using <code>pivot_longer()</code>.</li>
<li>Convert the columns containing the participant identifier (e.g., <code>ppt</code>) and independent variables to factors using <code>factor()</code>.</li>
<li>Add <code>ppt</code> as a predictor in <code>anovaBF()</code>, and specify as a random factor using <code>whichRandom = "ppt"</code>.</li>
<li>Bayes factors given by <code>anovaBF()</code> compare each model against a null model with <code>ppt</code> only (as a random factor), rather than the intercept-only model (as was the case in between-subjects designs).</li>
<li>Conduct follow-up tests using <code>anovaBF()</code> if there's evidence for an interaction.</li>
</ul>
<p><br />
</p>
</div>
<div id="references-5" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> References<a href="anova2.html#references-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bakeman, R. (2005). Recommended effect size statistics for repeated measures designs. <em>Behavior Research Methods</em>, <em>37</em>(3), 379-384. <a href="https://doi.org/10.3758/BF03192707" class="uri">https://doi.org/10.3758/BF03192707</a></p>
<p>Chang, M., Ando, H., Maeda, T., Naruse, Y. (2021). Behavioral effect of mismatch negativity neurofeedback on foreign language learning. <em>PLoS ONE</em>, <em>16</em>(7): e0254771. <a href="https://doi.org/10.1371/journal.pone.0254771" class="uri">https://doi.org/10.1371/journal.pone.0254771</a></p>
<p>Hammell, C., Chan, A.Y.C. (2016). Improving physical task performance with counterfactual
and prefactual thinking. <em>PLoS ONE</em>, <em>11</em>(12): e0168181. <a href="doi:10.1371/journal.pone.0168181" class="uri">doi:10.1371/journal.pone.0168181</a></p>
<p>Kreysa, H., Kessler, L., Schweinberger, S.R. (2016). Direct Speaker Gaze Promotes Trust in
Truth-Ambiguous Statements. <em>PLoS ONE</em>, <em>11</em>(9): e0162291. <a href="doi:10.1371/journal.pone.0162291" class="uri">doi:10.1371/journal.pone.0162291</a></p>
<p>Morey, R. D. (2008). Confidence intervals from normalized data: A correction to Cousineau (2005). <em>Reason</em>, <em>4</em>(2), 61-64.</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., &amp; Province, J. M. (2012). Default Bayes factors for ANOVA designs. <em>Journal of Mathematical Psychology</em>, <em>56</em>(5), 356-374.</p>

</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="multiple3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prepost.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
